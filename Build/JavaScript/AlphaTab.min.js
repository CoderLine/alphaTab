function $CombineDelegates(del1,del2){if(null==del1)return del2;if(null==del2)return del1;var del=$CreateMulticastDelegateFunction();if(del.delegates=[],del1.isMulticastDelegate)for(var i=0;i<del1.delegates.length;i++)del.delegates.push(del1.delegates[i]);else del.delegates.push(del1);if(del2.isMulticastDelegate)for(var i=0;i<del2.delegates.length;i++)del.delegates.push(del2.delegates[i]);else del.delegates.push(del2);return del}function $CreateMulticastDelegateFunction(){var del2=null,del=function(){for(var x=void 0,i=0;i<del2.delegates.length;i++){var del3=del2.delegates[i];x=del3.apply(null,arguments)}return x};return del.isMulticastDelegate=!0,del2=del,del}function $RemoveDelegate(delOriginal,delToRemove){if(null==delToRemove||null==delOriginal)return delOriginal;if(delOriginal.isMulticastDelegate){if(delToRemove.isMulticastDelegate)throw new Error("Multicast to multicast delegate removal is not implemented yet");for(var del=$CreateMulticastDelegateFunction(),i=0;i<delOriginal.delegates.length;i++){var del2=delOriginal.delegates[i];del2!=delToRemove&&(null==del.delegates&&(del.delegates=[]),del.delegates.push(del2))}return null==del.delegates?null:1==del.delegates.length?del.delegates[0]:del}if(delToRemove.isMulticastDelegate)throw new Error("single to multicast delegate removal is not supported");return delOriginal==delToRemove?null:delOriginal}var $StaticConstructors=[],$StaticConstructor=function(f){$StaticConstructors.push(f)};if("undefined"==typeof $Inherit)var $Inherit=function(ce,ce2){if("undefined"==typeof Object.getOwnPropertyNames){for(var p in ce2.prototype)("undefined"==typeof ce.prototype[p]||ce.prototype[p]==Object.prototype[p])&&(ce.prototype[p]=ce2.prototype[p]);for(var p in ce2)"undefined"==typeof ce[p]&&(ce[p]=ce2[p]);ce.$baseCtor=ce2}else{for(var props=Object.getOwnPropertyNames(ce2.prototype),i=0;i<props.length;i++)"undefined"==typeof Object.getOwnPropertyDescriptor(ce.prototype,props[i])&&Object.defineProperty(ce.prototype,props[i],Object.getOwnPropertyDescriptor(ce2.prototype,props[i]));for(var p in ce2)"undefined"==typeof ce[p]&&(ce[p]=ce2[p]);ce.$baseCtor=ce2}};if("undefined"==typeof $CreateException)var $CreateException=function(ex,error){null==error&&(error=new Error),null==ex&&(ex=new System.Exception.ctor),error.message=ex.message,error.exception=ex;for(var p in ex)error[p]=ex[p];return error};if("undefined"==typeof $CreateAnonymousDelegate)var $CreateAnonymousDelegate=function(target,func){if(null==target||null==func)return func;var delegate=function(){return func.apply(target,arguments)};return delegate.func=func,delegate.target=target,delegate.isDelegate=!0,delegate};if("undefined"==typeof $CreateDelegate){if("undefined"==typeof $iKey)var $iKey=0;if("undefined"==typeof $pKey)var $pKey=String.fromCharCode(1);var $CreateDelegate=function(target,func){if(null==target||null==func)return func;if(func.target==target&&func.func==func)return func;null==target.$delegateCache&&(target.$delegateCache={}),null==func.$key&&(func.$key=$pKey+String(++$iKey));var delegate;return null!=target.$delegateCache&&(delegate=target.$delegateCache[func.$key]),null==delegate&&(delegate=function(){return func.apply(target,arguments)},delegate.func=func,delegate.target=target,delegate.isDelegate=!0,null!=target.$delegateCache&&(target.$delegateCache[func.$key]=delegate)),delegate}}var Int32Array=Int32Array||Array,Uint8Array=Uint8Array||Array,Float32Array=Float32Array||Array,AlphaTab=AlphaTab||{};AlphaTab.Environment=function(){},AlphaTab.Environment.PlatformInit=function(){if(AlphaTab.Environment.RenderEngines.svg=function(){return new AlphaTab.Platform.Svg.FontSvgCanvas},AlphaTab.Environment.RenderEngines["default"]=function(){return new AlphaTab.Platform.Svg.FontSvgCanvas},AlphaTab.Environment.RenderEngines.html5=function(){return new AlphaTab.Platform.JavaScript.Html5Canvas},AlphaTab.Environment.FileLoaders["default"]=function(){return new AlphaTab.Platform.JavaScript.JsFileLoader},AlphaTab.Environment.CheckFontLoad(),Math.log2=Math.log2||function(x){return Math.log(x)*Math.LOG2E},self.document){var scriptElement=document.currentScript;if(!scriptElement)try{var error=new Error,stack=error.stack;if(!stack)throw $CreateException(error,new Error);AlphaTab.Environment.ScriptFile=AlphaTab.Environment.ScriptFileFromStack(stack)}catch(e){var stack=e.stack;stack?AlphaTab.Environment.ScriptFile=AlphaTab.Environment.ScriptFileFromStack(stack):scriptElement=document.querySelector("script[data-alphatab]")}(null==AlphaTab.Environment.ScriptFile||0==AlphaTab.Environment.ScriptFile.length)&&(scriptElement?AlphaTab.Environment.ScriptFile=scriptElement.src:console.warn("Could not automatically find alphaTab script file for worker, please add the data-alphatab attribute to the script tag that includes alphaTab or provide it when initializing alphaTab"))}},AlphaTab.Environment.ScriptFileFromStack=function(stack){var matches=stack.match("(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?");return matches||(matches=stack.match("^(?:|[^:@]*@|.+\\)@(?=data:text\\/javascript|blob|http[s]?|file)|.+?\\s+(?: at |@)(?:[^:\\(]+ )*[\\(]?)(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?"),matches||(matches=stack.match("\\)@(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?")))?matches[1]:null},AlphaTab.Environment.CheckFontLoad=function(){var isWorker="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;if(isWorker)return void(AlphaTab.Environment.IsFontLoaded=!1);var cssFontLoadingModuleSupported=!!document.fonts&&!!document.fonts.load;if(cssFontLoadingModuleSupported){var onLoaded=function(){return AlphaTab.Environment.IsFontLoaded=!0,!0};document.fonts.load("1em alphaTab").then(onLoaded)}else{var checkFont=null;checkFont=function(){var testItem=document.getElementById("alphaTabFontChecker");null==testItem&&(testItem=document.createElement("div"),testItem.setAttribute("id","alphaTabFontChecker"),testItem.style.opacity="0",testItem.style.position="absolute",testItem.style.left="0",testItem.style.top="0",testItem.style.fontSize="100px",testItem.classList.add("at"),testItem.innerHTML="&#57424;",document.body.appendChild(testItem));var width=testItem.offsetWidth;width>30&&100>width?(AlphaTab.Environment.IsFontLoaded=!0,document.body.removeChild(testItem)):window.setTimeout(function(){checkFont()},1e3)},window.addEventListener("DOMContentLoaded",function(){checkFont()})}},$StaticConstructor(function(){AlphaTab.Environment.RenderEngines=null,AlphaTab.Environment.FileLoaders=null,AlphaTab.Environment.LayoutEngines=null,AlphaTab.Environment.StaveProfiles=null,AlphaTab.Environment.ScriptFile=null,AlphaTab.Environment.IsFontLoaded=!1,AlphaTab.Environment.RenderEngines={},AlphaTab.Environment.FileLoaders={},AlphaTab.Environment.LayoutEngines={},AlphaTab.Environment.StaveProfiles={},AlphaTab.Environment.PlatformInit(),AlphaTab.Environment.LayoutEngines["default"]=function(r){return new AlphaTab.Rendering.Layout.PageViewLayout(r)},AlphaTab.Environment.LayoutEngines.page=function(r){return new AlphaTab.Rendering.Layout.PageViewLayout(r)},AlphaTab.Environment.LayoutEngines.horizontal=function(r){return new AlphaTab.Rendering.Layout.HorizontalScreenLayout(r)},AlphaTab.Environment.StaveProfiles["default"]=AlphaTab.Environment.StaveProfiles["score-tab"]=[new AlphaTab.Rendering.EffectBarRendererFactory("score-effects",[new AlphaTab.Rendering.Effects.TempoEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.MarkerEffectInfo,new AlphaTab.Rendering.Effects.TextEffectInfo,new AlphaTab.Rendering.Effects.ChordsEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo]),new AlphaTab.Rendering.ScoreBarRendererFactory,new AlphaTab.Rendering.EffectBarRendererFactory("tab-effects",[new AlphaTab.Rendering.Effects.CrescendoEffectInfo,new AlphaTab.Rendering.Effects.DynamicsEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.TapEffectInfo,new AlphaTab.Rendering.Effects.FadeInEffectInfo,new AlphaTab.Rendering.Effects.HarmonicsEffectInfo,new AlphaTab.Rendering.Effects.LetRingEffectInfo,new AlphaTab.Rendering.Effects.CapoEffectInfo,new AlphaTab.Rendering.Effects.PalmMuteEffectInfo,new AlphaTab.Rendering.Effects.PickStrokeEffectInfo]),new AlphaTab.Rendering.TabBarRendererFactory],AlphaTab.Environment.StaveProfiles.score=[new AlphaTab.Rendering.EffectBarRendererFactory("score-effects",[new AlphaTab.Rendering.Effects.TempoEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.MarkerEffectInfo,new AlphaTab.Rendering.Effects.TextEffectInfo,new AlphaTab.Rendering.Effects.ChordsEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.FadeInEffectInfo,new AlphaTab.Rendering.Effects.LetRingEffectInfo,new AlphaTab.Rendering.Effects.PalmMuteEffectInfo,new AlphaTab.Rendering.Effects.PickStrokeEffectInfo,new AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo]),new AlphaTab.Rendering.ScoreBarRendererFactory,new AlphaTab.Rendering.EffectBarRendererFactory("score-bottom-effects",[new AlphaTab.Rendering.Effects.CrescendoEffectInfo,new AlphaTab.Rendering.Effects.DynamicsEffectInfo])],AlphaTab.Environment.StaveProfiles.tab=[new AlphaTab.Rendering.EffectBarRendererFactory("tab-effects",[new AlphaTab.Rendering.Effects.TempoEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.MarkerEffectInfo,new AlphaTab.Rendering.Effects.TextEffectInfo,new AlphaTab.Rendering.Effects.ChordsEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.TapEffectInfo,new AlphaTab.Rendering.Effects.FadeInEffectInfo,new AlphaTab.Rendering.Effects.HarmonicsEffectInfo,new AlphaTab.Rendering.Effects.LetRingEffectInfo,new AlphaTab.Rendering.Effects.CapoEffectInfo,new AlphaTab.Rendering.Effects.PalmMuteEffectInfo,new AlphaTab.Rendering.Effects.PickStrokeEffectInfo,new AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo]),new AlphaTab.Rendering.TabBarRendererFactory]}),AlphaTab.Model=AlphaTab.Model||{},AlphaTab.Model.JsonConverter=function(){},AlphaTab.Model.JsonConverter.prototype={ScoreToJsObject:function(score){var score2={};AlphaTab.Model.Score.CopyTo(score,score2),score2.MasterBars=[],score2.Tracks=[];for(var i=0;i<score.MasterBars.length;i++){var masterBar=score.MasterBars[i],masterBar2={};AlphaTab.Model.MasterBar.CopyTo(masterBar,masterBar2),null!=masterBar.TempoAutomation&&(masterBar2.TempoAutomation={},AlphaTab.Model.Automation.CopyTo(masterBar.TempoAutomation,masterBar2.TempoAutomation)),null!=masterBar.VolumeAutomation&&(masterBar2.VolumeAutomation={},AlphaTab.Model.Automation.CopyTo(masterBar.VolumeAutomation,masterBar2.VolumeAutomation)),null!=masterBar.Section&&(masterBar2.Section={},AlphaTab.Model.Section.CopyTo(masterBar.Section,masterBar2.Section)),score2.MasterBars.push(masterBar2)}for(var t=0;t<score.Tracks.length;t++){var track=score.Tracks[t],track2={};track2.Color={},AlphaTab.Model.Track.CopyTo(track,track2),track2.PlaybackInfo={},AlphaTab.Model.PlaybackInformation.CopyTo(track.PlaybackInfo,track2.PlaybackInfo),track2.Chords={};for(var $i2=0,$t2=Object.keys(track.Chords),$l2=$t2.length,key=$t2[$i2];$l2>$i2;$i2++,key=$t2[$i2]){var chord=track.Chords[key],chord2={};AlphaTab.Model.Chord.CopyTo(chord,chord2),track2.Chords[key]=chord}track2.Staves=[];for(var s=0;s<track.Staves.length;s++){var staff=track.Staves[s],staff2={};staff2.Bars=[];for(var b=0;b<staff.Bars.length;b++){var bar=staff.Bars[b],bar2={};AlphaTab.Model.Bar.CopyTo(bar,bar2),bar2.Voices=[];for(var v=0;v<bar.Voices.length;v++){var voice=bar.Voices[v],voice2={};AlphaTab.Model.Voice.CopyTo(voice,voice2),voice2.Beats=[];for(var bb=0;bb<voice.Beats.length;bb++){var beat=voice.Beats[bb],beat2={};AlphaTab.Model.Beat.CopyTo(beat,beat2),beat2.Automations=[];for(var a=0;a<beat.Automations.length;a++){var automation={};AlphaTab.Model.Automation.CopyTo(beat.Automations[a],automation),beat2.Automations.push(automation)}beat2.WhammyBarPoints=[];for(var i=0;i<beat.WhammyBarPoints.length;i++){var point={};AlphaTab.Model.BendPoint.CopyTo(beat.WhammyBarPoints[i],point),beat2.WhammyBarPoints.push(point)}beat2.Notes=[];for(var n=0;n<beat.Notes.length;n++){var note=beat.Notes[n],note2={};AlphaTab.Model.Note.CopyTo(note,note2),note2.BendPoints=[];for(var i=0;i<note.BendPoints.length;i++){var point={};AlphaTab.Model.BendPoint.CopyTo(note.BendPoints[i],point),note2.BendPoints.push(point)}beat2.Notes.push(note2)}voice2.Beats.push(beat2)}bar2.Voices.push(voice2)}staff2.Bars.push(bar2)}track2.Staves.push(staff)}score2.Tracks.push(track2)}return score2},JsObjectToScore:function(score){var score2=new AlphaTab.Model.Score;AlphaTab.Model.Score.CopyTo(score,score2);for(var i=0;i<score.MasterBars.length;i++){var masterBar=score.MasterBars[i],masterBar2=new AlphaTab.Model.MasterBar;AlphaTab.Model.MasterBar.CopyTo(masterBar,masterBar2),null!=masterBar.TempoAutomation&&(masterBar2.TempoAutomation=new AlphaTab.Model.Automation,AlphaTab.Model.Automation.CopyTo(masterBar.TempoAutomation,masterBar2.TempoAutomation)),null!=masterBar.VolumeAutomation&&(masterBar2.VolumeAutomation=new AlphaTab.Model.Automation,AlphaTab.Model.Automation.CopyTo(masterBar.VolumeAutomation,masterBar2.VolumeAutomation)),null!=masterBar.Section&&(masterBar2.Section=new AlphaTab.Model.Section,AlphaTab.Model.Section.CopyTo(masterBar.Section,masterBar2.Section)),score2.AddMasterBar(masterBar2)}for(var t=0;t<score.Tracks.length;t++){var track=score.Tracks[t],track2=new AlphaTab.Model.Track(track.Staves.length);AlphaTab.Model.Track.CopyTo(track,track2),score2.AddTrack(track2),AlphaTab.Model.PlaybackInformation.CopyTo(track.PlaybackInfo,track2.PlaybackInfo);for(var $i3=0,$t3=Object.keys(track.Chords),$l3=$t3.length,key=$t3[$i3];$l3>$i3;$i3++,key=$t3[$i3]){var chord=track.Chords[key],chord2=new AlphaTab.Model.Chord;AlphaTab.Model.Chord.CopyTo(chord,chord2),track2.Chords[key]=chord2}for(var s=0;s<track.Staves.length;s++)for(var staff=track.Staves[s],b=0;b<staff.Bars.length;b++){var bar=staff.Bars[b],bar2=new AlphaTab.Model.Bar;AlphaTab.Model.Bar.CopyTo(bar,bar2),track2.AddBarToStaff(s,bar2);for(var v=0;v<bar.Voices.length;v++){var voice=bar.Voices[v],voice2=new AlphaTab.Model.Voice;AlphaTab.Model.Voice.CopyTo(voice,voice2),bar2.AddVoice(voice2);for(var bb=0;bb<voice.Beats.length;bb++){var beat=voice.Beats[bb],beat2=new AlphaTab.Model.Beat;AlphaTab.Model.Beat.CopyTo(beat,beat2),voice2.AddBeat(beat2);for(var a=0;a<beat.Automations.length;a++){var automation=new AlphaTab.Model.Automation;AlphaTab.Model.Automation.CopyTo(beat.Automations[a],automation),beat2.Automations.push(automation)}for(var i=0;i<beat.WhammyBarPoints.length;i++){var point=new AlphaTab.Model.BendPoint(0,0);AlphaTab.Model.BendPoint.CopyTo(beat.WhammyBarPoints[i],point),beat2.WhammyBarPoints.push(point)}for(var n=0;n<beat.Notes.length;n++){var note=beat.Notes[n],note2=new AlphaTab.Model.Note;AlphaTab.Model.Note.CopyTo(note,note2),beat2.AddNote(note2);for(var i=0;i<note.BendPoints.length;i++){var point=new AlphaTab.Model.BendPoint(0,0);AlphaTab.Model.BendPoint.CopyTo(note.BendPoints[i],point),note2.AddBendPoint(point)}}}}}}return score2.Finish(),score2}},AlphaTab.Platform=AlphaTab.Platform||{},AlphaTab.Platform.JavaScript=AlphaTab.Platform.JavaScript||{},AlphaTab.Platform.JavaScript.ResizeEventArgs=function(){this.OldWidth=0,this.NewWidth=0,this.Settings=null},AlphaTab.Platform.JavaScript.JsApiBase=function(element,options){this.Element=null,this.CanvasElement=null,this.Settings=null,this.TrackIndexes=null,this.AutoSize=!1,this._visibilityCheckerInterval=0,this._visibilityCheckerIntervalId=0,this._renderResults=null,this._totalResultCount=0,this.Renderer=null,this.Score=null,this.Element=element;var tracksData,dataset=this.Element.dataset,settings=this.Settings=AlphaTab.Settings.FromJson(options);tracksData=null!=options&&options.tracks?options.tracks:null!=element&&null!=element.dataset&&null!=dataset.tracks?dataset.tracks:0,this.SetTracks(tracksData,!1);var contents="";if(null!=element&&(null!=element.dataset&&null!=dataset.tex&&element.innerText&&(contents=element.innerHTML.trim(),element.innerHTML=""),this.CanvasElement=document.createElement("div"),this.CanvasElement.className="alphaTabSurface",this.CanvasElement.style.fontSize="0",this.CanvasElement.style.overflow="hidden",this.CanvasElement.style.lineHeight="0",element.appendChild(this.CanvasElement),("default"==settings.Engine||"svg"==settings.Engine)&&(window.addEventListener("scroll",$CreateAnonymousDelegate(this,function(){this.ShowSvgsInViewPort()})),window.addEventListener("resize",$CreateAnonymousDelegate(this,function(){this.ShowSvgsInViewPort()}))),this.AutoSize=settings.Width<0,this.AutoSize)){settings.Width=element.offsetWidth;var timeoutId=0;window.addEventListener("resize",$CreateAnonymousDelegate(this,function(){clearTimeout(timeoutId),timeoutId=setTimeout($CreateAnonymousDelegate(this,function(){element.offsetWidth!=settings.Width&&this.TriggerResize()}),1)}))}if(this.CreateStyleElement(settings),null!=element&&this.AutoSize){var initialResizeEventInfo=new AlphaTab.Platform.JavaScript.ResizeEventArgs;initialResizeEventInfo.OldWidth=0,initialResizeEventInfo.NewWidth=element.offsetWidth,initialResizeEventInfo.Settings=settings,this.TriggerEvent("resize",initialResizeEventInfo),settings.Width=initialResizeEventInfo.NewWidth}this.Renderer=this.CreateScoreRenderer(settings),this.Renderer.add_RenderFinished($CreateAnonymousDelegate(this,function(){this.TriggerEvent("rendered",null)})),this.Renderer.add_PostRenderFinished($CreateAnonymousDelegate(this,function(){this.TriggerEvent("post-rendered",null)})),this.Renderer.add_PreRender($CreateAnonymousDelegate(this,function(result){this._renderResults=[],this._totalResultCount=0,this.AppendRenderResult(result)})),this.Renderer.add_PartialRenderFinished($CreateDelegate(this,this.AppendRenderResult)),this.Renderer.add_RenderFinished($CreateAnonymousDelegate(this,function(r){this.AppendRenderResult(r),this.AppendRenderResult(null)}));var initialRender=$CreateAnonymousDelegate(this,function(){this.AutoSize&&(this.Settings.Width=this.Element.offsetWidth,this.Renderer.UpdateSettings(settings)),null!=contents&&0!=contents.length?this.Tex(contents):options&&options.file?this.Load(options.file):null!=this.Element&&null!=this.Element.dataset&&null!=dataset.file&&0!=dataset.file.length?this.Load(dataset.file):null!=this.Element&&null!=this.Element.getAttribute("data-file")&&0!=this.Element.getAttribute("data-file").length&&this.Load(this.Element.getAttribute("data-file"))});this._visibilityCheckerInterval=options&&options.visibilityCheckInterval||500,this.get_IsElementVisible()?initialRender():(AlphaTab.Util.Logger.Warning("Rendering","AlphaTab container is invisible, checking for element visibility in "+this._visibilityCheckerInterval+"ms intervals"),this._visibilityCheckerIntervalId=setInterval($CreateAnonymousDelegate(this,function(){this.get_IsElementVisible()&&(AlphaTab.Util.Logger.Info("Rendering","AlphaTab container became visible, triggering initial rendering"),initialRender(),clearInterval(this._visibilityCheckerIntervalId),this._visibilityCheckerIntervalId=0)}),this._visibilityCheckerInterval))},AlphaTab.Platform.JavaScript.JsApiBase.prototype={get_IsElementVisible:function(){return!!(this.Element.offsetWidth||this.Element.offsetHeight||this.Element.getClientRects().length)},TriggerResize:function(){if(this.get_IsElementVisible()){0!=this._visibilityCheckerIntervalId&&(AlphaTab.Util.Logger.Info("Rendering","AlphaTab container became visible again, doing autosizing"),clearInterval(this._visibilityCheckerIntervalId),this._visibilityCheckerIntervalId=0);var resizeEventInfo=new AlphaTab.Platform.JavaScript.ResizeEventArgs;resizeEventInfo.OldWidth=this.Settings.Width,resizeEventInfo.NewWidth=this.Element.offsetWidth,resizeEventInfo.Settings=this.Settings,this.TriggerEvent("resize",resizeEventInfo),this.Settings.Width=resizeEventInfo.NewWidth,this.Renderer.UpdateSettings(this.Settings),this.Renderer.Resize(this.Element.offsetWidth)}else 0==this._visibilityCheckerIntervalId&&(AlphaTab.Util.Logger.Warning("Rendering","AlphaTab container was invisible while autosizing, checking for element visibility in "+this._visibilityCheckerInterval+"ms intervals"),this._visibilityCheckerIntervalId=setInterval($CreateDelegate(this,this.TriggerResize),this._visibilityCheckerInterval))},ShowSvgsInViewPort:function(){for(var placeholders=this.CanvasElement.querySelectorAll("[data-lazy=true]"),$i4=0,$l4=placeholders.length,x=placeholders[$i4];$l4>$i4;$i4++,x=placeholders[$i4]){var placeholder=x;AlphaTab.Platform.JavaScript.JsApiBase.IsElementInViewPort(placeholder)&&(placeholder.outerHTML=placeholder.svg)}},AppendRenderResult:function(result){null!=result&&(this.CanvasElement.style.width=result.TotalWidth+"px",this.CanvasElement.style.height=result.TotalHeight+"px"),(null==result||null!=result.RenderResult)&&(this._renderResults.push(result),setTimeout($CreateAnonymousDelegate(this,function(){for(;this._renderResults.length>0;){var renderResult=this._renderResults[0];if(this._renderResults.splice(0,1),null==renderResult)for(;this.CanvasElement.childElementCount>this._totalResultCount;)this.CanvasElement.removeChild(this.CanvasElement.lastChild);else{var body=renderResult.RenderResult;if("string"==typeof body){var placeholder;this._totalResultCount<this.CanvasElement.childElementCount?placeholder=this.CanvasElement.children[this._totalResultCount]:(placeholder=document.createElement("div"),this.CanvasElement.appendChild(placeholder)),placeholder.style.width=renderResult.Width+"px",placeholder.style.height=renderResult.Height+"px",placeholder.style.display="inline-block",AlphaTab.Platform.JavaScript.JsApiBase.IsElementInViewPort(placeholder)?placeholder.outerHTML=body:(placeholder.svg=body,placeholder.setAttribute("data-lazy","true"))}else this._totalResultCount<this.CanvasElement.childElementCount?this.CanvasElement.replaceChild(renderResult.RenderResult,this.CanvasElement.children[this._totalResultCount]):this.CanvasElement.appendChild(renderResult.RenderResult);this._totalResultCount++}}}),1))},CreateStyleElement:function(settings){var styleElement=document.getElementById("alphaTabStyle");if(null==styleElement){var fontDirectory=settings.FontDirectory;styleElement=document.createElement("style"),styleElement.id="alphaTabStyle",styleElement.type="text/css";var css=new String;css+="@font-face {\r\n",css+="    font-family: 'alphaTab';\r\n",css+="     src: url('"+fontDirectory+"Bravura.eot');\r\n",css+="     src: url('"+fontDirectory+"Bravura.eot?#iefix') format('embedded-opentype')\r\n",css+="          , url('"+fontDirectory+"Bravura.woff') format('woff')\r\n",css+="          , url('"+fontDirectory+"Bravura.otf') format('opentype')\r\n",css+="          , url('"+fontDirectory+"Bravura.svg#Bravura') format('svg');\r\n",css+="     font-weight: normal;\r\n",css+="     font-style: normal;\r\n",css+="}\r\n",css+=".alphaTabSurface * {\r\n",css+="    cursor: default;\r\n",css+="}\r\n",css+=".at {\r\n",css+="     font-family: 'alphaTab';\r\n",css+="     speak: none;\r\n",css+="     font-style: normal;\r\n",css+="     font-weight: normal;\r\n",css+="     font-variant: normal;\r\n",css+="     text-transform: none;\r\n",css+="     line-height: 1;\r\n",css+="     line-height: 1;\r\n",css+="     -webkit-font-smoothing: antialiased;\r\n",css+="     -moz-osx-font-smoothing: grayscale;\r\n",css+="     font-size: 34px;\r\n",css+="     overflow: visible !important;\r\n",css+="}\r\n",styleElement.innerHTML=css,document.getElementsByTagName("head")[0].appendChild(styleElement)}},get_Tracks:function(){for(var tracks=[],$i5=0,$t5=this.TrackIndexes,$l5=$t5.length,track=$t5[$i5];$l5>$i5;$i5++,track=$t5[$i5])track>=0&&track<this.Score.Tracks.length&&tracks.push(this.Score.Tracks[track]);return 0==tracks.length&&this.Score.Tracks.length>0&&tracks.push(this.Score.Tracks[0]),tracks.slice(0)},SetTracks:function(tracksData,render){var tracks=[];if("string"==typeof tracksData)try{tracksData=JSON.parse(tracksData)}catch($$e1){tracksData=new Int32Array([0])}if("number"==typeof tracksData)tracks.push(tracksData);else if(tracksData.length)for(var i=0;i<tracksData.length;i++){var value;value="number"==typeof tracksData[i]?tracksData[i]:AlphaTab.Platform.Std.ParseInt(tracksData[i].ToString()),value>=0&&tracks.push(value)}this.TrackIndexes=tracks.slice(0),render&&this.Render()},ScoreLoaded:function(score,render){this.Score=score,this.TriggerEvent("loaded",score),render&&this.Render()},TriggerEvent:function(name,details){if(null!=this.Element){var e=document.createEvent("CustomEvent");e.initCustomEvent(name,!1,!1,details),this.Element.dispatchEvent(e)}}},AlphaTab.Platform.JavaScript.JsApiBase.IsElementInViewPort=function(el){var rect=el.getBoundingClientRect();return rect.top+rect.height>=0&&rect.top<=window.innerHeight&&rect.left+rect.width>=0&&rect.left<=window.innerWidth},AlphaTab.Platform.JavaScript.JsWorker=function(main){this._renderer=null,this._main=null,this._trackIndexes=null,this.Score=null,this._main=main,this._main.addEventListener("message",$CreateDelegate(this,this.HandleMessage),!1)},AlphaTab.Platform.JavaScript.JsWorker.prototype={get_Tracks:function(){for(var tracks=[],$i6=0,$t6=this._trackIndexes,$l6=$t6.length,track=$t6[$i6];$l6>$i6;$i6++,track=$t6[$i6])track>=0&&track<this.Score.Tracks.length&&tracks.push(this.Score.Tracks[track]);return 0==tracks.length&&this.Score.Tracks.length>0&&tracks.push(this.Score.Tracks[0]),tracks.slice(0)},HandleMessage:function(e){var data=e.data,cmd=data.cmd;switch(cmd){case"alphaTab.initialize":var settings=AlphaTab.Settings.FromJson(data.settings);this._renderer=new AlphaTab.Rendering.ScoreRenderer(settings),this._renderer.add_PartialRenderFinished($CreateAnonymousDelegate(this,function(result){this._main.postMessage({cmd:"alphaTab.partialRenderFinished",result:result})})),this._renderer.add_RenderFinished($CreateAnonymousDelegate(this,function(result){this._main.postMessage({cmd:"alphaTab.renderFinished",result:result})})),this._renderer.add_PostRenderFinished($CreateAnonymousDelegate(this,function(){this._main.postMessage({cmd:"alphaTab.postRenderFinished",boundsLookup:this._renderer.BoundsLookup.ToJson()})})),this._renderer.add_PreRender($CreateAnonymousDelegate(this,function(result){this._main.postMessage({cmd:"alphaTab.preRender",result:result})}));break;case"alphaTab.load":this.Load(data.data,data.indexes);break;case"alphaTab.invalidate":this._renderer.Invalidate();break;case"alphaTab.resize":this._renderer.Resize(data.width);break;case"alphaTab.tex":this.Tex(data.data);break;case"alphaTab.renderMultiple":this.RenderMultiple(data.data);break;case"alphaTab.updateSettings":this.UpdateSettings(data.settings)}},UpdateSettings:function(settings){this._renderer.UpdateSettings(AlphaTab.Settings.FromJson(settings))},RenderMultiple:function(trackIndexes){this._trackIndexes=trackIndexes,this.Render()},Tex:function(contents){try{var parser=new AlphaTab.Importer.AlphaTexImporter,data=AlphaTab.IO.ByteBuffer.FromBuffer(AlphaTab.Platform.Std.StringToByteArray(contents));parser.Init(data),this._trackIndexes=new Int32Array([0]),this.ScoreLoaded(parser.ReadScore())}catch(e){this.Error(e)}},Load:function(data,trackIndexes){try{this._trackIndexes=trackIndexes,data instanceof ArrayBuffer?this.ScoreLoaded(AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(new Uint8Array(data))):data instanceof Uint8Array?this.ScoreLoaded(AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(data)):"string"==typeof data&&AlphaTab.Importer.ScoreLoader.LoadScoreAsync(data,$CreateDelegate(this,this.ScoreLoaded),$CreateDelegate(this,this.Error))}catch(e){this.Error(e)}},Error:function(e){this._main.postMessage({cmd:"alphaTab.error",exception:JSON.parse(JSON.stringify(e))})},ScoreLoaded:function(score){this.Score=score;var json=new AlphaTab.Model.JsonConverter;this._main.postMessage({cmd:"alphaTab.loaded",score:json.ScoreToJsObject(score)}),this.Render()},Render:function(){this._renderer.RenderMultiple(this.get_Tracks())}},$StaticConstructor(function(){self.document||new AlphaTab.Platform.JavaScript.JsWorker(self)}),AlphaTab.Platform.JavaScript.JsWorkerApi=function(element,options){AlphaTab.Platform.JavaScript.JsApiBase.call(this,element,options)},AlphaTab.Platform.JavaScript.JsWorkerApi.prototype={CreateScoreRenderer:function(settings){var renderer=new AlphaTab.Platform.JavaScript.WorkerScoreRenderer(settings);return renderer.add_ScoreLoaded($CreateAnonymousDelegate(this,function(score){this.ScoreLoaded(score,!1)})),renderer.add_PostRenderFinished($CreateAnonymousDelegate(this,function(){this.Element.className=this.Element.className.replace(" loading","").replace(" rendering","")})),renderer},Load:function(data){if(this.Element.className+=" loading","string"==typeof data){var fileLoader=new AlphaTab.Platform.JavaScript.JsFileLoader;fileLoader.LoadBinaryAsync(data,$CreateAnonymousDelegate(this,function(b){this.Renderer.Load(b,this.TrackIndexes)}),$CreateAnonymousDelegate(this,function(e){console.error(e)}))}else this.Renderer.Load(data,this.TrackIndexes)},Render:function(){null!=this.Renderer&&(this.Element.className+=" rendering",this.Renderer.RenderMultiple(this.TrackIndexes))},Tex:function(contents){this.Element.className+=" loading",this.Renderer.Tex(contents)}},$Inherit(AlphaTab.Platform.JavaScript.JsWorkerApi,AlphaTab.Platform.JavaScript.JsApiBase),AlphaTab.Platform.JavaScript.Html5Canvas=function(){this._canvas=null,this._context=null,this._color=null,this._font=null,this._musicFont=null,this._Resources=null,this._color=new AlphaTab.Platform.Model.Color(0,0,0,255);var fontElement=document.createElement("span");fontElement.classList.add("at"),document.body.appendChild(fontElement);var style=window.getComputedStyle(fontElement,null);this._musicFont=new AlphaTab.Platform.Model.Font(style.fontFamily,AlphaTab.Platform.Std.ParseFloat(style.fontSize),AlphaTab.Platform.Model.FontStyle.Plain)},AlphaTab.Platform.JavaScript.Html5Canvas.prototype={get_Resources:function(){return this._Resources},set_Resources:function(value){this._Resources=value},OnPreRender:function(){return null},OnRenderFinished:function(){return null},BeginRender:function(width,height){this._canvas=document.createElement("canvas"),this._canvas.width=0|width,this._canvas.height=0|height,this._canvas.style.width=width+"px",this._canvas.style.height=height+"px",this._context=this._canvas.getContext("2d"),this._context.textBaseline="top"},EndRender:function(){var result=this._canvas;return this._canvas=null,result},get_Color:function(){return this._color},set_Color:function(value){this._color.RGBA!=value.RGBA&&(this._color=value,this._context.strokeStyle=value.RGBA,this._context.fillStyle=value.RGBA)},get_LineWidth:function(){return this._context.lineWidth},set_LineWidth:function(value){this._context.lineWidth=value},FillRect:function(x,y,w,h){w>0&&this._context.fillRect(-0.5|x,-0.5|y,w,h)},StrokeRect:function(x,y,w,h){this._context.strokeRect(x-.5,y-.5,w,h)},BeginPath:function(){this._context.beginPath()},ClosePath:function(){this._context.closePath()},MoveTo:function(x,y){this._context.moveTo(x-.5,y-.5)},LineTo:function(x,y){this._context.lineTo(x-.5,y-.5)},QuadraticCurveTo:function(cpx,cpy,x,y){this._context.quadraticCurveTo(cpx,cpy,x,y)},BezierCurveTo:function(cp1x,cp1y,cp2x,cp2y,x,y){
this._context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)},FillCircle:function(x,y,radius){this._context.beginPath(),this._context.arc(x,y,radius,0,6.28318530717959,!0),this.Fill()},Fill:function(){this._context.fill()},Stroke:function(){this._context.stroke()},get_Font:function(){return this._font},set_Font:function(value){this._font=value,this._context.font=value.ToCssString(1)},get_TextAlign:function(){switch(this._context.textAlign){case"left":return AlphaTab.Platform.Model.TextAlign.Left;case"center":return AlphaTab.Platform.Model.TextAlign.Center;case"right":return AlphaTab.Platform.Model.TextAlign.Right;default:return AlphaTab.Platform.Model.TextAlign.Left}},set_TextAlign:function(value){switch(value){case AlphaTab.Platform.Model.TextAlign.Left:this._context.textAlign="left";break;case AlphaTab.Platform.Model.TextAlign.Center:this._context.textAlign="center";break;case AlphaTab.Platform.Model.TextAlign.Right:this._context.textAlign="right"}},get_TextBaseline:function(){switch(this._context.textBaseline){case"top":return AlphaTab.Platform.Model.TextBaseline.Top;case"middle":return AlphaTab.Platform.Model.TextBaseline.Middle;case"bottom":return AlphaTab.Platform.Model.TextBaseline.Bottom;default:return AlphaTab.Platform.Model.TextBaseline.Top}},set_TextBaseline:function(value){switch(value){case AlphaTab.Platform.Model.TextBaseline.Top:this._context.textBaseline="top";break;case AlphaTab.Platform.Model.TextBaseline.Middle:this._context.textBaseline="middle";break;case AlphaTab.Platform.Model.TextBaseline.Bottom:this._context.textBaseline="bottom"}},BeginGroup:function(){},EndGroup:function(){},FillText:function(text,x,y){this._context.fillText(text,x,y)},MeasureText:function(text){return this._context.measureText(text).width},FillMusicFontSymbol:function(x,y,scale,symbol){if(symbol!=AlphaTab.Rendering.Glyphs.MusicFontSymbol.None){var baseLine=this._context.textBaseline,font=this._context.font;this._context.font=this._musicFont.ToCssString(scale),this._context.textBaseline="middle",this._context.fillText(String.fromCharCode(symbol),x,y),this._context.textBaseline=baseLine,this._context.font=font}}},AlphaTab.Platform.JavaScript.JsApi=function(element,options){AlphaTab.Platform.JavaScript.JsApiBase.call(this,element,options)},AlphaTab.Platform.JavaScript.JsApi.prototype={CreateScoreRenderer:function(settings){return new AlphaTab.Rendering.ScoreRenderer(settings)},Load:function(data){data instanceof ArrayBuffer?this.ScoreLoaded(AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(new Uint8Array(data)),!0):data instanceof Uint8Array?this.ScoreLoaded(AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(data),!0):"string"==typeof data&&AlphaTab.Importer.ScoreLoader.LoadScoreAsync(data,$CreateAnonymousDelegate(this,function(s){this.ScoreLoaded(s,!0)}),$CreateAnonymousDelegate(this,function(e){console.error(e)}))},Tex:function(contents){var parser=new AlphaTab.Importer.AlphaTexImporter,data=AlphaTab.IO.ByteBuffer.FromBuffer(AlphaTab.Platform.Std.StringToByteArray(contents));parser.Init(data),this.ScoreLoaded(parser.ReadScore(),!0)},Render:function(){if(null!=this.Renderer){var canvas=this.Renderer.Canvas;if(canvas instanceof AlphaTab.Platform.JavaScript.Html5Canvas){var renderAction=null;renderAction=$CreateAnonymousDelegate(this,function(){AlphaTab.Environment.IsFontLoaded?this.Renderer.RenderMultiple(this.get_Tracks()):window.setTimeout($CreateAnonymousDelegate(this,function(){renderAction()}),1e3)}),renderAction()}else this.Renderer.RenderMultiple(this.get_Tracks())}}},$Inherit(AlphaTab.Platform.JavaScript.JsApi,AlphaTab.Platform.JavaScript.JsApiBase),AlphaTab.Platform.JavaScript.JsFileLoader=function(){},AlphaTab.Platform.JavaScript.JsFileLoader.prototype={LoadBinary:function(path){var xhr=new XMLHttpRequest;if(xhr.open("GET",path,!1),xhr.responseType="arraybuffer","arraybuffer"!=xhr.responseType){for(var vbArr=VbAjaxLoader("GET",path),fileContents=vbArr.toArray(),data=new String,i=0;i<fileContents.length-1;)data+=String.fromCharCode(fileContents[i]),i++;var reader=AlphaTab.Platform.JavaScript.JsFileLoader.GetBytesFromString(data);return reader}if(xhr.send(),200==xhr.status){var reader=new Uint8Array(xhr.response);return reader}if(0==xhr.status)throw $CreateException(new AlphaTab.IO.FileLoadException("You are offline!!\n Please Check Your Network."),new Error);if(404==xhr.status)throw $CreateException(new AlphaTab.IO.FileLoadException("Requested URL not found."),new Error);if(500==xhr.status)throw $CreateException(new AlphaTab.IO.FileLoadException("Internel Server Error."),new Error);if("parsererror"==xhr.statusText)throw $CreateException(new AlphaTab.IO.FileLoadException("Error.\nParsing JSON Request failed."),new Error);if("timeout"==xhr.statusText)throw $CreateException(new AlphaTab.IO.FileLoadException("Request Time out."),new Error);throw $CreateException(new AlphaTab.IO.FileLoadException("Unknow Error: "+xhr.responseText),new Error)},LoadBinaryAsync:function(path,success,error){var xhr=new XMLHttpRequest;if(xhr.open("GET",path),xhr.responseType="arraybuffer",xhr.onreadystatechange=$CreateAnonymousDelegate(this,function(){if(4==xhr.readyState)if(200==xhr.status){var reader=new Uint8Array(xhr.response);success(reader)}else error(0==xhr.status?new AlphaTab.IO.FileLoadException("You are offline!!\n Please Check Your Network."):404==xhr.status?new AlphaTab.IO.FileLoadException("Requested URL not found."):500==xhr.status?new AlphaTab.IO.FileLoadException("Internel Server Error."):"parsererror"==xhr.statusText?new AlphaTab.IO.FileLoadException("Error.\nParsing JSON Request failed."):"timeout"==xhr.statusText?new AlphaTab.IO.FileLoadException("Request Time out."):new AlphaTab.IO.FileLoadException("Unknow Error: "+xhr.responseText))}),xhr.open("GET",path,!0),xhr.responseType="arraybuffer","arraybuffer"!=xhr.responseType){for(var vbArr=VbAjaxLoader("GET",path),fileContents=vbArr.toArray(),data=new String,i=0;i<fileContents.length-1;)data+=fileContents[i],i++;var reader=AlphaTab.Platform.JavaScript.JsFileLoader.GetBytesFromString(data);return void success(reader)}xhr.send()}},AlphaTab.Platform.JavaScript.JsFileLoader.GetIEVersion=function(){var rv=-1,appName=navigator.appName,agent=navigator.userAgent;if("Microsoft Internet Explorer"==appName){var r=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),m=r.exec(agent);null!=m&&(rv=AlphaTab.Platform.Std.ParseFloat(m[1]))}return rv},AlphaTab.Platform.JavaScript.JsFileLoader.GetBytesFromString=function(s){for(var b=new Uint8Array(s.length),i=0;i<s.length;i++)b[i]=s.charCodeAt(i);return b},AlphaTab.Platform.JavaScript.WorkerScoreRenderer=function(settings){this._worker=null,this.PreRender=null,this.PartialRenderFinished=null,this.RenderFinished=null,this.PostRenderFinished=null,this.ScoreLoaded=null,this.BoundsLookup=null,this.Score=null,this._worker=new Worker(settings.ScriptFile),this._worker.postMessage({cmd:"alphaTab.initialize",settings:settings.ToJson()}),this._worker.addEventListener("message",$CreateDelegate(this,this.HandleWorkerMessage),!1)},AlphaTab.Platform.JavaScript.WorkerScoreRenderer.prototype={UpdateSettings:function(settings){this._worker.postMessage({cmd:"alphaTab.updateSettings",settings:settings.ToJson()})},Invalidate:function(){this._worker.postMessage({cmd:"alphaTab.invalidate"})},Resize:function(width){this._worker.postMessage({cmd:"alphaTab.resize",width:width})},Load:function(data,trackIndexes){this._worker.postMessage({cmd:"alphaTab.load",data:data,indexes:trackIndexes})},HandleWorkerMessage:function(e){var data=e.data,cmd=data.cmd;switch(cmd){case"alphaTab.preRender":this.OnPreRender(data.result);break;case"alphaTab.partialRenderFinished":this.OnPartialRenderFinished(data.result);break;case"alphaTab.renderFinished":this.OnRenderFinished(data.result);break;case"alphaTab.postRenderFinished":this.BoundsLookup=AlphaTab.Rendering.Utils.BoundsLookup.FromJson(data.boundsLookup,this.Score),this.OnPostRenderFinished();break;case"alphaTab.error":console.error(data.exception);break;case"alphaTab.loaded":var score=data.score;if(score){var jsonConverter=new AlphaTab.Model.JsonConverter;score=jsonConverter.JsObjectToScore(score)}this.Score=score,this.OnLoaded(score)}},RenderMultiple:function(trackIndexes){this._worker.postMessage({cmd:"alphaTab.renderMultiple",data:trackIndexes})},add_PreRender:function(value){this.PreRender=$CombineDelegates(this.PreRender,value)},remove_PreRender:function(value){this.PreRender=$RemoveDelegate(this.PreRender,value)},OnPreRender:function(obj){var handler=this.PreRender;null!=handler&&handler(obj)},add_PartialRenderFinished:function(value){this.PartialRenderFinished=$CombineDelegates(this.PartialRenderFinished,value)},remove_PartialRenderFinished:function(value){this.PartialRenderFinished=$RemoveDelegate(this.PartialRenderFinished,value)},OnPartialRenderFinished:function(obj){var handler=this.PartialRenderFinished;null!=handler&&handler(obj)},add_RenderFinished:function(value){this.RenderFinished=$CombineDelegates(this.RenderFinished,value)},remove_RenderFinished:function(value){this.RenderFinished=$RemoveDelegate(this.RenderFinished,value)},OnRenderFinished:function(obj){var handler=this.RenderFinished;null!=handler&&handler(obj)},add_PostRenderFinished:function(value){this.PostRenderFinished=$CombineDelegates(this.PostRenderFinished,value)},remove_PostRenderFinished:function(value){this.PostRenderFinished=$RemoveDelegate(this.PostRenderFinished,value)},OnPostRenderFinished:function(){var handler=this.PostRenderFinished;null!=handler&&handler()},add_ScoreLoaded:function(value){this.ScoreLoaded=$CombineDelegates(this.ScoreLoaded,value)},remove_ScoreLoaded:function(value){this.ScoreLoaded=$RemoveDelegate(this.ScoreLoaded,value)},OnLoaded:function(score){var handler=this.ScoreLoaded;null!=handler&&handler(score)},Tex:function(contents){this._worker.postMessage({cmd:"alphaTab.tex",data:contents})}},AlphaTab.Platform.Std=function(){},$StaticConstructor(function(){AlphaTab.Platform.Std._parseXml=null}),AlphaTab.Platform.Std.ParseFloat=function(s){return parseFloat(s)},AlphaTab.Platform.Std.Log=function(msg,logLevel){switch(logLevel){case AlphaTab.Util.LogLevel.None:break;case AlphaTab.Util.LogLevel.Debug:console.debug(msg);break;case AlphaTab.Util.LogLevel.Info:console.info(msg);break;case AlphaTab.Util.LogLevel.Warning:console.warn(msg);break;case AlphaTab.Util.LogLevel.Error:console.err(msg)}},AlphaTab.Platform.Std.ParseInt=function(s){var val=parseInt(s);return isNaN(val)?-2147483648:val},AlphaTab.Platform.Std.CloneArray=function(){return new Int32Array(0)},AlphaTab.Platform.Std.BlockCopy=function(){},AlphaTab.Platform.Std.IsNullOrWhiteSpace=function(s){return null==s||0==s.trim().length},AlphaTab.Platform.Std.StringFromCharCode=function(){return""},AlphaTab.Platform.Std.LoadXml=function(xml){if(null==AlphaTab.Platform.Std._parseXml){var parseXml=null;if("undefined"!=typeof window.DOMParser)parseXml=function(xmlStr){return(new window.DOMParser).parseFromString(xmlStr,"text/xml")};else{if("undefined"==typeof window.ActiveXObject||!new window.ActiveXObject("Microsoft.XMLDOM"))throw new Error("No XML parser found");parseXml=function(xmlStr){var xmlDoc=new window.ActiveXObject("Microsoft.XMLDOM");return xmlDoc.async="false",xmlDoc.loadXML(xmlStr),xmlDoc}}AlphaTab.Platform.Std._parseXml=parseXml}return AlphaTab.Platform.Std._parseXml(xml)},AlphaTab.Platform.Std.ReadSignedByte=function(readable){var n=readable.ReadByte();return n>=128?n-256:n},AlphaTab.Platform.Std.ToString=function(data){for(var s=new String,i=0;i<data.length;){var c=data[i++];if(128>c){if(0==c)break;s+=String.fromCharCode(c)}else if(224>c)s+=String.fromCharCode((63&c)<<6|127&data[i++]);else if(240>c)s+=String.fromCharCode((31&c)<<12|(127&data[i++])<<6|127&data[i++]);else{var u=(15&c)<<18|(127&data[i++])<<12|(127&data[i++])<<6|127&data[i++];s+=String.fromCharCode((u>>18)+55232),s+=String.fromCharCode(1023&u|56320)}}return s},AlphaTab.Platform.Std.StringToByteArray=function(contents){for(var byteArray=new Uint8Array(contents.length),i=0;i<contents.length;i++)byteArray[i]=contents.charCodeAt(i);return byteArray},AlphaTab.Platform.Std.S4=function(){var num=Math.floor(65536*(1+Math.random()));return num.toString(16).substring(1)},AlphaTab.Platform.Std.NewGuid=function(){return AlphaTab.Platform.Std.S4()+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+AlphaTab.Platform.Std.S4()+AlphaTab.Platform.Std.S4()},AlphaTab.Platform.Std.IsException=function(){return!1},AlphaTab.Platform.Std.Random=function(max){return Math.random()*max},AlphaTab.Platform.Std.IsStringNumber=function(s,allowSign){if(0==s.length)return!1;var c=s.charCodeAt(0);return AlphaTab.Platform.Std.IsCharNumber(c,allowSign)},AlphaTab.Platform.Std.IsCharNumber=function(c,allowSign){return allowSign&&45==c||c>=48&&57>=c},AlphaTab.Platform.Std.IsWhiteSpace=function(c){return 32==c||11==c||13==c||10==c},AlphaTab.Platform.Std.ToHexString=function(n,digits){var s="",hexChars="0123456789ABCDEF";do s=String.fromCharCode(hexChars.charCodeAt(15&n))+s,n>>=4;while(n>0);for(;s.length<digits;)s="0"+s;return s},AlphaTab.Platform.Std.GetNodeValue=function(n){if(null==n)return"";if(n.nodeType==AlphaTab.Xml.XmlNodeType.Element||n.nodeType==AlphaTab.Xml.XmlNodeType.Document){var txt=new String;return AlphaTab.Platform.Std.IterateChildren(n,function(c){txt+=AlphaTab.Platform.Std.GetNodeValue(c)}),txt.trim()}return n.nodeValue},AlphaTab.Platform.Std.IterateChildren=function(n,action){for(var i=0;i<n.childNodes.length;i++)action(n.childNodes[i])},AlphaTab.Rendering=AlphaTab.Rendering||{},AlphaTab.Rendering.Utils=AlphaTab.Rendering.Utils||{},AlphaTab.Rendering.Utils.BoundsLookup=function(){this._beatLookup=null,this._currentStaveGroup=null,this.StaveGroups=null,this.IsFinished=!1,this.StaveGroups=[],this._beatLookup={}},AlphaTab.Rendering.Utils.BoundsLookup.prototype={ToJson:function(){var json={},staveGroups=[];json.StaveGroups=staveGroups;for(var $i11=0,$t11=this.StaveGroups,$l11=$t11.length,group=$t11[$i11];$l11>$i11;$i11++,group=$t11[$i11]){var g={};g.VisualBounds=this.BoundsToJson(group.VisualBounds),g.RealBounds=this.BoundsToJson(group.RealBounds),g.Bars=[];for(var $i12=0,$t12=group.Bars,$l12=$t12.length,masterBar=$t12[$i12];$l12>$i12;$i12++,masterBar=$t12[$i12]){var mb={};mb.VisualBounds=this.BoundsToJson(masterBar.VisualBounds),mb.RealBounds=this.BoundsToJson(masterBar.RealBounds),mb.Bars=[];for(var $i13=0,$t13=masterBar.Bars,$l13=$t13.length,bar=$t13[$i13];$l13>$i13;$i13++,bar=$t13[$i13]){var b={};b.VisualBounds=this.BoundsToJson(bar.VisualBounds),b.RealBounds=this.BoundsToJson(bar.RealBounds),b.Beats=[];for(var $i14=0,$t14=bar.Beats,$l14=$t14.length,beat=$t14[$i14];$l14>$i14;$i14++,beat=$t14[$i14]){var bb={};bb.VisualBounds=this.BoundsToJson(beat.VisualBounds),bb.RealBounds=this.BoundsToJson(beat.RealBounds),bb.BeatIndex=beat.Beat.Index,bb.VoiceIndex=beat.Beat.Voice.Index,bb.BarIndex=beat.Beat.Voice.Bar.Index,bb.StaffIndex=beat.Beat.Voice.Bar.Staff.Index,bb.TrackIndex=beat.Beat.Voice.Bar.Staff.Track.Index,b.Beats.push(bb)}mb.Bars.push(b)}g.Bars.push(mb)}staveGroups.push(g)}return json},BoundsToJson:function(bounds){var json={};return json.X=bounds.X,json.Y=bounds.Y,json.W=bounds.W,json.H=bounds.H,json},Finish:function(){for(var i=0;i<this.StaveGroups.length;i++)this.StaveGroups[i].Finish();this.IsFinished=!0},AddStaveGroup:function(bounds){bounds.Index=this.StaveGroups.length,bounds.BoundsLookup=this,this.StaveGroups.push(bounds),this._currentStaveGroup=bounds},AddMasterBar:function(bounds){bounds.StaveGroupBounds=this._currentStaveGroup,this._currentStaveGroup.AddBar(bounds)},AddBeat:function(bounds){this._beatLookup[bounds.Beat.Id]=bounds},FindBeat:function(beat){var id=beat.Id;return this._beatLookup.hasOwnProperty(id)?this._beatLookup[id]:null},GetBeatAtPos:function(x,y){for(var bottom=0,top=this.StaveGroups.length-1,staveGroupIndex=-1;top>=bottom;){var middle=(top+bottom)/2|0,group=this.StaveGroups[middle];if(y>=group.RealBounds.Y&&y<=group.RealBounds.Y+group.RealBounds.H){staveGroupIndex=middle;break}y<group.RealBounds.Y?top=middle-1:bottom=middle+1}if(-1==staveGroupIndex)return null;var staveGroup=this.StaveGroups[staveGroupIndex],bar=staveGroup.FindBarAtPos(x);return null!=bar?bar.FindBeatAtPos(x,y):null}},AlphaTab.Rendering.Utils.BoundsLookup.FromJson=function(json,score){for(var lookup=new AlphaTab.Rendering.Utils.BoundsLookup,staveGroups=json.StaveGroups,$i7=0,$l7=staveGroups.length,staveGroup=staveGroups[$i7];$l7>$i7;$i7++,staveGroup=staveGroups[$i7]){var sg=new AlphaTab.Rendering.Utils.StaveGroupBounds;sg.VisualBounds=staveGroup.VisualBounds,sg.RealBounds=staveGroup.RealBounds,lookup.AddStaveGroup(sg);for(var $i8=0,$t8=staveGroup.Bars,$l8=$t8.length,masterBar=$t8[$i8];$l8>$i8;$i8++,masterBar=$t8[$i8]){var mb=new AlphaTab.Rendering.Utils.MasterBarBounds;mb.IsFirstOfLine=masterBar.IsFirstOfLine,mb.VisualBounds=masterBar.VisualBounds,mb.RealBounds=masterBar.RealBounds,sg.AddBar(mb);for(var $i9=0,$t9=masterBar.Bars,$l9=$t9.length,bar=$t9[$i9];$l9>$i9;$i9++,bar=$t9[$i9]){var b=new AlphaTab.Rendering.Utils.BarBounds;b.VisualBounds=bar.VisualBounds,b.RealBounds=bar.RealBounds,mb.AddBar(b);for(var $i10=0,$t10=bar.Beats,$l10=$t10.length,beat=$t10[$i10];$l10>$i10;$i10++,beat=$t10[$i10]){var bb=new AlphaTab.Rendering.Utils.BeatBounds;bb.VisualBounds=beat.VisualBounds,bb.RealBounds=beat.RealBounds,bb.Beat=score.Tracks[beat.TrackIndex].Staves[beat.StaffIndex].Bars[beat.BarIndex].Voices[beat.VoiceIndex].Beats[beat.BeatIndex],b.AddBeat(bb)}}}}return lookup},AlphaTab.Settings=function(){this.ScriptFile=null,this.FontDirectory=null,this.Scale=0,this.Width=0,this.Height=0,this.Engine=null,this.Layout=null,this.StretchForce=0,this.ForcePianoFingering=!1,this.Staves=null},AlphaTab.Settings.prototype={ToJson:function(){var json={};json.scale=this.Scale,json.width=this.Width,json.height=this.Height,json.engine=this.Engine,json.stretchForce=this.StretchForce,json.forcePianoFingering=this.ForcePianoFingering,json.scriptFile=this.ScriptFile,json.fontDirectory=this.FontDirectory,json.layout={},json.layout.mode=this.Layout.Mode,json.layout.additionalSettings={};for(var setting in this.Layout.AdditionalSettings)json.layout.additionalSettings[setting]=this.Layout.AdditionalSettings[setting];json.staves={},json.staves.id=this.Staves.Id,json.staves.additionalSettings={};for(var additionalSetting in this.Staves.AdditionalSettings)json.staves.additionalSettings[additionalSetting]=this.Staves.AdditionalSettings[additionalSetting];return json}},AlphaTab.Settings.FromJson=function(json){if(json instanceof AlphaTab.Settings)return json;var settings=AlphaTab.Settings.get_Defaults();return settings.ScriptFile=AlphaTab.Environment.ScriptFile,AlphaTab.Settings.FillFromJson(settings,json),settings},AlphaTab.Settings.FillFromJson=function(settings,json){if(json){if("scale"in json&&(settings.Scale=json.scale),"width"in json&&(settings.Width=json.width),"height"in json&&(settings.Height=json.height),"engine"in json&&(settings.Engine=json.engine),"stretchForce"in json&&(settings.StretchForce=json.stretchForce),"forcePianoFingering"in json&&(settings.ForcePianoFingering=json.forcePianoFingering),"scriptFile"in json?(settings.ScriptFile=AlphaTab.Settings.EnsureFullUrl(settings.ScriptFile),settings.ScriptFile=AlphaTab.Settings.AppendScriptName(json.scriptFile)):self.document&&self.window.ALPHATAB_ROOT?(settings.ScriptFile=self.window.ALPHATAB_ROOT,settings.ScriptFile=AlphaTab.Settings.EnsureFullUrl(settings.ScriptFile),settings.ScriptFile=AlphaTab.Settings.AppendScriptName(settings.ScriptFile)):settings.ScriptFile=AlphaTab.Environment.ScriptFile,"fontDirectory"in json)settings.FontDirectory=AlphaTab.Settings.EnsureFullUrl(json.fontDirectory);else if(self.document&&self.window.ALPHATAB_FONT)settings.FontDirectory=self.window.ALPHATAB_FONT,settings.FontDirectory=AlphaTab.Settings.EnsureFullUrl(settings.FontDirectory);else if(settings.FontDirectory=settings.ScriptFile,null!=settings.FontDirectory&&0!=settings.FontDirectory.length){var lastSlash=settings.FontDirectory.lastIndexOf("/");lastSlash>=0&&(settings.FontDirectory=settings.FontDirectory.substr(0,lastSlash)+"/Font/")}if("layout"in json)if("string"==typeof json.layout)settings.Layout.Mode=json.layout;else if(json.layout.mode&&(settings.Layout.Mode=json.layout.mode),json.layout.additionalSettings)for(var keys=Object.keys(json.layout.additionalSettings),$i15=0,$l15=keys.length,key=keys[$i15];$l15>$i15;$i15++,key=keys[$i15])settings.Layout.AdditionalSettings[key]=json.layout.additionalSettings[key];if("staves"in json){var val=json.staves;if("string"==typeof val)settings.Staves=new AlphaTab.StaveSettings(val);else if(val.id){var staveSettings=new AlphaTab.StaveSettings(val.id);if(val.additionalSettings)for(var keys2=Object.keys(val.additionalSettings),$i16=0,$l16=keys2.length,key2=keys2[$i16];$l16>$i16;$i16++,key2=keys2[$i16])staveSettings.AdditionalSettings[key2]=val.additionalSettings[key2];settings.Staves=staveSettings}}}},AlphaTab.Settings.AppendScriptName=function(url){return null!=url&&0!=url.length&&url.lastIndexOf(".js")!=url.length-".js".length&&(url.lastIndexOf("/")!=url.length-"/".length&&(url+="/"),url+="AlphaTab.js"),url},AlphaTab.Settings.EnsureFullUrl=function(relativeUrl){if(0==!relativeUrl.indexOf("http")&&0==!relativeUrl.indexOf("https")){var root=new String;return root+=window.location.protocol,root+="//",root+=window.location.hostname,window.location.port&&(root+=":",root+=window.location.port),root+=relativeUrl,relativeUrl.lastIndexOf("/")!=relativeUrl.length-"/".length&&(root+="/"),root}return relativeUrl},AlphaTab.Settings.get_Defaults=function(){var settings=new AlphaTab.Settings;return settings.Scale=1,settings.StretchForce=1,settings.Width=950,settings.Height=200,settings.Engine="default",settings.Layout=AlphaTab.LayoutSettings.get_Defaults(),settings.Staves=new AlphaTab.StaveSettings("default"),settings},AlphaTab.Audio=AlphaTab.Audio||{},AlphaTab.Audio.GeneralMidi=function(){},$StaticConstructor(function(){AlphaTab.Audio.GeneralMidi._values=null}),AlphaTab.Audio.GeneralMidi.GetValue=function(name){return null==AlphaTab.Audio.GeneralMidi._values&&(AlphaTab.Audio.GeneralMidi._values={},AlphaTab.Audio.GeneralMidi._values.acousticgrandpiano=0,AlphaTab.Audio.GeneralMidi._values.brightacousticpiano=1,AlphaTab.Audio.GeneralMidi._values.electricgrandpiano=2,AlphaTab.Audio.GeneralMidi._values.honkytonkpiano=3,AlphaTab.Audio.GeneralMidi._values.electricpiano1=4,AlphaTab.Audio.GeneralMidi._values.electricpiano2=5,AlphaTab.Audio.GeneralMidi._values.harpsichord=6,AlphaTab.Audio.GeneralMidi._values.clavinet=7,AlphaTab.Audio.GeneralMidi._values.celesta=8,AlphaTab.Audio.GeneralMidi._values.glockenspiel=9,AlphaTab.Audio.GeneralMidi._values.musicbox=10,AlphaTab.Audio.GeneralMidi._values.vibraphone=11,AlphaTab.Audio.GeneralMidi._values.marimba=12,AlphaTab.Audio.GeneralMidi._values.xylophone=13,AlphaTab.Audio.GeneralMidi._values.tubularbells=14,AlphaTab.Audio.GeneralMidi._values.dulcimer=15,AlphaTab.Audio.GeneralMidi._values.drawbarorgan=16,AlphaTab.Audio.GeneralMidi._values.percussiveorgan=17,AlphaTab.Audio.GeneralMidi._values.rockorgan=18,AlphaTab.Audio.GeneralMidi._values.churchorgan=19,AlphaTab.Audio.GeneralMidi._values.reedorgan=20,AlphaTab.Audio.GeneralMidi._values.accordion=21,AlphaTab.Audio.GeneralMidi._values.harmonica=22,AlphaTab.Audio.GeneralMidi._values.tangoaccordion=23,AlphaTab.Audio.GeneralMidi._values.acousticguitarnylon=24,AlphaTab.Audio.GeneralMidi._values.acousticguitarsteel=25,AlphaTab.Audio.GeneralMidi._values.electricguitarjazz=26,AlphaTab.Audio.GeneralMidi._values.electricguitarclean=27,AlphaTab.Audio.GeneralMidi._values.electricguitarmuted=28,AlphaTab.Audio.GeneralMidi._values.overdrivenguitar=29,AlphaTab.Audio.GeneralMidi._values.distortionguitar=30,AlphaTab.Audio.GeneralMidi._values.guitarharmonics=31,AlphaTab.Audio.GeneralMidi._values.acousticbass=32,AlphaTab.Audio.GeneralMidi._values.electricbassfinger=33,AlphaTab.Audio.GeneralMidi._values.electricbasspick=34,AlphaTab.Audio.GeneralMidi._values.fretlessbass=35,AlphaTab.Audio.GeneralMidi._values.slapbass1=36,AlphaTab.Audio.GeneralMidi._values.slapbass2=37,AlphaTab.Audio.GeneralMidi._values.synthbass1=38,AlphaTab.Audio.GeneralMidi._values.synthbass2=39,AlphaTab.Audio.GeneralMidi._values.violin=40,AlphaTab.Audio.GeneralMidi._values.viola=41,AlphaTab.Audio.GeneralMidi._values.cello=42,AlphaTab.Audio.GeneralMidi._values.contrabass=43,AlphaTab.Audio.GeneralMidi._values.tremolostrings=44,AlphaTab.Audio.GeneralMidi._values.pizzicatostrings=45,AlphaTab.Audio.GeneralMidi._values.orchestralharp=46,AlphaTab.Audio.GeneralMidi._values.timpani=47,AlphaTab.Audio.GeneralMidi._values.stringensemble1=48,AlphaTab.Audio.GeneralMidi._values.stringensemble2=49,AlphaTab.Audio.GeneralMidi._values.synthstrings1=50,AlphaTab.Audio.GeneralMidi._values.synthstrings2=51,AlphaTab.Audio.GeneralMidi._values.choiraahs=52,AlphaTab.Audio.GeneralMidi._values.voiceoohs=53,AlphaTab.Audio.GeneralMidi._values.synthvoice=54,AlphaTab.Audio.GeneralMidi._values.orchestrahit=55,AlphaTab.Audio.GeneralMidi._values.trumpet=56,AlphaTab.Audio.GeneralMidi._values.trombone=57,AlphaTab.Audio.GeneralMidi._values.tuba=58,AlphaTab.Audio.GeneralMidi._values.mutedtrumpet=59,AlphaTab.Audio.GeneralMidi._values.frenchhorn=60,AlphaTab.Audio.GeneralMidi._values.brasssection=61,AlphaTab.Audio.GeneralMidi._values.synthbrass1=62,AlphaTab.Audio.GeneralMidi._values.synthbrass2=63,AlphaTab.Audio.GeneralMidi._values.sopranosax=64,AlphaTab.Audio.GeneralMidi._values.altosax=65,AlphaTab.Audio.GeneralMidi._values.tenorsax=66,AlphaTab.Audio.GeneralMidi._values.baritonesax=67,AlphaTab.Audio.GeneralMidi._values.oboe=68,AlphaTab.Audio.GeneralMidi._values.englishhorn=69,AlphaTab.Audio.GeneralMidi._values.bassoon=70,AlphaTab.Audio.GeneralMidi._values.clarinet=71,AlphaTab.Audio.GeneralMidi._values.piccolo=72,AlphaTab.Audio.GeneralMidi._values.flute=73,AlphaTab.Audio.GeneralMidi._values.recorder=74,AlphaTab.Audio.GeneralMidi._values.panflute=75,AlphaTab.Audio.GeneralMidi._values.blownbottle=76,AlphaTab.Audio.GeneralMidi._values.shakuhachi=77,AlphaTab.Audio.GeneralMidi._values.whistle=78,AlphaTab.Audio.GeneralMidi._values.ocarina=79,AlphaTab.Audio.GeneralMidi._values.lead1square=80,AlphaTab.Audio.GeneralMidi._values.lead2sawtooth=81,AlphaTab.Audio.GeneralMidi._values.lead3calliope=82,AlphaTab.Audio.GeneralMidi._values.lead4chiff=83,AlphaTab.Audio.GeneralMidi._values.lead5charang=84,AlphaTab.Audio.GeneralMidi._values.lead6voice=85,AlphaTab.Audio.GeneralMidi._values.lead7fifths=86,AlphaTab.Audio.GeneralMidi._values.lead8bassandlead=87,AlphaTab.Audio.GeneralMidi._values.pad1newage=88,AlphaTab.Audio.GeneralMidi._values.pad2warm=89,AlphaTab.Audio.GeneralMidi._values.pad3polysynth=90,AlphaTab.Audio.GeneralMidi._values.pad4choir=91,AlphaTab.Audio.GeneralMidi._values.pad5bowed=92,AlphaTab.Audio.GeneralMidi._values.pad6metallic=93,AlphaTab.Audio.GeneralMidi._values.pad7halo=94,AlphaTab.Audio.GeneralMidi._values.pad8sweep=95,AlphaTab.Audio.GeneralMidi._values.fx1rain=96,AlphaTab.Audio.GeneralMidi._values.fx2soundtrack=97,AlphaTab.Audio.GeneralMidi._values.fx3crystal=98,AlphaTab.Audio.GeneralMidi._values.fx4atmosphere=99,AlphaTab.Audio.GeneralMidi._values.fx5brightness=100,AlphaTab.Audio.GeneralMidi._values.fx6goblins=101,AlphaTab.Audio.GeneralMidi._values.fx7echoes=102,AlphaTab.Audio.GeneralMidi._values.fx8scifi=103,AlphaTab.Audio.GeneralMidi._values.sitar=104,AlphaTab.Audio.GeneralMidi._values.banjo=105,AlphaTab.Audio.GeneralMidi._values.shamisen=106,AlphaTab.Audio.GeneralMidi._values.koto=107,AlphaTab.Audio.GeneralMidi._values.kalimba=108,AlphaTab.Audio.GeneralMidi._values.bagpipe=109,AlphaTab.Audio.GeneralMidi._values.fiddle=110,AlphaTab.Audio.GeneralMidi._values.shanai=111,AlphaTab.Audio.GeneralMidi._values.tinklebell=112,AlphaTab.Audio.GeneralMidi._values.agogo=113,AlphaTab.Audio.GeneralMidi._values.steeldrums=114,AlphaTab.Audio.GeneralMidi._values.woodblock=115,AlphaTab.Audio.GeneralMidi._values.taikodrum=116,AlphaTab.Audio.GeneralMidi._values.melodictom=117,AlphaTab.Audio.GeneralMidi._values.synthdrum=118,AlphaTab.Audio.GeneralMidi._values.reversecymbal=119,AlphaTab.Audio.GeneralMidi._values.guitarfretnoise=120,AlphaTab.Audio.GeneralMidi._values.breathnoise=121,AlphaTab.Audio.GeneralMidi._values.seashore=122,AlphaTab.Audio.GeneralMidi._values.birdtweet=123,AlphaTab.Audio.GeneralMidi._values.telephonering=124,AlphaTab.Audio.GeneralMidi._values.helicopter=125,AlphaTab.Audio.GeneralMidi._values.applause=126,AlphaTab.Audio.GeneralMidi._values.gunshot=127),name=name.toLowerCase().replace(" ",""),AlphaTab.Audio.GeneralMidi._values.hasOwnProperty(name)?AlphaTab.Audio.GeneralMidi._values[name]:0},AlphaTab.Audio.GeneralMidi.IsPiano=function(program){return 8>=program||program>=17&&24>=program},AlphaTab.Audio.Generator=AlphaTab.Audio.Generator||{},AlphaTab.Audio.Generator.MidiFileGenerator=function(score,handler,generateMetronome){this._score=null,this._handler=null,this._currentTempo=0,this.GenerateMetronome=!1,this.TickLookup=null,this._score=score,this._currentTempo=this._score.Tempo,this._handler=handler,this.GenerateMetronome=generateMetronome,this.TickLookup=new AlphaTab.Audio.Model.MidiTickLookup},AlphaTab.Audio.Generator.MidiFileGenerator.prototype={Generate:function(){for(var i=0,j=this._score.Tracks.length;j>i;i++)this.GenerateTrack(this._score.Tracks[i]);for(var controller=new AlphaTab.Audio.Generator.MidiPlaybackController(this._score),previousMasterBar=null;!controller.get_Finished();){var index=controller.Index,bar=this._score.MasterBars[index],currentTick=controller.CurrentTick;if(controller.ProcessCurrent(),controller.ShouldPlay){this.GenerateMasterBar(bar,previousMasterBar,currentTick);for(var i=0,j=this._score.Tracks.length;j>i;i++)for(var track=this._score.Tracks[i],k=0,l=track.Staves.length;l>k;k++){var staff=track.Staves[k];index<staff.Bars.length&&this.GenerateBar(staff.Bars[index],currentTick)}}controller.MoveNext(),previousMasterBar=bar}for(var i=0,j=this._score.Tracks.length;j>i;i++)this._handler.FinishTrack(this._score.Tracks[i].Index,controller.CurrentTick);this.TickLookup.Finish()},GenerateTrack:function(track){this.GenerateChannel(track,track.PlaybackInfo.PrimaryChannel,track.PlaybackInfo),track.PlaybackInfo.PrimaryChannel!=track.PlaybackInfo.SecondaryChannel&&this.GenerateChannel(track,track.PlaybackInfo.SecondaryChannel,track.PlaybackInfo)},GenerateChannel:function(track,channel,playbackInfo){var volume=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(playbackInfo.Volume),balance=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(playbackInfo.Balance);this._handler.AddControlChange(track.Index,0,channel,7,volume),this._handler.AddControlChange(track.Index,0,channel,10,balance),this._handler.AddControlChange(track.Index,0,channel,11,127),this._handler.AddControlChange(track.Index,0,channel,100,0),this._handler.AddControlChange(track.Index,0,channel,101,0),this._handler.AddControlChange(track.Index,0,channel,38,0),this._handler.AddControlChange(track.Index,0,channel,6,12),this._handler.AddProgramChange(track.Index,0,channel,playbackInfo.Program)},GenerateMasterBar:function(masterBar,previousMasterBar,currentTick){if((null==previousMasterBar||previousMasterBar.TimeSignatureDenominator!=masterBar.TimeSignatureDenominator||previousMasterBar.TimeSignatureNumerator!=masterBar.TimeSignatureNumerator)&&this._handler.AddTimeSignature(currentTick,masterBar.TimeSignatureNumerator,masterBar.TimeSignatureDenominator),null==previousMasterBar?(this._handler.AddTempo(currentTick,masterBar.Score.Tempo),this._currentTempo=masterBar.Score.Tempo):null!=masterBar.TempoAutomation&&(this._handler.AddTempo(currentTick,0|masterBar.TempoAutomation.Value),this._currentTempo=0|masterBar.TempoAutomation.Value),this.GenerateMetronome)for(var start=currentTick,length=AlphaTab.Audio.MidiUtils.ValueToTicks(masterBar.TimeSignatureDenominator),i=0;i<masterBar.TimeSignatureNumerator;i++)this._handler.AddMetronome(start,length),
start+=length;var masterBarLookup=new AlphaTab.Audio.Model.MasterBarTickLookup;masterBarLookup.MasterBar=masterBar,masterBarLookup.Start=currentTick,masterBarLookup.Tempo=this._currentTempo,masterBarLookup.End=masterBarLookup.Start+masterBar.CalculateDuration(),this.TickLookup.AddMasterBar(masterBarLookup)},GenerateBar:function(bar,barStartTick){for(var i=0,j=bar.Voices.length;j>i;i++)this.GenerateVoice(bar.Voices[i],barStartTick)},GenerateVoice:function(voice,barStartTick){if(!voice.IsEmpty)for(var i=0,j=voice.Beats.length;j>i;i++)this.GenerateBeat(voice.Beats[i],barStartTick)},GenerateBeat:function(beat,barStartTick){var beatStart=beat.Start,duration=beat.CalculateDuration(),beatLookup=new AlphaTab.Audio.Model.BeatTickLookup;beatLookup.Start=barStartTick+beatStart,beatLookup.End=barStartTick+beatStart+duration,beatLookup.Beat=beat,this.TickLookup.AddBeat(beatLookup);for(var track=beat.Voice.Bar.Staff.Track,i=0,j=beat.Automations.length;j>i;i++)this.GenerateAutomation(beat,beat.Automations[i],barStartTick);if(beat.get_IsRest())this._handler.AddRest(track.Index,barStartTick+beatStart,track.PlaybackInfo.PrimaryChannel);else for(var brushInfo=this.GetBrushInfo(beat),i=0,j=beat.Notes.length;j>i;i++){var n=beat.Notes[i];this.GenerateNote(n,barStartTick+beatStart,duration,brushInfo)}if(beat.Vibrato!=AlphaTab.Model.VibratoType.None){var phaseLength=240,bendAmplitude=3;this.GenerateVibratorWithParams(beat.Voice.Bar.Staff.Track,barStartTick+beatStart,beat.CalculateDuration(),phaseLength,bendAmplitude)}},GenerateNote:function(note,beatStart,beatDuration,brushInfo){var track=note.Beat.Voice.Bar.Staff.Track,noteKey=note.get_RealValue(),brushOffset=note.get_IsStringed()&&note.String<=brushInfo.length?brushInfo[note.String-1]:0,noteStart=beatStart+brushOffset,noteDuration=this.GetNoteDuration(note,beatDuration)-brushOffset,dynamicValue=this.GetDynamicValue(note);return note.get_HasBend()||this._handler.AddBend(track.Index,noteStart,track.PlaybackInfo.PrimaryChannel,64),note.Beat.FadeIn&&this.GenerateFadeIn(note,noteStart,noteDuration,noteKey,dynamicValue),note.get_IsTrill()&&!track.IsPercussion?void this.GenerateTrill(note,noteStart,noteDuration,noteKey,dynamicValue):note.Beat.get_IsTremolo()?void this.GenerateTremoloPicking(note,noteStart,noteDuration,noteKey,dynamicValue):(note.get_HasBend()?this.GenerateBend(note,noteStart,noteDuration,noteKey,dynamicValue):note.Beat.get_HasWhammyBar()?this.GenerateWhammyBar(note,noteStart,noteDuration,noteKey,dynamicValue):note.SlideType!=AlphaTab.Model.SlideType.None?this.GenerateSlide(note,noteStart,noteDuration,noteKey,dynamicValue):note.Vibrato!=AlphaTab.Model.VibratoType.None&&this.GenerateVibrato(note,noteStart,noteDuration,noteKey,dynamicValue),note.HarmonicType!=AlphaTab.Model.HarmonicType.None&&this.GenerateHarmonic(note,noteStart,noteDuration,noteKey,dynamicValue),void(note.IsTieDestination||this._handler.AddNote(track.Index,noteStart,noteDuration,noteKey,dynamicValue,track.PlaybackInfo.PrimaryChannel)))},GetNoteDuration:function(note,beatDuration){return this.ApplyDurationEffects(note,beatDuration)},ApplyDurationEffects:function(note,duration){if(note.IsDead)return this.ApplyStaticDuration(30,duration);if(note.IsPalmMute)return this.ApplyStaticDuration(80,duration);if(note.IsStaccato)return duration/2|0;if(note.IsTieOrigin){var endNote=note.TieDestination;if(note.IsTieDestination)return duration+this.GetNoteDuration(endNote,endNote.Beat.CalculateDuration());var startTick=note.Beat.get_AbsoluteStart(),endTick=endNote.Beat.get_AbsoluteStart()+this.GetNoteDuration(endNote,endNote.Beat.CalculateDuration());return endTick-startTick}return duration},ApplyStaticDuration:function(duration,maximum){var value=this._currentTempo*duration/60|0;return Math.min(value,maximum)},GetDynamicValue:function(note){var dynamicValue=note.Dynamic;switch(note.Beat.Voice.Bar.Staff.Track.IsPercussion||null==note.HammerPullOrigin||dynamicValue--,note.IsGhost&&dynamicValue--,note.Accentuated){case AlphaTab.Model.AccentuationType.Normal:dynamicValue++;break;case AlphaTab.Model.AccentuationType.Heavy:dynamicValue+=2}return dynamicValue},GenerateFadeIn:function(note,noteStart,noteDuration){for(var track=note.Beat.Voice.Bar.Staff.Track,endVolume=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(track.PlaybackInfo.Volume),volumeFactor=endVolume/noteDuration,tickStep=120,steps=noteDuration/tickStep|0,endTick=noteStart+noteDuration,i=steps-1;i>=0;i--){var tick=endTick-i*tickStep,volume=(tick-noteStart)*volumeFactor;i==steps-1&&(this._handler.AddControlChange(track.Index,noteStart,track.PlaybackInfo.PrimaryChannel,7,volume),this._handler.AddControlChange(track.Index,noteStart,track.PlaybackInfo.SecondaryChannel,7,volume)),this._handler.AddControlChange(track.Index,tick,track.PlaybackInfo.PrimaryChannel,7,volume),this._handler.AddControlChange(track.Index,tick,track.PlaybackInfo.SecondaryChannel,7,volume)}},GenerateHarmonic:function(){},GenerateVibrato:function(note,noteStart,noteDuration){var phaseLength=480,bendAmplitude=2,track=note.Beat.Voice.Bar.Staff.Track;this.GenerateVibratorWithParams(track,noteStart,noteDuration,phaseLength,bendAmplitude)},GenerateVibratorWithParams:function(track,noteStart,noteDuration,phaseLength,bendAmplitude){var resolution=16,phaseHalf=phaseLength/2|0;noteStart+=phaseLength;for(var noteEnd=noteStart+noteDuration;noteEnd>noteStart;){for(var phase=0,phaseDuration=noteEnd>noteStart+phaseLength?phaseLength:noteEnd-noteStart;phaseDuration>phase;){var bend=bendAmplitude*Math.sin(3.14159265358979*phase/phaseHalf);this._handler.AddBend(track.Index,noteStart+phase,track.PlaybackInfo.PrimaryChannel,64+bend),phase+=resolution}noteStart+=phaseLength}},GenerateSlide:function(){},GenerateWhammyBar:function(){},GenerateBend:function(note,noteStart,noteDuration){for(var track=note.Beat.Voice.Bar.Staff.Track,ticksPerPosition=noteDuration/60,i=0;i<note.BendPoints.length-1;i++){var currentPoint=note.BendPoints[i],nextPoint=note.BendPoints[i+1],currentBendValue=64+2.75*currentPoint.Value,nextBendValue=64+2.75*nextPoint.Value,ticksBetweenPoints=ticksPerPosition*(nextPoint.Offset-currentPoint.Offset),ticksPerValue=ticksBetweenPoints/Math.abs(nextBendValue-currentBendValue),tick=noteStart+ticksPerPosition*currentPoint.Offset;if(nextBendValue>currentBendValue)for(;nextBendValue>=currentBendValue;)this._handler.AddBend(track.Index,0|tick,track.PlaybackInfo.PrimaryChannel,Math.round(currentBendValue)),currentBendValue++,tick+=ticksPerValue;else if(currentBendValue>nextBendValue)for(;currentBendValue>=nextBendValue;)this._handler.AddBend(track.Index,0|tick,track.PlaybackInfo.PrimaryChannel,Math.round(currentBendValue)),currentBendValue--,tick+=ticksPerValue}},GenerateTrill:function(note,noteStart,noteDuration,noteKey,dynamicValue){for(var track=note.Beat.Voice.Bar.Staff.Track,trillKey=note.get_StringTuning()+note.get_TrillFret(),trillLength=AlphaTab.Audio.MidiUtils.ToTicks(note.TrillSpeed),realKey=!0,tick=noteStart;noteStart+noteDuration>tick+10;)tick+trillLength>=noteStart+noteDuration&&(trillLength=noteStart+noteDuration-tick),this._handler.AddNote(track.Index,tick,trillLength,realKey?trillKey:noteKey,dynamicValue,track.PlaybackInfo.PrimaryChannel),realKey=!realKey,tick+=trillLength},GenerateTremoloPicking:function(note,noteStart,noteDuration,noteKey,dynamicValue){for(var track=note.Beat.Voice.Bar.Staff.Track,tpLength=AlphaTab.Audio.MidiUtils.ToTicks(note.Beat.TremoloSpeed),tick=noteStart;noteStart+noteDuration>tick+10;)tick+tpLength>=noteStart+noteDuration&&(tpLength=noteStart+noteDuration-tick),this._handler.AddNote(track.Index,tick,tpLength,noteKey,dynamicValue,track.PlaybackInfo.PrimaryChannel),tick+=tpLength},GetBrushInfo:function(beat){var brushInfo=new Int32Array(beat.Voice.Bar.Staff.Track.Tuning.length);if(beat.BrushType!=AlphaTab.Model.BrushType.None){for(var stringUsed=0,i=0,j=beat.Notes.length;j>i;i++){var n=beat.Notes[i];n.IsTieDestination||(stringUsed|=1<<n.String-1)}if(beat.Notes.length>0)for(var brushMove=0,brushIncrement=this.GetBrushIncrement(beat),i=0,j=beat.Voice.Bar.Staff.Track.Tuning.length;j>i;i++){var index=beat.BrushType==AlphaTab.Model.BrushType.ArpeggioDown||beat.BrushType==AlphaTab.Model.BrushType.BrushDown?i:brushInfo.length-1-i;0!=(stringUsed&1<<index)&&(brushInfo[index]=brushMove,brushMove=brushIncrement)}}return brushInfo},GetBrushIncrement:function(beat){if(0==beat.BrushDuration)return 0;var duration=beat.CalculateDuration();return 0==duration?0:duration/8*(4/beat.BrushDuration)|0},GenerateAutomation:function(beat,automation,startMove){switch(automation.Type){case AlphaTab.Model.AutomationType.Instrument:this._handler.AddProgramChange(beat.Voice.Bar.Staff.Track.Index,beat.Start+startMove,beat.Voice.Bar.Staff.Track.PlaybackInfo.PrimaryChannel,automation.Value),this._handler.AddProgramChange(beat.Voice.Bar.Staff.Track.Index,beat.Start+startMove,beat.Voice.Bar.Staff.Track.PlaybackInfo.SecondaryChannel,automation.Value);break;case AlphaTab.Model.AutomationType.Balance:this._handler.AddControlChange(beat.Voice.Bar.Staff.Track.Index,beat.Start+startMove,beat.Voice.Bar.Staff.Track.PlaybackInfo.PrimaryChannel,10,automation.Value),this._handler.AddControlChange(beat.Voice.Bar.Staff.Track.Index,beat.Start+startMove,beat.Voice.Bar.Staff.Track.PlaybackInfo.SecondaryChannel,10,automation.Value);break;case AlphaTab.Model.AutomationType.Volume:this._handler.AddControlChange(beat.Voice.Bar.Staff.Track.Index,beat.Start+startMove,beat.Voice.Bar.Staff.Track.PlaybackInfo.PrimaryChannel,7,automation.Value),this._handler.AddControlChange(beat.Voice.Bar.Staff.Track.Index,beat.Start+startMove,beat.Voice.Bar.Staff.Track.PlaybackInfo.SecondaryChannel,7,automation.Value)}}},$StaticConstructor(function(){AlphaTab.Audio.Generator.MidiFileGenerator.DefaultBend=64,AlphaTab.Audio.Generator.MidiFileGenerator.DefaultBendSemitone=2.75}),AlphaTab.Audio.Generator.MidiFileGenerator.GenerateMidiFile=function(score,generateMetronome){for(var midiFile=new AlphaTab.Audio.Model.MidiFile,i=0,j=score.Tracks.length;j>i;i++)midiFile.CreateTrack();midiFile.InfoTrack=0;var handler=new AlphaTab.Audio.Generator.MidiFileHandler(midiFile),generator=new AlphaTab.Audio.Generator.MidiFileGenerator(score,handler,generateMetronome);return generator.Generate(),midiFile.TickLookup=generator.TickLookup,midiFile},AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort=function(data){var value=Math.max(-32768,Math.min(32767,8*data-1));return Math.max(value,-1)+1},AlphaTab.Audio.Generator.MidiFileHandler=function(midiFile){this._midiFile=null,this._metronomeTrack=0,this._midiFile=midiFile,this._metronomeTrack=-1},AlphaTab.Audio.Generator.MidiFileHandler.prototype={AddEvent:function(track,tick,message){this._midiFile.Tracks[track].AddEvent(new AlphaTab.Audio.Model.MidiEvent(tick,message))},MakeCommand:function(command,channel){return 240&command|15&channel},AddTimeSignature:function(tick,timeSignatureNumerator,timeSignatureDenominator){for(var denominatorIndex=0;(timeSignatureDenominator>>=1)>0;)denominatorIndex++;this.AddEvent(this._midiFile.InfoTrack,tick,AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage(88,new Uint8Array([255&timeSignatureNumerator,255&denominatorIndex,48,8])))},AddRest:function(track,tick){this.AddEvent(track,tick,AlphaTab.Audio.Generator.MidiFileHandler.BuildSysExMessage(new Uint8Array([0])))},AddNote:function(track,start,length,key,dynamicValue,channel){var velocity=AlphaTab.Audio.MidiUtils.DynamicToVelocity(dynamicValue);this.AddEvent(track,start,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(144,channel),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(key),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(velocity)]))),this.AddEvent(track,start+length,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(128,channel),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(key),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(velocity)])))},AddControlChange:function(track,tick,channel,controller,value){this.AddEvent(track,tick,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(176,channel),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(controller),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(value)])))},AddProgramChange:function(track,tick,channel,program){this.AddEvent(track,tick,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(192,channel),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(program)])))},AddTempo:function(tick,tempo){var tempoInUsq=6e7/tempo|0;this.AddEvent(this._midiFile.InfoTrack,tick,AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage(81,new Uint8Array([tempoInUsq>>16&255,tempoInUsq>>8&255,255&tempoInUsq])))},FinishTrack:function(track,tick){this.AddEvent(this._midiFile.InfoTrack,tick,AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage(47,new Uint8Array(0)))},AddBend:function(track,tick,channel,value){this.AddEvent(track,tick,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(224,channel),0,AlphaTab.Audio.Generator.MidiFileHandler.FixValue(value)])))},AddMetronome:function(start,length){-1==this._metronomeTrack&&(this._midiFile.CreateTrack(),this._metronomeTrack=this._midiFile.Tracks.length-1),this.AddNote(this._metronomeTrack,start,length,37,AlphaTab.Model.DynamicValue.F,9)}},$StaticConstructor(function(){AlphaTab.Audio.Generator.MidiFileHandler.DefaultMetronomeKey=37,AlphaTab.Audio.Generator.MidiFileHandler.DefaultDurationDead=30,AlphaTab.Audio.Generator.MidiFileHandler.DefaultDurationPalmMute=80,AlphaTab.Audio.Generator.MidiFileHandler.RestMessage=0}),AlphaTab.Audio.Generator.MidiFileHandler.FixValue=function(value){return value>127?127:value},AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage=function(metaType,data){var meta=AlphaTab.IO.ByteBuffer.Empty();return meta.WriteByte(255),meta.WriteByte(255&metaType),AlphaTab.Audio.Generator.MidiFileHandler.WriteVarInt(meta,data.length),meta.Write(data,0,data.length),new AlphaTab.Audio.Model.MidiMessage(meta.ToArray())},AlphaTab.Audio.Generator.MidiFileHandler.WriteVarInt=function(data,v){var n=0,array=new Uint8Array(4);do array[n++]=127&v&255,v>>=7;while(v>0);for(;n>0;)n--,data.WriteByte(n>0?255&(128|array[n]):array[n])},AlphaTab.Audio.Generator.MidiFileHandler.BuildSysExMessage=function(data){var sysex=AlphaTab.IO.ByteBuffer.Empty();return sysex.WriteByte(240),AlphaTab.Audio.Generator.MidiFileHandler.WriteVarInt(sysex,data.length+2),sysex.WriteByte(0),sysex.Write(data,0,data.length),sysex.WriteByte(247),new AlphaTab.Audio.Model.MidiMessage(sysex.ToArray())},AlphaTab.Audio.Generator.MidiPlaybackController=function(score){this._score=null,this._repeatStartIndex=0,this._repeatNumber=0,this._repeatOpen=!1,this.ShouldPlay=!1,this.Index=0,this.CurrentTick=0,this._score=score,this.ShouldPlay=!0,this.Index=0,this.CurrentTick=0},AlphaTab.Audio.Generator.MidiPlaybackController.prototype={get_Finished:function(){return this.Index>=this._score.MasterBars.length},ProcessCurrent:function(){var masterBar=this._score.MasterBars[this.Index],masterBarAlternateEndings=masterBar.AlternateEndings;masterBar.RepeatGroup.IsClosed||masterBar.RepeatGroup.Openings[masterBar.RepeatGroup.Openings.length-1]!=masterBar||(this._repeatNumber=0,this._repeatOpen=!1),!masterBar.IsRepeatStart&&0!=masterBar.Index||0!=this._repeatNumber?masterBar.IsRepeatStart&&(this.ShouldPlay=!0):(this._repeatStartIndex=this.Index,this._repeatOpen=!0),this._repeatOpen&&masterBarAlternateEndings>0&&(this.ShouldPlay=0==(masterBarAlternateEndings&1<<this._repeatNumber)?!1:!0),this.ShouldPlay&&(this.CurrentTick+=masterBar.CalculateDuration())},MoveNext:function(){var masterBar=this._score.MasterBars[this.Index],masterBarRepeatCount=masterBar.RepeatCount-1;this._repeatOpen&&masterBarRepeatCount>0?this._repeatNumber<masterBarRepeatCount?(this.Index=this._repeatStartIndex,this._repeatNumber++):(this._repeatNumber=0,this._repeatOpen=!1,this.ShouldPlay=!0,this.Index++):this.Index++}},AlphaTab.Audio.MidiUtils=function(){},$StaticConstructor(function(){AlphaTab.Audio.MidiUtils.QuarterTime=960,AlphaTab.Audio.MidiUtils.PercussionChannel=9,AlphaTab.Audio.MidiUtils.MinVelocity=15,AlphaTab.Audio.MidiUtils.VelocityIncrement=16}),AlphaTab.Audio.MidiUtils.TicksToMillis=function(ticks,tempo){return ticks*(6e4/(960*tempo))|0},AlphaTab.Audio.MidiUtils.ToTicks=function(duration){return AlphaTab.Audio.MidiUtils.ValueToTicks(duration)},AlphaTab.Audio.MidiUtils.ValueToTicks=function(duration){var denomninator=duration;return 0>denomninator&&(denomninator=1/-denomninator),960*(4/denomninator)|0},AlphaTab.Audio.MidiUtils.ApplyDot=function(ticks,doubleDotted){return doubleDotted?ticks+3*(ticks/4|0):ticks+ticks/2|0},AlphaTab.Audio.MidiUtils.ApplyTuplet=function(ticks,numerator,denominator){return ticks*denominator/numerator|0},AlphaTab.Audio.MidiUtils.DynamicToVelocity=function(dyn){return 15+16*dyn},AlphaTab.Audio.Model=AlphaTab.Audio.Model||{},AlphaTab.Audio.Model.MidiController={DataEntryCoarse:6,VolumeCoarse:7,PanCoarse:10,ExpressionControllerCoarse:11,DataEntryFine:38,RegisteredParameterFine:100,RegisteredParameterCourse:101},AlphaTab.Audio.Model.MidiEvent=function(tick,message){this.Track=null,this.Tick=0,this.Message=null,this.NextEvent=null,this.PreviousEvent=null,this.Tick=tick,this.Message=message},AlphaTab.Audio.Model.MidiEvent.prototype={get_DeltaTicks:function(){return null==this.PreviousEvent?0:this.Tick-this.PreviousEvent.Tick},WriteTo:function(s){this.WriteVariableInt(s,this.get_DeltaTicks()),this.Message.WriteTo(s)},WriteVariableInt:function(s,value){var array=new Uint8Array(4),n=0;do array[n++]=127&value&255,value>>=7;while(value>0);for(;n>0;)n--,s.WriteByte(n>0?128|array[n]:array[n])}},AlphaTab.Audio.Model.MidiFile=function(){this.TickLookup=null,this.Tracks=null,this.InfoTrack=0,this.Tracks=[]},AlphaTab.Audio.Model.MidiFile.prototype={CreateTrack:function(){var track=new AlphaTab.Audio.Model.MidiTrack;return track.Index=this.Tracks.length,track.File=this,this.Tracks.push(track),track},WriteTo:function(s){var b=new Uint8Array([77,84,104,100]);s.Write(b,0,b.length),b=new Uint8Array([0,0,0,6]),s.Write(b,0,b.length),b=new Uint8Array([0,1]),s.Write(b,0,b.length);var v=0|this.Tracks.length;b=new Uint8Array([v>>8&255,255&v]),s.Write(b,0,b.length),v=960,b=new Uint8Array([v>>8&255,255&v]),s.Write(b,0,b.length);for(var i=0,j=this.Tracks.length;j>i;i++)this.Tracks[i].WriteTo(s)}},AlphaTab.Audio.Model.MidiMessage=function(data){this.Event=null,this.Data=null,this.Data=data},AlphaTab.Audio.Model.MidiMessage.prototype={WriteTo:function(s){s.Write(this.Data,0,this.Data.length)}},AlphaTab.Audio.Model.BeatTickLookup=function(){this.Start=0,this.End=0,this.Beat=null},AlphaTab.Audio.Model.MasterBarTickLookup=function(){this.Start=0,this.End=0,this.Tempo=0,this.MasterBar=null,this.Beats=null,this.Beats=[]},AlphaTab.Audio.Model.MasterBarTickLookup.prototype={Finish:function(){this.Beats.sort($CreateAnonymousDelegate(this,function(a,b){return a.Start-b.Start}))},AddBeat:function(beat){this.Beats.push(beat)}},AlphaTab.Audio.Model.MidiTickLookupFindBeatResult=function(){this.CurrentBeat=null,this.NextBeat=null,this.Duration=0},AlphaTab.Audio.Model.MidiTickLookup=function(){this._currentMasterBar=null,this.MasterBarLookup=null,this.MasterBars=null,this.MasterBars=[],this.MasterBarLookup={}},AlphaTab.Audio.Model.MidiTickLookup.prototype={Finish:function(){for(var i=0;i<this.MasterBars.length;i++)this.MasterBars[i].Finish()},FindBeat:function(tracks,tick){var masterBar=this.FindMasterBar(tick);if(null==masterBar)return null;for(var trackLookup={},$i17=0,$l17=tracks.length,track=tracks[$i17];$l17>$i17;$i17++,track=tracks[$i17])trackLookup[track.Index]=!0;for(var beat=null,index=0,beats=masterBar.Beats,b=0;b<beats.length;b++){var currentBeat=beats[b];if(trackLookup.hasOwnProperty(currentBeat.Beat.Voice.Bar.Staff.Track.Index))if(currentBeat.Start<=tick&&tick<currentBeat.End)(null==beat||beat.Start<currentBeat.Start)&&(beat=beats[b],index=b);else if(currentBeat.End>tick)break}if(null==beat)return null;for(var nextBeat=null,b=index+1;b<beats.length;b++){var currentBeat=beats[b];if(trackLookup.hasOwnProperty(currentBeat.Beat.Voice.Bar.Staff.Track.Index)){nextBeat=currentBeat;break}}if(null==nextBeat&&null!=masterBar.MasterBar.NextMasterBar){var nextBar=this.GetMasterBar(masterBar.MasterBar.NextMasterBar);beats=nextBar.Beats;for(var b=0;b<beats.length;b++){var currentBeat=beats[b];if(trackLookup.hasOwnProperty(currentBeat.Beat.Voice.Bar.Staff.Track.Index)){nextBeat=currentBeat;break}}}var result=new AlphaTab.Audio.Model.MidiTickLookupFindBeatResult;return result.CurrentBeat=beat.Beat,result.NextBeat=null==nextBeat?null:nextBeat.Beat,result.Duration=AlphaTab.Audio.MidiUtils.TicksToMillis(beat.End-beat.Start,masterBar.Tempo),result},FindMasterBar:function(tick){for(var bars=this.MasterBars,bottom=0,top=bars.length-1;top>=bottom;){var middle=(top+bottom)/2|0,bar=bars[middle];if(tick>=bar.Start&&tick<bar.End)return bar;tick<bar.Start?top=middle-1:bottom=middle+1}return null},GetMasterBar:function(bar){return this.MasterBarLookup.hasOwnProperty(bar.Index)?this.MasterBarLookup[bar.Index]:function(){var $v1=new AlphaTab.Audio.Model.MasterBarTickLookup;return $v1.Start=0,$v1.End=0,$v1.Beats=[],$v1.MasterBar=bar,$v1}.call(this)},GetMasterBarStart:function(bar){return this.MasterBarLookup.hasOwnProperty(bar.Index)?this.MasterBarLookup[bar.Index].Start:0},AddMasterBar:function(masterBar){this.MasterBars.push(masterBar),this._currentMasterBar=masterBar,this.MasterBarLookup.hasOwnProperty(masterBar.MasterBar.Index)||(this.MasterBarLookup[masterBar.MasterBar.Index]=masterBar)},AddBeat:function(beat){this._currentMasterBar.AddBeat(beat)}},AlphaTab.Audio.Model.MidiTrack=function(){this.Index=0,this.File=null,this.FirstEvent=null,this.LastEvent=null},AlphaTab.Audio.Model.MidiTrack.prototype={AddEvent:function(e){if(e.Track=this,null==this.FirstEvent)this.FirstEvent=e,this.LastEvent=e;else if(this.LastEvent.Tick<=e.Tick)this.LastEvent.NextEvent=e,e.PreviousEvent=this.LastEvent,this.LastEvent=e;else if(this.FirstEvent.Tick>e.Tick)e.NextEvent=this.FirstEvent,this.FirstEvent.PreviousEvent=e,this.FirstEvent=e;else{var firstDelta=e.Tick-this.FirstEvent.Tick,lastDelta=this.LastEvent.Tick-e.Tick;if(lastDelta>firstDelta){for(var previous=this.FirstEvent;null!=previous&&null!=previous.NextEvent&&previous.NextEvent.Tick<=e.Tick;)previous=previous.NextEvent;if(null==previous)return;var next=previous.NextEvent;previous.NextEvent=e,e.PreviousEvent=previous,e.NextEvent=next,null!=next&&(next.PreviousEvent=e)}else{for(var next=this.LastEvent;null!=next&&null!=next.PreviousEvent&&next.PreviousEvent.Tick>e.Tick;)next=next.PreviousEvent;if(null==next)return;var previous=next.PreviousEvent;next.PreviousEvent=e,e.NextEvent=next,e.PreviousEvent=previous,null!=previous?previous.NextEvent=e:this.FirstEvent=e}}},WriteTo:function(s){for(var trackData=AlphaTab.IO.ByteBuffer.Empty(),current=this.FirstEvent,count=0;null!=current;)current.WriteTo(trackData),current=current.NextEvent,count++;var b=new Uint8Array([77,84,114,107]);s.Write(b,0,b.length);var data=trackData.ToArray(),l=data.length;b=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,l>>0&255]),s.Write(b,0,b.length),s.Write(data,0,data.length)}},AlphaTab.Exporter=AlphaTab.Exporter||{},AlphaTab.Exporter.AlphaTexExporter=function(){this._builder=null,this._builder=new String},AlphaTab.Exporter.AlphaTexExporter.prototype={Export:function(track){this.Score(track)},Score:function(track){this.MetaData(track),this.Bars(track)},ToTex:function(){return this._builder},MetaData:function(track){var score=track.Score;this.StringMetaData("title",score.Title),this.StringMetaData("subtitle",score.SubTitle),this.StringMetaData("artist",score.Artist),this.StringMetaData("album",score.Album),this.StringMetaData("words",score.Words),this.StringMetaData("music",score.Music),this.StringMetaData("copyright",score.Copyright),this._builder+="\\tempo ",this._builder+=score.Tempo,this._builder+="\r\n",track.Capo>0&&(this._builder+="\\capo ",this._builder+=track.Capo,this._builder+="\r\n"),this._builder+="\\tuning";for(var i=0;i<track.Tuning.length;i++)this._builder+=" ",this._builder+=AlphaTab.Model.Tuning.GetTextForTuning(track.Tuning[i],!0);this._builder+="\\instrument ",this._builder+=track.PlaybackInfo.Program,this._builder+="\r\n",this._builder+=".",this._builder+="\r\n"},StringMetaData:function(key,value){AlphaTab.Platform.Std.IsNullOrWhiteSpace(value)||(this._builder+="\\",this._builder+=key,this._builder+=' "',this._builder+=value.replace('"','\\"'),this._builder+='"',this._builder+="\r\n")},Bars:function(track){for(var i=0;1>i;i++)for(var j=0;j<track.Staves[i].Bars.length;j++)i>0&&(this._builder+=" |",this._builder+="\r\n"),this.Bar(track.Staves[i].Bars[j])},Bar:function(bar){this.BarMeta(bar),this.Voice(bar.Voices[0])},Voice:function(voice){for(var i=0;i<voice.Beats.length;i++)this.Beat(voice.Beats[i])},Beat:function(beat){if(beat.get_IsRest())this._builder+="r";else{beat.Notes.length>1&&(this._builder+="(");for(var i=0;i<beat.Notes.length;i++)this.Note(beat.Notes[i]);beat.Notes.length>1&&(this._builder+=")")}this._builder+=".",this._builder+=beat.Duration,this._builder+=" ",this.BeatEffects(beat)},Note:function(note){this._builder+=note.IsDead?"x":note.IsTieDestination?"-":note.Fret,this._builder+=".",this._builder+=note.Beat.Voice.Bar.Staff.Track.Tuning.length-note.String+1,this._builder+=" ",this.NoteEffects(note)},NoteEffects:function(note){var hasEffectOpen=!1;if(note.get_HasBend()){hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="be (";for(var i=0;i<note.BendPoints.length;i++)this._builder+=note.BendPoints[i].Offset,this._builder+=" ",this._builder+=note.BendPoints[i].Value,this._builder+=" ";this._builder+=")"}switch(note.HarmonicType){case AlphaTab.Model.HarmonicType.Natural:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="nh ";break;case AlphaTab.Model.HarmonicType.Artificial:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="ah ";break;case AlphaTab.Model.HarmonicType.Tap:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="th ";break;case AlphaTab.Model.HarmonicType.Pinch:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="ph ";break;case AlphaTab.Model.HarmonicType.Semi:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="sh "}if(note.get_IsTrill())switch(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="tr ",this._builder+=note.get_TrillFret(),this._builder+=" ",note.TrillSpeed){case AlphaTab.Model.Duration.Sixteenth:this._builder+="16 ";break;case AlphaTab.Model.Duration.ThirtySecond:this._builder+="32 ";break;case AlphaTab.Model.Duration.SixtyFourth:this._builder+="64 "}switch(note.Vibrato!=AlphaTab.Model.VibratoType.None&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="v "),note.SlideType==AlphaTab.Model.SlideType.Legato&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="sl "),note.SlideType==AlphaTab.Model.SlideType.Shift&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="ss "),note.IsHammerPullOrigin&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="h "),note.IsGhost&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="g "),note.Accentuated==AlphaTab.Model.AccentuationType.Normal?(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="ac "):note.Accentuated==AlphaTab.Model.AccentuationType.Heavy&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="hac "),note.IsPalmMute&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="pm "),note.IsStaccato&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="st "),note.IsLetRing&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="lr "),note.LeftHandFinger){case AlphaTab.Model.Fingers.Thumb:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="1 ";break;case AlphaTab.Model.Fingers.IndexFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="2 ";break;case AlphaTab.Model.Fingers.MiddleFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="3 ";break;case AlphaTab.Model.Fingers.AnnularFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="4 ";break;case AlphaTab.Model.Fingers.LittleFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="5 "}switch(note.RightHandFinger){case AlphaTab.Model.Fingers.Thumb:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="1 ";break;case AlphaTab.Model.Fingers.IndexFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="2 ";break;case AlphaTab.Model.Fingers.MiddleFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="3 ";break;case AlphaTab.Model.Fingers.AnnularFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="4 ";break;case AlphaTab.Model.Fingers.LittleFinger:hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="5 "}this.EffectClose(hasEffectOpen)},EffectOpen:function(hasBeatEffectOpen){return hasBeatEffectOpen||(this._builder+="{"),!0},EffectClose:function(hasBeatEffectOpen){hasBeatEffectOpen&&(this._builder+="}")},BeatEffects:function(beat){var hasEffectOpen=!1;switch(beat.FadeIn&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="f "),beat.GraceType){case AlphaTab.Model.GraceType.OnBeat:this._builder+="gr ob ";break;case AlphaTab.Model.GraceType.BeforeBeat:this._builder+="gr "}if(beat.Vibrato!=AlphaTab.Model.VibratoType.None&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="v "),beat.Slap&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="s "),beat.Pop&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="p "),2==beat.Dots?(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="dd "):1==beat.Dots&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="d "),beat.PickStroke==AlphaTab.Model.PickStrokeType.Up?(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="su "):beat.PickStroke==AlphaTab.Model.PickStrokeType.Down&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="sd "),beat.get_HasTuplet()){var tupletValue=0;3==beat.TupletDenominator&&2==beat.TupletNumerator?tupletValue=3:5==beat.TupletDenominator&&4==beat.TupletNumerator?tupletValue=5:6==beat.TupletDenominator&&4==beat.TupletNumerator?tupletValue=6:7==beat.TupletDenominator&&4==beat.TupletNumerator?tupletValue=7:9==beat.TupletDenominator&&8==beat.TupletNumerator?tupletValue=9:10==beat.TupletDenominator&&8==beat.TupletNumerator?tupletValue=10:11==beat.TupletDenominator&&8==beat.TupletNumerator?tupletValue=11:12==beat.TupletDenominator&&8==beat.TupletNumerator&&(tupletValue=12),0!=tupletValue&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="tu ",this._builder+=tupletValue,this._builder+=" ")}if(beat.get_HasWhammyBar()){hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="tbe (";for(var i=0;i<beat.WhammyBarPoints.length;i++)this._builder+=beat.WhammyBarPoints[i].Offset,this._builder+=" ",this._builder+=beat.WhammyBarPoints[i].Value,this._builder+=" ";this._builder+=")"}beat.get_IsTremolo()&&(hasEffectOpen=this.EffectOpen(hasEffectOpen),this._builder+="tp ",this._builder+=beat.TremoloSpeed==AlphaTab.Model.Duration.Eighth?"8 ":beat.TremoloSpeed==AlphaTab.Model.Duration.Sixteenth?"16 ":beat.TremoloSpeed==AlphaTab.Model.Duration.ThirtySecond?"32 ":"8 "),this.EffectClose(hasEffectOpen)},BarMeta:function(bar){var masterBar=bar.get_MasterBar();if(masterBar.Index>0){var previousMasterBar=masterBar.PreviousMasterBar,previousBar=bar.PreviousBar;if((previousMasterBar.TimeSignatureDenominator!=masterBar.TimeSignatureDenominator||previousMasterBar.TimeSignatureNumerator!=masterBar.TimeSignatureNumerator)&&(this._builder+="\\ts ",this._builder+=masterBar.TimeSignatureNumerator,this._builder+=" ",this._builder+=masterBar.TimeSignatureDenominator,this._builder+="\r\n"),previousMasterBar.KeySignature!=masterBar.KeySignature){switch(this._builder+="\\ks ",masterBar.KeySignature){case-7:this._builder+="cb";break;case-6:this._builder+="gb";break;case-5:this._builder+="db";break;case-4:
this._builder+="ab";break;case-3:this._builder+="eb";break;case-2:this._builder+="bb";break;case-1:this._builder+="f";break;case 0:this._builder+="c";break;case 1:this._builder+="g";break;case 2:this._builder+="d";break;case 3:this._builder+="a";break;case 4:this._builder+="e";break;case 5:this._builder+="b";break;case 6:this._builder+="f#";break;case 7:this._builder+="c#"}this._builder+="\r\n"}if(bar.Clef!=previousBar.Clef){switch(this._builder+="\\clef ",bar.Clef){case AlphaTab.Model.Clef.Neutral:this._builder+="n";break;case AlphaTab.Model.Clef.C3:this._builder+="c3";break;case AlphaTab.Model.Clef.C4:this._builder+="c4";break;case AlphaTab.Model.Clef.F4:this._builder+="f4";break;case AlphaTab.Model.Clef.G2:this._builder+="g2"}this._builder+="\r\n"}null!=masterBar.TempoAutomation&&(this._builder+="\\tempo ",this._builder+=masterBar.TempoAutomation.Value,this._builder+="\r\n")}masterBar.IsRepeatStart&&(this._builder+="\\ro ",this._builder+="\r\n"),masterBar.get_IsRepeatEnd()&&(this._builder+="\\rc ",this._builder+=masterBar.RepeatCount+1,this._builder+="\r\n")}},AlphaTab.Importer=AlphaTab.Importer||{},AlphaTab.Importer.AlphaTexException=function(position,nonTerm,expected,symbol,symbolData){this.Position=0,this.NonTerm=null,this.Expected=AlphaTab.Importer.AlphaTexSymbols.No,this.Symbol=AlphaTab.Importer.AlphaTexSymbols.No,this.SymbolData=null,this.Position=position,this.NonTerm=nonTerm,this.Expected=expected,this.Symbol=symbol,this.SymbolData=symbolData},AlphaTab.Importer.AlphaTexException.prototype={get_Message:function(){return null==this.SymbolData?"MalFormed AlphaTex: @"+this.Position+": Error on block "+this.NonTerm+", expected a "+this.Expected+" found a "+this.Symbol:"MalFormed AlphaTex: @"+this.Position+": Error on block "+this.NonTerm+", invalid value: "+this.SymbolData}},AlphaTab.Importer.ScoreImporter=function(){this.Data=null},AlphaTab.Importer.ScoreImporter.prototype={Init:function(data){this.Data=data}},AlphaTab.Importer.ScoreImporter.BuildImporters=function(){return[new AlphaTab.Importer.Gp3To5Importer,new AlphaTab.Importer.GpxImporter,new AlphaTab.Importer.AlphaTexImporter,new AlphaTab.Importer.MusicXmlImporter]},AlphaTab.Importer.AlphaTexImporter=function(){this._score=null,this._track=null,this._ch=0,this._curChPos=0,this._sy=AlphaTab.Importer.AlphaTexSymbols.No,this._syData=null,this._allowNegatives=!1,this._currentDuration=AlphaTab.Model.Duration.QuadrupleWhole,AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.AlphaTexImporter.prototype={get_Name:function(){return"AlphaTex"},ReadScore:function(){try{return this.CreateDefaultScore(),this._curChPos=0,this._currentDuration=AlphaTab.Model.Duration.Quarter,this.NextChar(),this.NewSy(),this.Score(),this._score.Finish(),this._score}catch(e){if(e.exception instanceof AlphaTab.Importer.AlphaTexException)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(e.get_Message()),new Error);throw $CreateException(e,new Error)}},Error:function(nonterm,expected,symbolError){var e;throw e=symbolError?new AlphaTab.Importer.AlphaTexException(this._curChPos,nonterm,expected,this._sy,null):new AlphaTab.Importer.AlphaTexException(this._curChPos,nonterm,expected,expected,this._syData),AlphaTab.Util.Logger.Error(this.get_Name(),e.get_Message()),$CreateException(e,new Error)},CreateDefaultScore:function(){this._score=new AlphaTab.Model.Score,this._score.Tempo=120,this._score.TempoLabel="",this._track=new AlphaTab.Model.Track(1),this._track.PlaybackInfo.Program=25,this._track.PlaybackInfo.PrimaryChannel=AlphaTab.Importer.AlphaTexImporter.TrackChannels[0],this._track.PlaybackInfo.SecondaryChannel=AlphaTab.Importer.AlphaTexImporter.TrackChannels[1],this._track.Tuning=AlphaTab.Model.Tuning.GetDefaultTuningFor(6).Tunings,this._score.AddTrack(this._track)},ParseClef:function(str){switch(str.toLowerCase()){case"g2":case"treble":return AlphaTab.Model.Clef.G2;case"f4":case"bass":return AlphaTab.Model.Clef.F4;case"c3":case"tenor":return AlphaTab.Model.Clef.C3;case"c4":case"alto":return AlphaTab.Model.Clef.C4;case"n":case"neutral":return AlphaTab.Model.Clef.Neutral;default:return AlphaTab.Model.Clef.G2}},ParseKeySignature:function(str){switch(str.toLowerCase()){case"cb":return-7;case"gb":return-6;case"db":return-5;case"ab":return-4;case"eb":return-3;case"bb":return-2;case"f":return-1;case"c":return 0;case"g":return 1;case"d":return 2;case"a":return 3;case"e":return 4;case"b":return 5;case"f#":return 6;case"c#":return 7;default:return 0}},ParseTuning:function(str){var tuning=AlphaTab.Model.TuningParser.GetTuningForText(str);return 0>tuning&&this.Error("tuning-value",AlphaTab.Importer.AlphaTexSymbols.String,!1),tuning},NextChar:function(){var b=this.Data.ReadByte();-1==b?this._ch=0:(this._ch=b,this._curChPos++)},NewSy:function(){this._sy=AlphaTab.Importer.AlphaTexSymbols.No;do if(0==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Eof;else if(AlphaTab.Platform.Std.IsWhiteSpace(this._ch))this.NextChar();else if(47==this._ch)if(this.NextChar(),47==this._ch)for(;13!=this._ch&&10!=this._ch&&0!=this._ch;)this.NextChar();else if(42==this._ch)for(;0!=this._ch;)if(42==this._ch){if(this.NextChar(),47==this._ch){this.NextChar();break}}else this.NextChar();else this.Error("symbol",AlphaTab.Importer.AlphaTexSymbols.String,!1);else if(34==this._ch||39==this._ch){this.NextChar();var s=new String;for(this._sy=AlphaTab.Importer.AlphaTexSymbols.String;34!=this._ch&&39!=this._ch&&0!=this._ch;)s+=String.fromCharCode(this._ch),this.NextChar();this._syData=s,this.NextChar()}else if(45==this._ch)if(this._allowNegatives&&this.IsDigit(this._ch)){var number=this.ReadNumber();this._sy=AlphaTab.Importer.AlphaTexSymbols.Number,this._syData=number}else this._sy=AlphaTab.Importer.AlphaTexSymbols.String,this._syData=this.ReadName();else if(46==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Dot,this.NextChar();else if(58==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.DoubleDot,this.NextChar();else if(40==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.LParensis,this.NextChar();else if(92==this._ch){this.NextChar();var name=this.ReadName();this._sy=AlphaTab.Importer.AlphaTexSymbols.MetaCommand,this._syData=name}else if(41==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.RParensis,this.NextChar();else if(123==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.LBrace,this.NextChar();else if(125==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.RBrace,this.NextChar();else if(124==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Pipe,this.NextChar();else if(42==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Multiply,this.NextChar();else if(this.IsDigit(this._ch)){var number=this.ReadNumber();this._sy=AlphaTab.Importer.AlphaTexSymbols.Number,this._syData=number}else if(AlphaTab.Importer.AlphaTexImporter.IsLetter(this._ch)){var name=this.ReadName();AlphaTab.Model.TuningParser.IsTuning(name)?(this._sy=AlphaTab.Importer.AlphaTexSymbols.Tuning,this._syData=name.toLowerCase()):(this._sy=AlphaTab.Importer.AlphaTexSymbols.String,this._syData=name)}else this.Error("symbol",AlphaTab.Importer.AlphaTexSymbols.String,!1);while(this._sy==AlphaTab.Importer.AlphaTexSymbols.No)},IsDigit:function(code){return code>=48&&57>=code||45==code&&this._allowNegatives},ReadName:function(){var str=new String;do str+=String.fromCharCode(this._ch),this.NextChar();while(AlphaTab.Importer.AlphaTexImporter.IsLetter(this._ch)||this.IsDigit(this._ch));return str},ReadNumber:function(){var str=new String;do str+=String.fromCharCode(this._ch),this.NextChar();while(this.IsDigit(this._ch));return AlphaTab.Platform.Std.ParseInt(str)},Score:function(){this.MetaData(),this.Bars()},MetaData:function(){for(var anyMeta=!1;this._sy==AlphaTab.Importer.AlphaTexSymbols.MetaCommand;){var syData=this._syData.toString().toLowerCase();if("title"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Title=this._syData.toString():this.Error("title",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("subtitle"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.SubTitle=this._syData.toString():this.Error("subtitle",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("artist"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Artist=this._syData.toString():this.Error("artist",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("album"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Album=this._syData.toString():this.Error("album",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("words"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Words=this._syData.toString():this.Error("words",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("music"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Music=this._syData.toString():this.Error("music",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("copyright"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Copyright=this._syData.toString():this.Error("copyright",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),anyMeta=!0;else if("tempo"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Number?this._score.Tempo=this._syData:this.Error("tempo",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this.NewSy(),anyMeta=!0;else if("capo"==syData)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Number?this._track.Capo=this._syData:this.Error("capo",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this.NewSy(),anyMeta=!0;else if("tuning"==syData){if(this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Tuning){var tuning=[];do tuning.push(this.ParseTuning(this._syData.toString().toLowerCase())),this.NewSy();while(this._sy==AlphaTab.Importer.AlphaTexSymbols.Tuning);this._track.Tuning=tuning.slice(0)}else this.Error("tuning",AlphaTab.Importer.AlphaTexSymbols.Tuning,!0);anyMeta=!0}else if("instrument"==syData){if(this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Number){var instrument=this._syData;instrument>=0&&128>=instrument?this._track.PlaybackInfo.Program=this._syData:this.Error("instrument",AlphaTab.Importer.AlphaTexSymbols.Number,!1)}else if(this._sy==AlphaTab.Importer.AlphaTexSymbols.String){var instrumentName=this._syData.toString().toLowerCase();this._track.PlaybackInfo.Program=AlphaTab.Audio.GeneralMidi.GetValue(instrumentName)}else this.Error("instrument",AlphaTab.Importer.AlphaTexSymbols.Number,!0);this.NewSy(),anyMeta=!0}else{if(!anyMeta)break;this.Error("metaDataTags",AlphaTab.Importer.AlphaTexSymbols.String,!1)}}anyMeta?(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Dot&&this.Error("song",AlphaTab.Importer.AlphaTexSymbols.Dot,!0),this.NewSy()):this._sy==AlphaTab.Importer.AlphaTexSymbols.Dot&&this.NewSy()},Bars:function(){for(this.Bar();this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;)this._sy!=AlphaTab.Importer.AlphaTexSymbols.Pipe&&this.Error("bar",AlphaTab.Importer.AlphaTexSymbols.Pipe,!0),this.NewSy(),this.Bar()},Bar:function(){var master=new AlphaTab.Model.MasterBar;this._score.AddMasterBar(master);var bar=new AlphaTab.Model.Bar;this._track.AddBarToStaff(0,bar),master.Index>0&&(master.KeySignature=master.PreviousMasterBar.KeySignature,master.TimeSignatureDenominator=master.PreviousMasterBar.TimeSignatureDenominator,master.TimeSignatureNumerator=master.PreviousMasterBar.TimeSignatureNumerator,bar.Clef=bar.PreviousBar.Clef),this.BarMeta(bar);var voice=new AlphaTab.Model.Voice;for(bar.AddVoice(voice);this._sy!=AlphaTab.Importer.AlphaTexSymbols.Pipe&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;)this.Beat(voice);if(0==voice.Beats.length){var emptyBeat=new AlphaTab.Model.Beat;emptyBeat.IsEmpty=!0,voice.AddBeat(emptyBeat)}},Beat:function(voice){if(this._sy==AlphaTab.Importer.AlphaTexSymbols.DoubleDot)return this._allowNegatives=!0,this.NewSy(),this._allowNegatives=!1,this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("duration",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this._currentDuration=this.ParseDuration(this._syData),void this.NewSy();var beat=new AlphaTab.Model.Beat;if(voice.AddBeat(beat),null!=voice.Bar.get_MasterBar().TempoAutomation&&1==voice.Beats.length&&beat.Automations.push(voice.Bar.get_MasterBar().TempoAutomation),this._sy==AlphaTab.Importer.AlphaTexSymbols.LParensis){for(this.NewSy(),this.Note(beat);this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;)this.Note(beat);this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this.Error("note-list",AlphaTab.Importer.AlphaTexSymbols.RParensis,!0),this.NewSy()}else this._sy==AlphaTab.Importer.AlphaTexSymbols.String&&"r"==this._syData.toString().toLowerCase()?this.NewSy():this.Note(beat);this._sy==AlphaTab.Importer.AlphaTexSymbols.Dot&&(this._allowNegatives=!0,this.NewSy(),this._allowNegatives=!1,this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("duration",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this._currentDuration=this.ParseDuration(this._syData),this.NewSy()),beat.Duration=this._currentDuration;var beatRepeat=1;this._sy==AlphaTab.Importer.AlphaTexSymbols.Multiply&&(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number?this.Error("multiplier",AlphaTab.Importer.AlphaTexSymbols.Number,!0):beatRepeat=this._syData,this.NewSy()),this.BeatEffects(beat);for(var i=0;beatRepeat-1>i;i++)voice.AddBeat(beat.Clone())},BeatEffects:function(beat){if(this._sy==AlphaTab.Importer.AlphaTexSymbols.LBrace){for(this.NewSy();this._sy==AlphaTab.Importer.AlphaTexSymbols.String;)this._syData=this._syData.toString().toLowerCase(),this.ApplyBeatEffect(beat)||this.Error("beat-effects",AlphaTab.Importer.AlphaTexSymbols.String,!1);this._sy!=AlphaTab.Importer.AlphaTexSymbols.RBrace&&this.Error("beat-effects",AlphaTab.Importer.AlphaTexSymbols.RBrace,!0),this.NewSy()}},ApplyBeatEffect:function(beat){var syData=this._syData.toString().toLowerCase();if("f"==syData)return beat.FadeIn=!0,this.NewSy(),!0;if("v"==syData)return beat.Vibrato=AlphaTab.Model.VibratoType.Slight,this.NewSy(),!0;if("s"==syData)return beat.Slap=!0,this.NewSy(),!0;if("p"==syData)return beat.Pop=!0,this.NewSy(),!0;if("dd"==syData)return beat.Dots=2,this.NewSy(),!0;if("d"==syData)return beat.Dots=1,this.NewSy(),!0;if("su"==syData)return beat.PickStroke=AlphaTab.Model.PickStrokeType.Up,this.NewSy(),!0;if("sd"==syData)return beat.PickStroke=AlphaTab.Model.PickStrokeType.Down,this.NewSy(),!0;if("tu"==syData){if(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tuplet",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;var tuplet=this._syData;switch(tuplet){case 3:beat.TupletNumerator=3,beat.TupletDenominator=2;break;case 5:beat.TupletNumerator=5,beat.TupletDenominator=4;break;case 6:beat.TupletNumerator=6,beat.TupletDenominator=4;break;case 7:beat.TupletNumerator=7,beat.TupletDenominator=4;break;case 9:beat.TupletNumerator=9,beat.TupletDenominator=8;break;case 10:beat.TupletNumerator=10,beat.TupletDenominator=8;break;case 11:beat.TupletNumerator=11,beat.TupletDenominator=8;break;case 12:beat.TupletNumerator=12,beat.TupletNumerator=8,beat.TupletDenominator=8}return this.NewSy(),!0}if("tb"==syData||"tbe"==syData){var exact="tbe"==syData;if(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.LParensis)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.LParensis,!0),!1;for(this._allowNegatives=!0,this.NewSy();this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;){var offset,value;if(exact){if(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;if(offset=this._syData,this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;value=this._syData}else{if(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;offset=0,value=this._syData}beat.AddWhammyBarPoint(new AlphaTab.Model.BendPoint(offset,value)),this.NewSy()}for(;beat.WhammyBarPoints.length>60;)beat.RemoveWhammyBarPoint(beat.WhammyBarPoints.length-1);if(exact)beat.WhammyBarPoints.sort($CreateAnonymousDelegate(this,function(a,b){return a.Offset-b.Offset}));else for(var count=beat.WhammyBarPoints.length,step=60/count|0,i=0;count>i;)beat.WhammyBarPoints[i].Offset=Math.min(60,i*step),i++;return this._allowNegatives=!1,this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis?(this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.RParensis,!0),!1):(this.NewSy(),!0)}if("gr"==syData)return this.NewSy(),"ob"==this._syData.toString().toLowerCase()?(beat.GraceType=AlphaTab.Model.GraceType.OnBeat,this.NewSy()):beat.GraceType=AlphaTab.Model.GraceType.BeforeBeat,!0;if("tp"==syData){this.NewSy();var duration=AlphaTab.Model.Duration.Eighth;if(this._sy==AlphaTab.Importer.AlphaTexSymbols.Number){switch(this._syData){case 8:duration=AlphaTab.Model.Duration.Eighth;break;case 16:duration=AlphaTab.Model.Duration.Sixteenth;break;case 32:duration=AlphaTab.Model.Duration.ThirtySecond;break;default:duration=AlphaTab.Model.Duration.Eighth}this.NewSy()}return beat.TremoloSpeed=duration,!0}return!1},Note:function(beat){var syData=this._syData.toString().toLowerCase();this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&(this._sy!=AlphaTab.Importer.AlphaTexSymbols.String||"x"!=syData&&"-"!=syData)&&this.Error("note-fret",AlphaTab.Importer.AlphaTexSymbols.Number,!0);var isDead="x"==syData,isTie="-"==syData,fret=isDead||isTie?0:this._syData;this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Dot&&this.Error("note",AlphaTab.Importer.AlphaTexSymbols.Dot,!0),this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("note-string",AlphaTab.Importer.AlphaTexSymbols.Number,!0);var string=this._syData;(1>string||string>this._track.Tuning.length)&&this.Error("note-string",AlphaTab.Importer.AlphaTexSymbols.Number,!1),this.NewSy();var note=new AlphaTab.Model.Note;beat.AddNote(note),note.String=this._track.Tuning.length-(string-1),note.IsDead=isDead,note.IsTieDestination=isTie,isTie||(note.Fret=fret),this.NoteEffects(note)},NoteEffects:function(note){if(this._sy==AlphaTab.Importer.AlphaTexSymbols.LBrace){for(this.NewSy();this._sy==AlphaTab.Importer.AlphaTexSymbols.String;){var syData=this._syData.toString().toLowerCase();if(this._syData=syData,"b"==syData||"be"==syData){var exact="be"==this._syData;for(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.LParensis&&this.Error("bend-effect",AlphaTab.Importer.AlphaTexSymbols.LParensis,!0),this.NewSy();this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;){var offset=0,value=0;exact?(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("bend-effect-value",AlphaTab.Importer.AlphaTexSymbols.Number,!0),offset=this._syData,this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("bend-effect-value",AlphaTab.Importer.AlphaTexSymbols.Number,!0),value=this._syData):(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("bend-effect-value",AlphaTab.Importer.AlphaTexSymbols.Number,!0),value=this._syData),note.AddBendPoint(new AlphaTab.Model.BendPoint(offset,value)),this.NewSy()}for(;note.BendPoints.length>60;)note.BendPoints.splice(note.BendPoints.length-1,1);if(exact)note.BendPoints.sort($CreateAnonymousDelegate(this,function(a,b){return a.Offset-b.Offset}));else for(var count=note.BendPoints.length,step=60/(count-1)|0,i=0;count>i;)note.BendPoints[i].Offset=Math.min(60,i*step),i++;this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this.Error("bend-effect",AlphaTab.Importer.AlphaTexSymbols.RParensis,!0),this.NewSy()}else if("nh"==syData)note.HarmonicType=AlphaTab.Model.HarmonicType.Natural,this.NewSy();else if("ah"==syData)note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial,this.NewSy();else if("th"==syData)note.HarmonicType=AlphaTab.Model.HarmonicType.Tap,this.NewSy();else if("ph"==syData)note.HarmonicType=AlphaTab.Model.HarmonicType.Pinch,this.NewSy();else if("sh"==syData)note.HarmonicType=AlphaTab.Model.HarmonicType.Semi,this.NewSy();else if("tr"==syData){this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("trill-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0);var fret=this._syData;this.NewSy();var duration=AlphaTab.Model.Duration.Sixteenth;if(this._sy==AlphaTab.Importer.AlphaTexSymbols.Number){switch(this._syData){case 16:duration=AlphaTab.Model.Duration.Sixteenth;break;case 32:duration=AlphaTab.Model.Duration.ThirtySecond;break;case 64:duration=AlphaTab.Model.Duration.SixtyFourth;break;default:duration=AlphaTab.Model.Duration.Sixteenth}this.NewSy()}note.TrillValue=fret+note.get_StringTuning(),note.TrillSpeed=duration}else if("v"==syData)this.NewSy(),note.Vibrato=AlphaTab.Model.VibratoType.Slight;else if("sl"==syData)this.NewSy(),note.SlideType=AlphaTab.Model.SlideType.Legato;else if("ss"==syData)this.NewSy(),note.SlideType=AlphaTab.Model.SlideType.Shift;else if("h"==syData)this.NewSy(),note.IsHammerPullOrigin=!0;else if("g"==syData)this.NewSy(),note.IsGhost=!0;else if("ac"==syData)this.NewSy(),note.Accentuated=AlphaTab.Model.AccentuationType.Normal;else if("hac"==syData)this.NewSy(),note.Accentuated=AlphaTab.Model.AccentuationType.Heavy;else if("pm"==syData)this.NewSy(),note.IsPalmMute=!0;else if("st"==syData)this.NewSy(),note.IsStaccato=!0;else if("lr"==syData)this.NewSy(),note.IsLetRing=!0;else if("x"==syData)this.NewSy(),note.Fret=0,note.IsDead=!0;else if("lf"==syData){this.NewSy();var finger=AlphaTab.Model.Fingers.Thumb;this._sy==AlphaTab.Importer.AlphaTexSymbols.Number&&(finger=this.ToFinger(this._syData),this.NewSy()),note.LeftHandFinger=finger}else if("rf"==syData){this.NewSy();var finger=AlphaTab.Model.Fingers.Thumb;this._sy==AlphaTab.Importer.AlphaTexSymbols.Number&&(finger=this.ToFinger(this._syData),this.NewSy()),note.RightHandFinger=finger}else this.ApplyBeatEffect(note.Beat)||this.Error(syData,AlphaTab.Importer.AlphaTexSymbols.String,!1)}this._sy!=AlphaTab.Importer.AlphaTexSymbols.RBrace&&this.Error("note-effect",AlphaTab.Importer.AlphaTexSymbols.RBrace,!1),this.NewSy()}},ToFinger:function(syData){switch(syData){case 1:return AlphaTab.Model.Fingers.Thumb;case 2:return AlphaTab.Model.Fingers.IndexFinger;case 3:return AlphaTab.Model.Fingers.MiddleFinger;case 4:return AlphaTab.Model.Fingers.AnnularFinger;case 5:return AlphaTab.Model.Fingers.LittleFinger}return AlphaTab.Model.Fingers.Thumb},ParseDuration:function(duration){switch(duration){case-4:return AlphaTab.Model.Duration.QuadrupleWhole;case-2:return AlphaTab.Model.Duration.DoubleWhole;case 1:return AlphaTab.Model.Duration.Whole;case 2:return AlphaTab.Model.Duration.Half;case 4:return AlphaTab.Model.Duration.Quarter;case 8:return AlphaTab.Model.Duration.Eighth;case 16:return AlphaTab.Model.Duration.Sixteenth;case 32:return AlphaTab.Model.Duration.ThirtySecond;case 64:return AlphaTab.Model.Duration.SixtyFourth;case 128:return AlphaTab.Model.Duration.OneHundredTwentyEighth;default:return AlphaTab.Model.Duration.Quarter}},BarMeta:function(bar){for(var master=bar.get_MasterBar();this._sy==AlphaTab.Importer.AlphaTexSymbols.MetaCommand;){var syData=this._syData.toString().toLowerCase();if("ts"==syData)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("timesignature-numerator",AlphaTab.Importer.AlphaTexSymbols.Number,!0),master.TimeSignatureNumerator=this._syData,this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("timesignature-denominator",AlphaTab.Importer.AlphaTexSymbols.Number,!0),master.TimeSignatureDenominator=this._syData;else if("ro"==syData)master.IsRepeatStart=!0;else if("rc"==syData)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("repeatclose",AlphaTab.Importer.AlphaTexSymbols.Number,!0),master.RepeatCount=this._syData-1;else if("ks"==syData)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.String&&this.Error("keysignature",AlphaTab.Importer.AlphaTexSymbols.String,!0),master.KeySignature=this.ParseKeySignature(this._syData.toString().toLowerCase());else if("clef"==syData)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.String&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Tuning&&this.Error("clef",AlphaTab.Importer.AlphaTexSymbols.String,!0),bar.Clef=this.ParseClef(this._syData.toString().toLowerCase());else if("tempo"==syData){this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("tempo",AlphaTab.Importer.AlphaTexSymbols.Number,!0);var tempoAutomation=new AlphaTab.Model.Automation;tempoAutomation.IsLinear=!0,tempoAutomation.Type=AlphaTab.Model.AutomationType.Tempo,tempoAutomation.Value=this._syData,master.TempoAutomation=tempoAutomation}else this.Error("measure-effects",AlphaTab.Importer.AlphaTexSymbols.String,!1);this.NewSy()}}},$StaticConstructor(function(){AlphaTab.Importer.AlphaTexImporter.Eof=0,AlphaTab.Importer.AlphaTexImporter.TrackChannels=new Int32Array([0,1])}),AlphaTab.Importer.AlphaTexImporter.IsLetter=function(code){return!AlphaTab.Importer.AlphaTexImporter.IsTerminal(code)&&(code>=33&&47>=code||code>=58&&126>=code||code>128)},AlphaTab.Importer.AlphaTexImporter.IsTerminal=function(ch){return 46==ch||123==ch||125==ch||91==ch||93==ch||40==ch||41==ch||124==ch||39==ch||34==ch||92==ch},$Inherit(AlphaTab.Importer.AlphaTexImporter,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.AlphaTexSymbols={No:0,Eof:1,Number:2,DoubleDot:3,Dot:4,String:5,Tuning:6,LParensis:7,RParensis:8,LBrace:9,RBrace:10,Pipe:11,MetaCommand:12,Multiply:13},AlphaTab.Importer.Gp3To5Importer=function(){this._versionNumber=0,this._score=null,this._globalTripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,this._lyricsIndex=null,this._lyrics=null,this._barCount=0,this._trackCount=0,this._playbackInfos=null,AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.Gp3To5Importer.prototype={get_Name:function(){return"Guitar Pro 3-5"},ReadScore:function(){return this.ReadVersion(),this._score=new AlphaTab.Model.Score,this.ReadScoreInformation(),this._versionNumber<500&&(this._globalTripletFeel=this.ReadBool()?AlphaTab.Model.TripletFeel.Triplet8th:AlphaTab.Model.TripletFeel.NoTripletFeel),this._versionNumber>=400&&this.ReadLyrics(),this._versionNumber>=510&&this.Data.Skip(19),this._versionNumber>=500&&(this.ReadPageSetup(),this._score.TempoLabel=this.ReadStringIntByte()),this._score.Tempo=this.ReadInt32(),this._versionNumber>=510&&this.ReadBool(),this.ReadInt32(),this._versionNumber>=400&&this.Data.ReadByte(),this.ReadPlaybackInfos(),this._versionNumber>=500&&(this.Data.Skip(38),this.Data.Skip(4)),this._barCount=this.ReadInt32(),this._trackCount=this.ReadInt32(),this.ReadMasterBars(),this.ReadTracks(),this.ReadBars(),this._score.Finish(),this._score},ReadVersion:function(){var version=this.ReadStringByteLength(30);if(0==!version.indexOf("FICHIER GUITAR PRO "))throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);version=version.substr("FICHIER GUITAR PRO ".length+1);var dot=version.indexOf(".");this._versionNumber=100*AlphaTab.Platform.Std.ParseInt(version.substr(0,dot))+AlphaTab.Platform.Std.ParseInt(version.substr(dot+1)),AlphaTab.Util.Logger.Info(this.get_Name(),"Guitar Pro version "+version+" detected")},ReadScoreInformation:function(){this._score.Title=this.ReadStringIntUnused(),this._score.SubTitle=this.ReadStringIntUnused(),this._score.Artist=this.ReadStringIntUnused(),this._score.Album=this.ReadStringIntUnused(),this._score.Words=this.ReadStringIntUnused(),this._score.Music=this._versionNumber>=500?this.ReadStringIntUnused():this._score.Words,this._score.Copyright=this.ReadStringIntUnused(),this._score.Tab=this.ReadStringIntUnused(),this._score.Instructions=this.ReadStringIntUnused();for(var noticeLines=this.ReadInt32(),notice=new String,i=0;noticeLines>i;i++)i>0&&(notice+="\r\n"),notice+=this.ReadStringIntUnused();this._score.Notices=notice},ReadLyrics:function(){this._lyrics=[],this._lyricsIndex=[],this.ReadInt32();for(var i=0;5>i;i++)this._lyricsIndex.push(this.ReadInt32()-1),this._lyrics.push(this.ReadStringInt())},ReadPageSetup:function(){this.Data.Skip(30);for(var i=0;10>i;i++)this.ReadStringIntByte()},ReadPlaybackInfos:function(){this._playbackInfos=[];for(var i=0;64>i;i++){var info=new AlphaTab.Model.PlaybackInformation;info.PrimaryChannel=i,info.SecondaryChannel=i,info.Program=this.ReadInt32(),info.Volume=this.Data.ReadByte(),info.Balance=this.Data.ReadByte(),this.Data.Skip(6),this._playbackInfos.push(info)}},ReadMasterBars:function(){for(var i=0;i<this._barCount;i++)this.ReadMasterBar()},ReadMasterBar:function(){var previousMasterBar=null;this._score.MasterBars.length>0&&(previousMasterBar=this._score.MasterBars[this._score.MasterBars.length-1]);var newMasterBar=new AlphaTab.Model.MasterBar,flags=this.Data.ReadByte();if(0!=(1&flags)?newMasterBar.TimeSignatureNumerator=this.Data.ReadByte():null!=previousMasterBar&&(newMasterBar.TimeSignatureNumerator=previousMasterBar.TimeSignatureNumerator),0!=(2&flags)?newMasterBar.TimeSignatureDenominator=this.Data.ReadByte():null!=previousMasterBar&&(newMasterBar.TimeSignatureDenominator=previousMasterBar.TimeSignatureDenominator),newMasterBar.IsRepeatStart=0!=(4&flags),0!=(8&flags)&&(newMasterBar.RepeatCount=this.Data.ReadByte()+(this._versionNumber>=500?0:1)),0!=(16&flags))if(this._versionNumber<500){for(var currentMasterBar=previousMasterBar,existentAlternatives=0;!(null==currentMasterBar||currentMasterBar.get_IsRepeatEnd()&&currentMasterBar!=previousMasterBar||currentMasterBar.IsRepeatStart);)existentAlternatives|=currentMasterBar.AlternateEndings,currentMasterBar=currentMasterBar.PreviousMasterBar;for(var repeatAlternative=0,repeatMask=this.Data.ReadByte(),i=0;8>i;i++){var repeating=1<<i;repeatMask>i&&0==(existentAlternatives&repeating)&&(repeatAlternative|=repeating)}newMasterBar.AlternateEndings=repeatAlternative}else newMasterBar.AlternateEndings=this.Data.ReadByte();if(0!=(32&flags)){var section=new AlphaTab.Model.Section;section.Text=this.ReadStringIntByte(),section.Marker="",this.ReadColor(),newMasterBar.Section=section}if(0!=(64&flags)?(newMasterBar.KeySignature=AlphaTab.Platform.Std.ReadSignedByte(this.Data),newMasterBar.KeySignatureType=this.Data.ReadByte()):null!=previousMasterBar&&(newMasterBar.KeySignature=previousMasterBar.KeySignature,newMasterBar.KeySignatureType=previousMasterBar.KeySignatureType),this._versionNumber>=500&&0!=(3&flags)&&this.Data.Skip(4),this._versionNumber>=500&&0==(16&flags)&&(newMasterBar.AlternateEndings=this.Data.ReadByte()),this._versionNumber>=500){var tripletFeel=this.Data.ReadByte();switch(tripletFeel){case 1:newMasterBar.TripletFeel=AlphaTab.Model.TripletFeel.Triplet8th;break;case 2:newMasterBar.TripletFeel=AlphaTab.Model.TripletFeel.Triplet16th}this.Data.ReadByte()}else newMasterBar.TripletFeel=this._globalTripletFeel;newMasterBar.IsDoubleBar=0!=(128&flags),this._score.AddMasterBar(newMasterBar)},ReadTracks:function(){for(var i=0;i<this._trackCount;i++)this.ReadTrack()},ReadTrack:function(){var newTrack=new AlphaTab.Model.Track(1);this._score.AddTrack(newTrack);var flags=this.Data.ReadByte();newTrack.Name=this.ReadStringByteLength(40),newTrack.IsPercussion=0!=(1&flags);for(var stringCount=this.ReadInt32(),tuning=[],i=0;7>i;i++){var stringTuning=this.ReadInt32();stringCount>i&&tuning.push(stringTuning)}newTrack.Tuning=tuning.slice(0);var port=this.ReadInt32(),index=this.ReadInt32()-1,effectChannel=this.ReadInt32()-1;if(this.Data.Skip(4),index>=0&&index<this._playbackInfos.length){var info=this._playbackInfos[index];info.Port=port,info.IsSolo=0!=(16&flags),info.IsMute=0!=(32&flags),info.SecondaryChannel=effectChannel,newTrack.PlaybackInfo=info}newTrack.Capo=this.ReadInt32(),newTrack.Color=this.ReadColor(),
this._versionNumber>=500&&(this.Data.ReadByte(),this.Data.ReadByte(),this.Data.Skip(43)),this._versionNumber>=510&&(this.Data.Skip(4),this.ReadStringIntByte(),this.ReadStringIntByte())},ReadBars:function(){for(var i=0;i<this._barCount;i++)for(var t=0;t<this._trackCount;t++)this.ReadBar(this._score.Tracks[t])},ReadBar:function(track){var newBar=new AlphaTab.Model.Bar;track.IsPercussion&&(newBar.Clef=AlphaTab.Model.Clef.Neutral),track.AddBarToStaff(0,newBar);var voiceCount=1;this._versionNumber>=500&&(this.Data.ReadByte(),voiceCount=2);for(var v=0;voiceCount>v;v++)this.ReadVoice(track,newBar)},ReadVoice:function(track,bar){var beatCount=this.ReadInt32();if(0!=beatCount){var newVoice=new AlphaTab.Model.Voice;bar.AddVoice(newVoice);for(var i=0;beatCount>i;i++)this.ReadBeat(track,bar,newVoice)}},ReadBeat:function(track,bar,voice){var newBeat=new AlphaTab.Model.Beat,flags=this.Data.ReadByte();if(0!=(1&flags)&&(newBeat.Dots=1),0!=(64&flags)){var type=this.Data.ReadByte();newBeat.IsEmpty=0==(2&type)}voice.AddBeat(newBeat);var duration=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(duration){case-2:newBeat.Duration=AlphaTab.Model.Duration.Whole;break;case-1:newBeat.Duration=AlphaTab.Model.Duration.Half;break;case 0:newBeat.Duration=AlphaTab.Model.Duration.Quarter;break;case 1:newBeat.Duration=AlphaTab.Model.Duration.Eighth;break;case 2:newBeat.Duration=AlphaTab.Model.Duration.Sixteenth;break;case 3:newBeat.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case 4:newBeat.Duration=AlphaTab.Model.Duration.SixtyFourth;break;default:newBeat.Duration=AlphaTab.Model.Duration.Quarter}if(0!=(32&flags))switch(newBeat.TupletNumerator=this.ReadInt32(),newBeat.TupletNumerator){case 1:newBeat.TupletDenominator=1;break;case 3:newBeat.TupletDenominator=2;break;case 5:case 6:case 7:newBeat.TupletDenominator=4;break;case 9:case 10:case 11:case 12:case 13:newBeat.TupletDenominator=8;break;case 2:case 4:case 8:break;default:newBeat.TupletNumerator=1,newBeat.TupletDenominator=1}0!=(2&flags)&&this.ReadChord(newBeat),0!=(4&flags)&&(newBeat.Text=this.ReadStringIntUnused()),0!=(8&flags)&&this.ReadBeatEffects(newBeat),0!=(16&flags)&&this.ReadMixTableChange(newBeat);for(var stringFlags=this.Data.ReadByte(),i=6;i>=0;i--)0!=(stringFlags&1<<i)&&6-i<track.Tuning.length&&this.ReadNote(track,bar,voice,newBeat,6-i);if(this._versionNumber>=500){this.Data.ReadByte();var flag=this.Data.ReadByte();0!=(8&flag)&&this.Data.ReadByte()}},ReadChord:function(beat){var chord=new AlphaTab.Model.Chord,chordId=AlphaTab.Platform.Std.NewGuid();if(this._versionNumber>=500){this.Data.Skip(17),chord.Name=this.ReadStringByteLength(21),this.Data.Skip(4),chord.FirstFret=this.ReadInt32();for(var i=0;7>i;i++){var fret=this.ReadInt32();i<beat.Voice.Bar.Staff.Track.Tuning.length&&chord.Strings.push(fret)}var numberOfBarres=this.Data.ReadByte(),barreFrets=new Uint8Array(5);this.Data.Read(barreFrets,0,barreFrets.length);for(var i=0;numberOfBarres>i;i++)chord.BarreFrets.push(barreFrets[i]);this.Data.Skip(26)}else if(0!=this.Data.ReadByte())if(this._versionNumber>=400){this.Data.Skip(16),chord.Name=this.ReadStringByteLength(21),this.Data.Skip(4),chord.FirstFret=this.ReadInt32();for(var i=0;7>i;i++){var fret=this.ReadInt32();i<beat.Voice.Bar.Staff.Track.Tuning.length&&chord.Strings.push(fret)}var numberOfBarres=this.Data.ReadByte(),barreFrets=new Uint8Array(5);this.Data.Read(barreFrets,0,barreFrets.length);for(var i=0;numberOfBarres>i;i++)chord.BarreFrets.push(barreFrets[i]);this.Data.Skip(26)}else{this.Data.Skip(25),chord.Name=this.ReadStringByteLength(34),chord.FirstFret=this.ReadInt32();for(var i=0;6>i;i++){var fret=this.ReadInt32();i<beat.Voice.Bar.Staff.Track.Tuning.length&&chord.Strings.push(fret)}this.Data.Skip(36)}else{var strings=this._versionNumber>=406?7:6;if(chord.Name=this.ReadStringIntByte(),chord.FirstFret=this.ReadInt32(),chord.FirstFret>0)for(var i=0;strings>i;i++){var fret=this.ReadInt32();i<beat.Voice.Bar.Staff.Track.Tuning.length&&chord.Strings.push(fret)}}null!=chord.Name&&0!=chord.Name.length&&(beat.ChordId=chordId,beat.Voice.Bar.Staff.Track.Chords[beat.ChordId]=chord)},ReadBeatEffects:function(beat){var flags=this.Data.ReadByte(),flags2=0;if(this._versionNumber>=400&&(flags2=this.Data.ReadByte()),beat.FadeIn=0!=(16&flags),(this._versionNumber<400&&0!=(1&flags)||0!=(2&flags))&&(beat.Vibrato=AlphaTab.Model.VibratoType.Slight),beat.HasRasgueado=0!=(1&flags2),0!=(32&flags)&&this._versionNumber>=400){var slapPop=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(slapPop){case 1:beat.Tap=!0;break;case 2:beat.Slap=!0;break;case 3:beat.Pop=!0}}else if(0!=(32&flags)){var slapPop=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(slapPop){case 1:beat.Tap=!0;break;case 2:beat.Slap=!0;break;case 3:beat.Pop=!0}this.Data.Skip(4)}if(0!=(4&flags2)&&this.ReadTremoloBarEffect(beat),0!=(64&flags)){var strokeUp,strokeDown;this._versionNumber<500?(strokeDown=this.Data.ReadByte(),strokeUp=this.Data.ReadByte()):(strokeUp=this.Data.ReadByte(),strokeDown=this.Data.ReadByte()),strokeUp>0?(beat.BrushType=AlphaTab.Model.BrushType.BrushUp,beat.BrushDuration=AlphaTab.Importer.Gp3To5Importer.ToStrokeValue(strokeUp)):strokeDown>0&&(beat.BrushType=AlphaTab.Model.BrushType.BrushDown,beat.BrushDuration=AlphaTab.Importer.Gp3To5Importer.ToStrokeValue(strokeDown))}if(0!=(2&flags2))switch(AlphaTab.Platform.Std.ReadSignedByte(this.Data)){case 0:beat.PickStroke=AlphaTab.Model.PickStrokeType.None;break;case 1:beat.PickStroke=AlphaTab.Model.PickStrokeType.Up;break;case 2:beat.PickStroke=AlphaTab.Model.PickStrokeType.Down}},ReadTremoloBarEffect:function(beat){this.Data.ReadByte(),this.ReadInt32();var pointCount=this.ReadInt32();if(pointCount>0)for(var i=0;pointCount>i;i++){var point=new AlphaTab.Model.BendPoint(0,0);point.Offset=this.ReadInt32(),point.Value=this.ReadInt32()/25|0,this.ReadBool(),beat.AddWhammyBarPoint(point)}},ReadMixTableChange:function(beat){var tableChange=new AlphaTab.Importer.MixTableChange;tableChange.Instrument=AlphaTab.Platform.Std.ReadSignedByte(this.Data),this._versionNumber>=500&&this.Data.Skip(16),tableChange.Volume=AlphaTab.Platform.Std.ReadSignedByte(this.Data),tableChange.Balance=AlphaTab.Platform.Std.ReadSignedByte(this.Data);var chorus=AlphaTab.Platform.Std.ReadSignedByte(this.Data),reverb=AlphaTab.Platform.Std.ReadSignedByte(this.Data),phaser=AlphaTab.Platform.Std.ReadSignedByte(this.Data),tremolo=AlphaTab.Platform.Std.ReadSignedByte(this.Data);if(this._versionNumber>=500&&(tableChange.TempoName=this.ReadStringIntByte()),tableChange.Tempo=this.ReadInt32(),tableChange.Volume>=0&&this.Data.ReadByte(),tableChange.Balance>=0&&this.Data.ReadByte(),chorus>=0&&this.Data.ReadByte(),reverb>=0&&this.Data.ReadByte(),phaser>=0&&this.Data.ReadByte(),tremolo>=0&&this.Data.ReadByte(),tableChange.Tempo>=0&&(tableChange.Duration=AlphaTab.Platform.Std.ReadSignedByte(this.Data),this._versionNumber>=510&&this.Data.ReadByte()),this._versionNumber>=400&&this.Data.ReadByte(),this._versionNumber>=500&&this.Data.ReadByte(),this._versionNumber>=510&&(this.ReadStringIntByte(),this.ReadStringIntByte()),tableChange.Volume>=0){var volumeAutomation=new AlphaTab.Model.Automation;volumeAutomation.IsLinear=!0,volumeAutomation.Type=AlphaTab.Model.AutomationType.Volume,volumeAutomation.Value=tableChange.Volume,beat.Automations.push(volumeAutomation)}if(tableChange.Balance>=0){var balanceAutomation=new AlphaTab.Model.Automation;balanceAutomation.IsLinear=!0,balanceAutomation.Type=AlphaTab.Model.AutomationType.Balance,balanceAutomation.Value=tableChange.Balance,beat.Automations.push(balanceAutomation)}if(tableChange.Instrument>=0){var instrumentAutomation=new AlphaTab.Model.Automation;instrumentAutomation.IsLinear=!0,instrumentAutomation.Type=AlphaTab.Model.AutomationType.Instrument,instrumentAutomation.Value=tableChange.Instrument,beat.Automations.push(instrumentAutomation)}if(tableChange.Tempo>=0){var tempoAutomation=new AlphaTab.Model.Automation;tempoAutomation.IsLinear=!0,tempoAutomation.Type=AlphaTab.Model.AutomationType.Tempo,tempoAutomation.Value=tableChange.Tempo,beat.Automations.push(tempoAutomation),beat.Voice.Bar.get_MasterBar().TempoAutomation=tempoAutomation}},ReadNote:function(track,bar,voice,beat,stringIndex){var newNote=new AlphaTab.Model.Note;newNote.String=track.Tuning.length-stringIndex;var flags=this.Data.ReadByte();if(0!=(2&flags)?newNote.Accentuated=AlphaTab.Model.AccentuationType.Heavy:0!=(64&flags)&&(newNote.Accentuated=AlphaTab.Model.AccentuationType.Normal),newNote.IsGhost=0!=(4&flags),0!=(32&flags)){var noteType=this.Data.ReadByte();3==noteType?newNote.IsDead=!0:2==noteType&&(newNote.IsTieDestination=!0)}if(0!=(1&flags)&&this._versionNumber<500&&(this.Data.ReadByte(),this.Data.ReadByte()),0!=(16&flags)){var dynamicNumber=AlphaTab.Platform.Std.ReadSignedByte(this.Data);newNote.Dynamic=this.ToDynamicValue(dynamicNumber),beat.Dynamic=newNote.Dynamic}if(0!=(32&flags)&&(newNote.Fret=AlphaTab.Platform.Std.ReadSignedByte(this.Data)),0!=(128&flags)&&(newNote.LeftHandFinger=AlphaTab.Platform.Std.ReadSignedByte(this.Data),newNote.RightHandFinger=AlphaTab.Platform.Std.ReadSignedByte(this.Data),newNote.IsFingering=!0),this._versionNumber>=500){0!=(1&flags)&&(newNote.DurationPercent=this.ReadDouble());var flags2=this.Data.ReadByte();newNote.AccidentalMode=0!=(2&flags2)?AlphaTab.Model.NoteAccidentalMode.SwapAccidentals:AlphaTab.Model.NoteAccidentalMode.Default}beat.AddNote(newNote),0!=(8&flags)&&this.ReadNoteEffects(track,voice,beat,newNote)},ToDynamicValue:function(value){switch(value){case 1:return AlphaTab.Model.DynamicValue.PPP;case 2:return AlphaTab.Model.DynamicValue.PP;case 3:return AlphaTab.Model.DynamicValue.P;case 4:return AlphaTab.Model.DynamicValue.MP;case 5:return AlphaTab.Model.DynamicValue.MF;case 6:return AlphaTab.Model.DynamicValue.F;case 7:return AlphaTab.Model.DynamicValue.FF;case 8:return AlphaTab.Model.DynamicValue.FFF;default:return AlphaTab.Model.DynamicValue.F}},ReadNoteEffects:function(track,voice,beat,note){var flags=this.Data.ReadByte(),flags2=0;this._versionNumber>=400&&(flags2=this.Data.ReadByte()),0!=(1&flags)&&this.ReadBend(note),0!=(16&flags)&&this.ReadGrace(voice,note),0!=(4&flags2)&&this.ReadTremoloPicking(beat),0!=(8&flags2)?this.ReadSlide(note):this._versionNumber<400&&0!=(4&flags)&&(note.SlideType=AlphaTab.Model.SlideType.Shift),0!=(16&flags2)?this.ReadArtificialHarmonic(note):this._versionNumber<400&&(0!=(4&flags)&&(note.HarmonicType=AlphaTab.Model.HarmonicType.Natural,note.HarmonicValue=this.DeltaFretToHarmonicValue(note.Fret)),0!=(8&flags)&&(note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial)),0!=(32&flags2)&&this.ReadTrill(note),note.IsLetRing=0!=(8&flags),note.IsHammerPullOrigin=0!=(2&flags),0!=(64&flags2)&&(note.Vibrato=AlphaTab.Model.VibratoType.Slight),note.IsPalmMute=0!=(2&flags2),note.IsStaccato=0!=(1&flags2)},ReadBend:function(note){this.Data.ReadByte(),this.ReadInt32();var pointCount=this.ReadInt32();if(pointCount>0)for(var i=0;pointCount>i;i++){var point=new AlphaTab.Model.BendPoint(0,0);point.Offset=this.ReadInt32(),point.Value=this.ReadInt32()/25|0,this.ReadBool(),note.AddBendPoint(point)}},ReadGrace:function(voice,note){var graceBeat=new AlphaTab.Model.Beat,graceNote=new AlphaTab.Model.Note;graceNote.String=note.String,graceNote.Fret=AlphaTab.Platform.Std.ReadSignedByte(this.Data),graceBeat.Duration=AlphaTab.Model.Duration.ThirtySecond,graceBeat.Dynamic=this.ToDynamicValue(AlphaTab.Platform.Std.ReadSignedByte(this.Data));var transition=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(transition){case 0:break;case 1:graceNote.SlideType=AlphaTab.Model.SlideType.Legato,graceNote.SlideTarget=note;break;case 2:break;case 3:graceNote.IsHammerPullOrigin=!0}if(graceNote.Dynamic=graceBeat.Dynamic,this.Data.Skip(1),this._versionNumber<500)graceBeat.GraceType=AlphaTab.Model.GraceType.BeforeBeat;else{var flags=this.Data.ReadByte();graceNote.IsDead=0!=(1&flags),graceBeat.GraceType=0!=(2&flags)?AlphaTab.Model.GraceType.OnBeat:AlphaTab.Model.GraceType.BeforeBeat}graceBeat.AddNote(graceNote),voice.AddGraceBeat(graceBeat)},ReadTremoloPicking:function(beat){var speed=this.Data.ReadByte();switch(speed){case 1:beat.TremoloSpeed=AlphaTab.Model.Duration.Eighth;break;case 2:beat.TremoloSpeed=AlphaTab.Model.Duration.Sixteenth;break;case 3:beat.TremoloSpeed=AlphaTab.Model.Duration.ThirtySecond}},ReadSlide:function(note){if(this._versionNumber>=500){var type=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(type){case 1:note.SlideType=AlphaTab.Model.SlideType.Shift;break;case 2:note.SlideType=AlphaTab.Model.SlideType.Legato;break;case 4:note.SlideType=AlphaTab.Model.SlideType.OutDown;break;case 8:note.SlideType=AlphaTab.Model.SlideType.OutUp;break;case 16:note.SlideType=AlphaTab.Model.SlideType.IntoFromBelow;break;case 32:note.SlideType=AlphaTab.Model.SlideType.IntoFromAbove;break;default:note.SlideType=AlphaTab.Model.SlideType.None}}else{var type=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(type){case 1:note.SlideType=AlphaTab.Model.SlideType.Shift;break;case 2:note.SlideType=AlphaTab.Model.SlideType.Legato;break;case 3:note.SlideType=AlphaTab.Model.SlideType.OutDown;break;case 4:note.SlideType=AlphaTab.Model.SlideType.OutUp;break;case-1:note.SlideType=AlphaTab.Model.SlideType.IntoFromBelow;break;case-2:note.SlideType=AlphaTab.Model.SlideType.IntoFromAbove;break;default:note.SlideType=AlphaTab.Model.SlideType.None}}},ReadArtificialHarmonic:function(note){var type=this.Data.ReadByte();if(this._versionNumber>=500)switch(type){case 1:note.HarmonicType=AlphaTab.Model.HarmonicType.Natural,note.HarmonicValue=this.DeltaFretToHarmonicValue(note.Fret);break;case 2:{this.Data.ReadByte(),this.Data.ReadByte(),this.Data.ReadByte()}note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial;break;case 3:note.HarmonicType=AlphaTab.Model.HarmonicType.Tap,note.HarmonicValue=this.DeltaFretToHarmonicValue(this.Data.ReadByte());break;case 4:note.HarmonicType=AlphaTab.Model.HarmonicType.Pinch,note.HarmonicValue=12;break;case 5:note.HarmonicType=AlphaTab.Model.HarmonicType.Semi,note.HarmonicValue=12}else if(this._versionNumber>=400)switch(type){case 1:note.HarmonicType=AlphaTab.Model.HarmonicType.Natural;break;case 3:note.HarmonicType=AlphaTab.Model.HarmonicType.Tap;break;case 4:note.HarmonicType=AlphaTab.Model.HarmonicType.Pinch;break;case 5:note.HarmonicType=AlphaTab.Model.HarmonicType.Semi;break;case 15:note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial;break;case 17:note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial;break;case 22:note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial}},DeltaFretToHarmonicValue:function(deltaFret){switch(deltaFret){case 2:return 2.4;case 3:return 3.2;case 4:case 5:case 7:case 9:case 12:case 16:case 17:case 19:case 24:return deltaFret;case 8:return 8.2;case 10:return 9.6;case 14:case 15:return 14.7;case 21:case 22:return 21.7;default:return 12}},ReadTrill:function(note){switch(note.TrillValue=this.Data.ReadByte()+note.get_StringTuning(),this.Data.ReadByte()){case 1:note.TrillSpeed=AlphaTab.Model.Duration.Sixteenth;break;case 2:note.TrillSpeed=AlphaTab.Model.Duration.ThirtySecond;break;case 3:note.TrillSpeed=AlphaTab.Model.Duration.SixtyFourth}},ReadDouble:function(){var bytes=new Uint8Array(8);this.Data.Read(bytes,0,bytes.length);var sign=1-(bytes[0]>>7<<1),exp=(bytes[0]<<4&2047|bytes[1]>>4)-1023,sig=this.GetDoubleSig(bytes);return 0==sig&&-1023==exp?0:sign*(1+Math.pow(2,-52)*sig)*Math.pow(2,exp)},GetDoubleSig:function(bytes){return 4294967296*((15&bytes[1])<<16|bytes[2]<<8|bytes[3])+2147483648*(bytes[4]>>7)+((127&bytes[4])<<24|bytes[5]<<16|bytes[6]<<8|bytes[7])|0},ReadColor:function(){var r=this.Data.ReadByte(),g=this.Data.ReadByte(),b=this.Data.ReadByte();return this.Data.Skip(1),new AlphaTab.Platform.Model.Color(r,g,b,255)},ReadBool:function(){return 0!=this.Data.ReadByte()},ReadInt32:function(){var bytes=new Uint8Array(4);return this.Data.Read(bytes,0,4),bytes[0]|bytes[1]<<8|bytes[2]<<16|bytes[3]<<24},ReadStringIntUnused:function(){return this.Data.Skip(4),this.ReadString(this.Data.ReadByte())},ReadStringInt:function(){return this.ReadString(this.ReadInt32())},ReadStringIntByte:function(){var length=this.ReadInt32()-1;return this.Data.ReadByte(),this.ReadString(length)},ReadString:function(length){var b=new Uint8Array(length);return this.Data.Read(b,0,b.length),AlphaTab.Platform.Std.ToString(b)},ReadStringByteLength:function(length){var stringLength=this.Data.ReadByte(),s=this.ReadString(stringLength);return length>stringLength&&this.Data.Skip(length-stringLength),s}},$StaticConstructor(function(){AlphaTab.Importer.Gp3To5Importer.VersionString="FICHIER GUITAR PRO ",AlphaTab.Importer.Gp3To5Importer.BendStep=25}),AlphaTab.Importer.Gp3To5Importer.ToStrokeValue=function(value){switch(value){case 1:return 30;case 2:return 30;case 3:return 60;case 4:return 120;case 5:return 240;case 6:return 480;default:return 0}},$Inherit(AlphaTab.Importer.Gp3To5Importer,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.GpxFile=function(){this.FileName=null,this.FileSize=0,this.Data=null},AlphaTab.Importer.GpxFileSystem=function(){this.FileFilter=null,this.Files=null,this.Files=[],this.FileFilter=$CreateAnonymousDelegate(this,function(){return!0})},AlphaTab.Importer.GpxFileSystem.prototype={Load:function(s){var src=new AlphaTab.IO.BitReader(s);this.ReadBlock(src)},ReadHeader:function(src){return this.GetString(src.ReadBytes(4),0,4)},Decompress:function(src,skipHeader){var buffer,uncompressed=AlphaTab.IO.ByteBuffer.Empty(),expectedLength=this.GetInteger(src.ReadBytes(4),0);try{for(;uncompressed.get_Length()<expectedLength;){var flag=src.ReadBits(1);if(1==flag){var wordSize=src.ReadBits(4),offset=src.ReadBitsReversed(wordSize),size=src.ReadBitsReversed(wordSize),sourcePosition=uncompressed.get_Length()-offset,toRead=Math.min(offset,size);buffer=uncompressed.GetBuffer(),uncompressed.Write(buffer,0|sourcePosition,toRead)}else for(var size=src.ReadBitsReversed(2),i=0;size>i;i++)uncompressed.WriteByte(src.ReadByte())}}catch($$e2){}buffer=uncompressed.GetBuffer();var resultOffset=skipHeader?4:0,resultSize=uncompressed.get_Length()-resultOffset,result=new Uint8Array(0|resultSize);return result.set(buffer.subarray(resultOffset,resultOffset+resultSize|0),0),result},ReadBlock:function(data){var header=this.ReadHeader(data);if("BCFZ"==header)this.ReadUncompressedBlock(this.Decompress(data,!0));else{if("BCFS"!=header)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);this.ReadUncompressedBlock(data.ReadAll())}},ReadUncompressedBlock:function(data){for(var sectorSize=4096,offset=sectorSize;offset+3<data.length;){var entryType=this.GetInteger(data,offset);if(2==entryType){var file=new AlphaTab.Importer.GpxFile;file.FileName=this.GetString(data,offset+4,127),file.FileSize=this.GetInteger(data,offset+140);var storeFile=null==this.FileFilter||this.FileFilter(file.FileName);storeFile&&this.Files.push(file);for(var dataPointerOffset=offset+148,sector=0,sectorCount=0,fileData=storeFile?AlphaTab.IO.ByteBuffer.WithCapactiy(file.FileSize):null;0!=(sector=this.GetInteger(data,dataPointerOffset+4*sectorCount++));)offset=sector*sectorSize,storeFile&&fileData.Write(data,offset,sectorSize);if(storeFile){file.Data=new Uint8Array(0|Math.min(file.FileSize,fileData.get_Length()));var raw=fileData.ToArray();file.Data.set(raw.subarray(0,0+file.Data.length),0)}}offset+=sectorSize}},GetString:function(data,offset,length){for(var buf=new String,i=0;length>i;i++){var code=255&data[offset+i];if(0==code)break;buf+=String.fromCharCode(code)}return buf},GetInteger:function(data,offset){return data[offset+3]<<24|data[offset+2]<<16|data[offset+1]<<8|data[offset]}},$StaticConstructor(function(){AlphaTab.Importer.GpxFileSystem.HeaderBcFs="BCFS",AlphaTab.Importer.GpxFileSystem.HeaderBcFz="BCFZ",AlphaTab.Importer.GpxFileSystem.ScoreGpif="score.gpif"}),AlphaTab.Importer.GpxImporter=function(){AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.GpxImporter.prototype={get_Name:function(){return"Guitar Pro 6"},ReadScore:function(){AlphaTab.Util.Logger.Info(this.get_Name(),"Loading GPX filesystem");var fileSystem=new AlphaTab.Importer.GpxFileSystem;fileSystem.FileFilter=$CreateAnonymousDelegate(this,function(s){return"score.gpif"==s}),fileSystem.Load(this.Data),AlphaTab.Util.Logger.Info(this.get_Name(),"GPX filesystem loaded");var data=fileSystem.Files[0].Data,xml=AlphaTab.Platform.Std.ToString(data);fileSystem.Files=null,fileSystem=null,AlphaTab.Util.Logger.Info(this.get_Name(),"Start Parsing score.gpif");var parser=new AlphaTab.Importer.GpxParser;return parser.ParseXml(xml),parser.Score.Finish(),AlphaTab.Util.Logger.Info(this.get_Name(),"score.gpif parsed"),parser.Score}},$Inherit(AlphaTab.Importer.GpxImporter,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.GpxRhythm=function(){this.Dots=0,this.TupletDenominator=0,this.TupletNumerator=0,this.Value=AlphaTab.Model.Duration.QuadrupleWhole,this.TupletDenominator=-1,this.TupletNumerator=-1,this.Value=AlphaTab.Model.Duration.Quarter},AlphaTab.Importer.GpxParser=function(){this._masterTrackAutomations=null,this._tracksMapping=null,this._tracksById=null,this._masterBars=null,this._barsOfMasterBar=null,this._barsById=null,this._voicesOfBar=null,this._voiceById=null,this._beatsOfVoice=null,this._rhythmOfBeat=null,this._beatById=null,this._rhythmById=null,this._noteById=null,this._notesOfBeat=null,this._tappedNotes=null,this.Score=null},AlphaTab.Importer.GpxParser.prototype={ParseXml:function(xml){this._masterTrackAutomations={},this._tracksMapping=new Array(0),this._tracksById={},this._masterBars=[],this._barsOfMasterBar=[],this._voicesOfBar={},this._barsById={},this._voiceById={},this._beatsOfVoice={},this._beatById={},this._rhythmOfBeat={},this._rhythmById={},this._notesOfBeat={},this._noteById={},this._tappedNotes={},this.ParseDom(AlphaTab.Platform.Std.LoadXml(xml))},ParseDom:function(dom){var root=dom.documentElement;if(null!=root){if("GPIF"!=root.localName)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);this.Score=new AlphaTab.Model.Score,AlphaTab.Platform.Std.IterateChildren(root,$CreateAnonymousDelegate(this,function(n){if(n.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.localName){case"Score":this.ParseScoreNode(n);break;case"MasterTrack":this.ParseMasterTrackNode(n);break;case"Tracks":this.ParseTracksNode(n);break;case"MasterBars":this.ParseMasterBarsNode(n);break;case"Bars":this.ParseBars(n);break;case"Voices":this.ParseVoices(n);break;case"Beats":this.ParseBeats(n);break;case"Notes":this.ParseNotes(n);break;case"Rhythms":this.ParseRhythms(n)}})),this.BuildModel()}},ParseScoreNode:function(element){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Title":this.Score.Title=this.GetValue(c.firstChild);break;case"SubTitle":this.Score.SubTitle=this.GetValue(c.firstChild);break;case"Artist":this.Score.Artist=this.GetValue(c.firstChild);break;case"Album":this.Score.Album=this.GetValue(c.firstChild);break;case"Words":this.Score.Words=this.GetValue(c.firstChild);break;case"Music":this.Score.Music=this.GetValue(c.firstChild);break;case"WordsAndMusic":if(null!=c.firstChild&&""!=c.firstChild.toString()){var wordsAndMusic=this.GetValue(c.firstChild);null==wordsAndMusic||0==wordsAndMusic.length||null!=this.Score.Words&&0!=this.Score.Words.length||(this.Score.Words=wordsAndMusic),null==wordsAndMusic||0==wordsAndMusic.length||null!=this.Score.Music&&0!=this.Score.Music.length||(this.Score.Music=wordsAndMusic)}break;case"Copyright":this.Score.Copyright=this.GetValue(c.firstChild);break;case"Tabber":this.Score.Tab=this.GetValue(c.firstChild);break;case"Instructions":this.Score.Instructions=this.GetValue(c.firstChild);break;case"Notices":this.Score.Notices=this.GetValue(c.firstChild)}}))},ParseMasterTrackNode:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Automations":this.ParseAutomations(c,this._masterTrackAutomations);break;case"Tracks":this._tracksMapping=this.GetValue(c).split(" ")}}))},ParseAutomations:function(node,automations){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Automation":this.ParseAutomation(c,automations)}}))},ParseAutomation:function(node,automations){var type=null,isLinear=!1,barId=null,ratioPosition=0,value=0,reference=0,text=null;if(AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Type":type=this.GetValue(c);break;case"Linear":isLinear="true"==this.GetValue(c).toLowerCase();break;case"Bar":barId=this.GetValue(c);break;case"Position":ratioPosition=AlphaTab.Platform.Std.ParseFloat(this.GetValue(c));break;case"Value":var parts=this.GetValue(c).split(" ");value=AlphaTab.Platform.Std.ParseFloat(parts[0]),reference=AlphaTab.Platform.Std.ParseInt(parts[1]);break;case"Text":text=this.GetValue(c)}})),null!=type){var automation=null;switch(type){case"Tempo":automation=AlphaTab.Model.Automation.BuildTempoAutomation(isLinear,ratioPosition,value,reference)}null!=automation&&(automation.Text=text),null!=barId&&(automations.hasOwnProperty(barId)||(automations[barId]=[]),automations[barId].push(automation))}},ParseTracksNode:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Track":this.ParseTrack(c)}}))},ParseTrack:function(node){var track=new AlphaTab.Model.Track(1),trackId=node.getAttribute("id");AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Name":track.Name=this.GetValue(c);break;case"Instrument":var instrumentName=c.getAttribute("ref");(instrumentName.lastIndexOf("-gs")==instrumentName.length-"-gs".length||instrumentName.lastIndexOf("GrandStaff")==instrumentName.length-"GrandStaff".length)&&track.EnsureStaveCount(2);break;case"ShortName":track.ShortName=this.GetValue(c);break;case"Properties":this.ParseTrackProperties(track,c);break;case"GeneralMidi":this.ParseGeneralMidi(track,c);break;case"PlaybackState":var state=this.GetValue(c);track.PlaybackInfo.IsSolo="Solo"==state,track.PlaybackInfo.IsMute="Mute"==state}})),this._tracksById[trackId]=track},ParseDiagramCollection:function(track,node){var items=this.FindChildElement(node,"Items");AlphaTab.Platform.Std.IterateChildren(items,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Item":this.ParseDiagramItem(track,c)}}))},ParseDiagramItem:function(track,node){var chord=new AlphaTab.Model.Chord,chordId=node.getAttribute("id");chord.Name=node.getAttribute("name"),track.Chords[chordId]=chord;var diagram=this.FindChildElement(node,"Diagram"),stringCount=AlphaTab.Platform.Std.ParseInt(diagram.getAttribute("stringCount")),baseFret=AlphaTab.Platform.Std.ParseInt(diagram.getAttribute("baseFret"));chord.FirstFret=baseFret+1;for(var i=0;stringCount>i;i++)chord.Strings.push(-1);AlphaTab.Platform.Std.IterateChildren(diagram,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Fret":var guitarString=AlphaTab.Platform.Std.ParseInt(c.getAttribute("string"));chord.Strings[stringCount-guitarString-1]=baseFret+AlphaTab.Platform.Std.ParseInt(c.getAttribute("fret"));break;case"Fingering":var existingFingers={};AlphaTab.Platform.Std.IterateChildren(c,$CreateAnonymousDelegate(this,function(p){if(p.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(p.localName){case"Position":var finger=AlphaTab.Model.Fingers.Unknown,fret=baseFret+AlphaTab.Platform.Std.ParseInt(p.getAttribute("fret"));switch(p.getAttribute("finger")){case"Index":finger=AlphaTab.Model.Fingers.IndexFinger;break;case"Middle":finger=AlphaTab.Model.Fingers.MiddleFinger;break;case"Rank":finger=AlphaTab.Model.Fingers.AnnularFinger;break;case"Pinky":finger=AlphaTab.Model.Fingers.LittleFinger;break;case"Thumb":finger=AlphaTab.Model.Fingers.Thumb;break;case"None":}finger!=AlphaTab.Model.Fingers.Unknown&&(existingFingers.hasOwnProperty(finger)?chord.BarreFrets.push(fret):existingFingers[finger]=!0)}}))}}))},FindChildElement:function(node,name){for(var i=0;i<node.childNodes.length;i++){var c=node.childNodes[i];if(null!=c&&c.nodeType==AlphaTab.Xml.XmlNodeType.Element&&c.localName==name)return c}return null},ParseTrackProperties:function(track,node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Property":this.ParseTrackProperty(track,c)}}))},ParseTrackProperty:function(track,node){var propertyName=node.getAttribute("name");switch(propertyName){case"Tuning":for(var tuningParts=this.GetValue(this.FindChildElement(node,"Pitches")).split(" "),tuning=new Int32Array(tuningParts.length),i=0;i<tuning.length;i++)tuning[tuning.length-1-i]=AlphaTab.Platform.Std.ParseInt(tuningParts[i]);track.Tuning=tuning;break;case"DiagramCollection":case"ChordCollection":this.ParseDiagramCollection(track,node);break;case"CapoFret":track.Capo=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(node,"Fret")))}},ParseGeneralMidi:function(track,node){track.PlaybackInfo.Port=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(node,"Port"))),track.PlaybackInfo.Program=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(node,"Program"))),track.PlaybackInfo.PrimaryChannel=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(node,"PrimaryChannel"))),track.PlaybackInfo.SecondaryChannel=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(node,"SecondaryChannel"))),track.IsPercussion="Percussion"==node.getAttribute("table")},ParseMasterBarsNode:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"MasterBar":this.ParseMasterBar(c)}}))},ParseMasterBar:function(node){var masterBar=new AlphaTab.Model.MasterBar;AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Time":var timeParts=this.GetValue(c).split("/");masterBar.TimeSignatureNumerator=AlphaTab.Platform.Std.ParseInt(timeParts[0]),masterBar.TimeSignatureDenominator=AlphaTab.Platform.Std.ParseInt(timeParts[1]);break;case"DoubleBar":masterBar.IsDoubleBar=!0;break;case"Section":masterBar.Section=new AlphaTab.Model.Section,masterBar.Section.Marker=this.GetValue(this.FindChildElement(c,"Letter")),masterBar.Section.Text=this.GetValue(this.FindChildElement(c,"Text"));break;case"Repeat":"true"==c.getAttribute("start").toLowerCase()&&(masterBar.IsRepeatStart=!0),"true"==c.getAttribute("end").toLowerCase()&&null!=c.getAttribute("count")&&(masterBar.RepeatCount=AlphaTab.Platform.Std.ParseInt(c.getAttribute("count")));break;case"AlternateEndings":for(var alternateEndings=this.GetValue(c).split(" "),i=0,k=0;k<alternateEndings.length;k++)i|=1<<-1+AlphaTab.Platform.Std.ParseInt(alternateEndings[k]);masterBar.AlternateEndings=i;break;case"Bars":this._barsOfMasterBar.push(this.GetValue(c).split(" "));break;case"TripletFeel":switch(this.GetValue(c)){case"NoTripletFeel":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel;break;case"Triplet8th":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.Triplet8th;break;case"Triplet16th":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.Triplet16th;break;case"Dotted8th":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.Dotted8th;break;case"Dotted16th":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.Dotted16th;break;case"Scottish8th":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.Scottish8th;

break;case"Scottish16th":masterBar.TripletFeel=AlphaTab.Model.TripletFeel.Scottish16th}break;case"Key":masterBar.KeySignature=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"AccidentalCount")));var mode=this.FindChildElement(c,"Mode");if(null!=mode)switch(this.GetValue(mode).toLowerCase()){case"major":masterBar.KeySignatureType=AlphaTab.Model.KeySignatureType.Major;break;case"minor":masterBar.KeySignatureType=AlphaTab.Model.KeySignatureType.Minor}}})),this._masterBars.push(masterBar)},ParseBars:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Bar":this.ParseBar(c)}}))},ParseBar:function(node){var bar=new AlphaTab.Model.Bar,barId=node.getAttribute("id");AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Voices":this._voicesOfBar[barId]=this.GetValue(c).split(" ");break;case"Clef":switch(this.GetValue(c)){case"Neutral":bar.Clef=AlphaTab.Model.Clef.Neutral;break;case"G2":bar.Clef=AlphaTab.Model.Clef.G2;break;case"F4":bar.Clef=AlphaTab.Model.Clef.F4;break;case"C4":bar.Clef=AlphaTab.Model.Clef.C4;break;case"C3":bar.Clef=AlphaTab.Model.Clef.C3}break;case"Ottavia":switch(this.GetValue(c)){case"8va":bar.ClefOttavia=AlphaTab.Model.ClefOttavia._8va;break;case"15ma":bar.ClefOttavia=AlphaTab.Model.ClefOttavia._15ma;break;case"8vb":bar.ClefOttavia=AlphaTab.Model.ClefOttavia._8vb;break;case"15mb":bar.ClefOttavia=AlphaTab.Model.ClefOttavia._15mb}}})),this._barsById[barId]=bar},ParseVoices:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Voice":this.ParseVoice(c)}}))},ParseVoice:function(node){var voice=new AlphaTab.Model.Voice,voiceId=node.getAttribute("id");AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Beats":this._beatsOfVoice[voiceId]=this.GetValue(c).split(" ")}})),this._voiceById[voiceId]=voice},ParseBeats:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Beat":this.ParseBeat(c)}}))},ParseBeat:function(node){var beat=new AlphaTab.Model.Beat,beatId=node.getAttribute("id");AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Notes":this._notesOfBeat[beatId]=this.GetValue(c).split(" ");break;case"Rhythm":this._rhythmOfBeat[beatId]=c.getAttribute("ref");break;case"Fadding":"FadeIn"==this.GetValue(c)&&(beat.FadeIn=!0);break;case"Tremolo":switch(this.GetValue(c)){case"1/2":beat.TremoloSpeed=AlphaTab.Model.Duration.Eighth;break;case"1/4":beat.TremoloSpeed=AlphaTab.Model.Duration.Sixteenth;break;case"1/8":beat.TremoloSpeed=AlphaTab.Model.Duration.ThirtySecond}break;case"Chord":beat.ChordId=this.GetValue(c);break;case"Hairpin":switch(this.GetValue(c)){case"Crescendo":beat.Crescendo=AlphaTab.Model.CrescendoType.Crescendo;break;case"Decrescendo":beat.Crescendo=AlphaTab.Model.CrescendoType.Decrescendo}break;case"Arpeggio":beat.BrushType="Up"==this.GetValue(c)?AlphaTab.Model.BrushType.ArpeggioUp:AlphaTab.Model.BrushType.ArpeggioDown;break;case"Properties":this.ParseBeatProperties(c,beat);break;case"XProperties":this.ParseBeatXProperties(c,beat);break;case"FreeText":beat.Text=this.GetValue(c);break;case"Dynamic":switch(this.GetValue(c)){case"PPP":beat.Dynamic=AlphaTab.Model.DynamicValue.PPP;break;case"PP":beat.Dynamic=AlphaTab.Model.DynamicValue.PP;break;case"P":beat.Dynamic=AlphaTab.Model.DynamicValue.P;break;case"MP":beat.Dynamic=AlphaTab.Model.DynamicValue.MP;break;case"MF":beat.Dynamic=AlphaTab.Model.DynamicValue.MF;break;case"F":beat.Dynamic=AlphaTab.Model.DynamicValue.F;break;case"FF":beat.Dynamic=AlphaTab.Model.DynamicValue.FF;break;case"FFF":beat.Dynamic=AlphaTab.Model.DynamicValue.FFF}break;case"GraceNotes":switch(this.GetValue(c)){case"OnBeat":beat.GraceType=AlphaTab.Model.GraceType.OnBeat;break;case"BeforeBeat":beat.GraceType=AlphaTab.Model.GraceType.BeforeBeat}break;case"Legato":"true"==c.getAttribute("origin")&&(beat.IsLegatoOrigin=!0)}})),this._beatById[beatId]=beat},ParseBeatXProperties:function(node,beat){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"XProperty":var id=c.getAttribute("id");switch(id){case"1124204545":var val=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Int")));beat.InvertBeamDirection=1==val}}}))},ParseBeatProperties:function(node,beat){var isWhammy=!1,whammyOrigin=null,whammyMiddleValue=null,whammyMiddleOffset1=null,whammyMiddleOffset2=null,whammyDestination=null;if(AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Property":var name=c.getAttribute("name");switch(name){case"Brush":beat.BrushType="Up"==this.GetValue(this.FindChildElement(c,"Direction"))?AlphaTab.Model.BrushType.BrushUp:AlphaTab.Model.BrushType.BrushDown;break;case"PickStroke":beat.PickStroke="Up"==this.GetValue(this.FindChildElement(c,"Direction"))?AlphaTab.Model.PickStrokeType.Up:AlphaTab.Model.PickStrokeType.Down;break;case"Slapped":null!=this.FindChildElement(c,"Enable")&&(beat.Slap=!0);break;case"Popped":null!=this.FindChildElement(c,"Enable")&&(beat.Pop=!0);break;case"VibratoWTremBar":switch(this.GetValue(this.FindChildElement(c,"Strength"))){case"Wide":beat.Vibrato=AlphaTab.Model.VibratoType.Wide;break;case"Slight":beat.Vibrato=AlphaTab.Model.VibratoType.Slight}break;case"WhammyBar":isWhammy=!0;break;case"WhammyBarExtend":break;case"WhammyBarOriginValue":null==whammyOrigin&&(whammyOrigin=new AlphaTab.Model.BendPoint(0,0)),whammyOrigin.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"WhammyBarOriginOffset":null==whammyOrigin&&(whammyOrigin=new AlphaTab.Model.BendPoint(0,0)),whammyOrigin.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"WhammyBarMiddleValue":whammyMiddleValue=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"WhammyBarMiddleOffset1":whammyMiddleOffset1=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"WhammyBarMiddleOffset2":whammyMiddleOffset2=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"WhammyBarDestinationValue":null==whammyDestination&&(whammyDestination=new AlphaTab.Model.BendPoint(60,0)),whammyDestination.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"WhammyBarDestinationOffset":null==whammyDestination&&(whammyDestination=new AlphaTab.Model.BendPoint(0,0)),whammyDestination.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))))}}})),isWhammy){null==whammyOrigin&&(whammyOrigin=new AlphaTab.Model.BendPoint(0,0)),null==whammyDestination&&(whammyDestination=new AlphaTab.Model.BendPoint(60,0));var whammy=[];whammy.push(whammyOrigin),null!=whammyMiddleOffset1&&null!=whammyMiddleValue&&whammy.push(new AlphaTab.Model.BendPoint(whammyMiddleOffset1,whammyMiddleValue)),null!=whammyMiddleOffset2&&null!=whammyMiddleValue&&whammy.push(new AlphaTab.Model.BendPoint(whammyMiddleOffset2,whammyMiddleValue)),null==whammyMiddleOffset1&&null==whammyMiddleOffset2&&null!=whammyMiddleValue&&whammy.push(new AlphaTab.Model.BendPoint(30,whammyMiddleValue)),whammy.push(whammyDestination),beat.WhammyBarPoints=whammy}},ParseNotes:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Note":this.ParseNote(c)}}))},ParseNote:function(node){var note=new AlphaTab.Model.Note,noteId=node.getAttribute("id");AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Properties":this.ParseNoteProperties(c,note,noteId);break;case"AntiAccent":"normal"==this.GetValue(c).toLowerCase()&&(note.IsGhost=!0);break;case"LetRing":note.IsLetRing=!0;break;case"Trill":note.TrillValue=AlphaTab.Platform.Std.ParseInt(this.GetValue(c)),note.TrillSpeed=AlphaTab.Model.Duration.Sixteenth;break;case"Accent":var accentFlags=AlphaTab.Platform.Std.ParseInt(this.GetValue(c));0!=(1&accentFlags)&&(note.IsStaccato=!0),0!=(4&accentFlags)&&(note.Accentuated=AlphaTab.Model.AccentuationType.Heavy),0!=(8&accentFlags)&&(note.Accentuated=AlphaTab.Model.AccentuationType.Normal);break;case"Tie":"true"==c.getAttribute("origin").toLowerCase()&&(note.IsTieOrigin=!0),"true"==c.getAttribute("destination").toLowerCase()&&(note.IsTieDestination=!0);break;case"Vibrato":switch(this.GetValue(c)){case"Slight":note.Vibrato=AlphaTab.Model.VibratoType.Slight;break;case"Wide":note.Vibrato=AlphaTab.Model.VibratoType.Wide}break;case"LeftFingering":switch(note.IsFingering=!0,this.GetValue(c)){case"P":note.LeftHandFinger=AlphaTab.Model.Fingers.Thumb;break;case"I":note.LeftHandFinger=AlphaTab.Model.Fingers.IndexFinger;break;case"M":note.LeftHandFinger=AlphaTab.Model.Fingers.MiddleFinger;break;case"A":note.LeftHandFinger=AlphaTab.Model.Fingers.AnnularFinger;break;case"C":note.LeftHandFinger=AlphaTab.Model.Fingers.LittleFinger}break;case"RightFingering":switch(note.IsFingering=!0,this.GetValue(c)){case"P":note.RightHandFinger=AlphaTab.Model.Fingers.Thumb;break;case"I":note.RightHandFinger=AlphaTab.Model.Fingers.IndexFinger;break;case"M":note.RightHandFinger=AlphaTab.Model.Fingers.MiddleFinger;break;case"A":note.RightHandFinger=AlphaTab.Model.Fingers.AnnularFinger;break;case"C":note.RightHandFinger=AlphaTab.Model.Fingers.LittleFinger}}})),this._noteById[noteId]=note},ParseNoteProperties:function(node,note,noteId){var isBended=!1,bendOrigin=null,bendMiddleValue=null,bendMiddleOffset1=null,bendMiddleOffset2=null,bendDestination=null;AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Property":var name=c.getAttribute("name");switch(name){case"String":note.String=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"String")))+1;break;case"Fret":note.Fret=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Fret")));break;case"Element":note.Element=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Element")));break;case"Variation":note.Variation=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Variation")));break;case"Tapped":this._tappedNotes[noteId]=!0;break;case"HarmonicType":var htype=this.FindChildElement(c,"HType");if(null!=htype)switch(this.GetValue(htype)){case"NoHarmonic":note.HarmonicType=AlphaTab.Model.HarmonicType.None;break;case"Natural":note.HarmonicType=AlphaTab.Model.HarmonicType.Natural;break;case"Artificial":note.HarmonicType=AlphaTab.Model.HarmonicType.Artificial;break;case"Pinch":note.HarmonicType=AlphaTab.Model.HarmonicType.Pinch;break;case"Tap":note.HarmonicType=AlphaTab.Model.HarmonicType.Tap;break;case"Semi":note.HarmonicType=AlphaTab.Model.HarmonicType.Semi;break;case"Feedback":note.HarmonicType=AlphaTab.Model.HarmonicType.Feedback}break;case"HarmonicFret":var hfret=this.FindChildElement(c,"HFret");null!=hfret&&(note.HarmonicValue=AlphaTab.Platform.Std.ParseFloat(this.GetValue(hfret)));break;case"Muted":null!=this.FindChildElement(c,"Enable")&&(note.IsDead=!0);break;case"PalmMuted":null!=this.FindChildElement(c,"Enable")&&(note.IsPalmMute=!0);break;case"Octave":note.Octave=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Number")))-1;break;case"Tone":note.Tone=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Step")));break;case"Bended":isBended=!0;break;case"BendOriginValue":null==bendOrigin&&(bendOrigin=new AlphaTab.Model.BendPoint(0,0)),bendOrigin.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"BendOriginOffset":null==bendOrigin&&(bendOrigin=new AlphaTab.Model.BendPoint(0,0)),bendOrigin.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"BendMiddleValue":bendMiddleValue=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"BendMiddleOffset1":bendMiddleOffset1=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"BendMiddleOffset2":bendMiddleOffset2=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"BendDestinationValue":null==bendDestination&&(bendDestination=new AlphaTab.Model.BendPoint(60,0)),bendDestination.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"BendDestinationOffset":null==bendDestination&&(bendDestination=new AlphaTab.Model.BendPoint(0,0)),bendDestination.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(this.GetValue(this.FindChildElement(c,"Float"))));break;case"HopoOrigin":null!=this.FindChildElement(c,"Enable")&&(note.IsHammerPullOrigin=!0);break;case"HopoDestination":break;case"Slide":var slideFlags=AlphaTab.Platform.Std.ParseInt(this.GetValue(this.FindChildElement(c,"Flags")));0!=(1&slideFlags)&&(note.SlideType=AlphaTab.Model.SlideType.Shift),0!=(2&slideFlags)&&(note.SlideType=AlphaTab.Model.SlideType.Legato),0!=(4&slideFlags)&&(note.SlideType=AlphaTab.Model.SlideType.OutDown),0!=(8&slideFlags)&&(note.SlideType=AlphaTab.Model.SlideType.OutUp),0!=(16&slideFlags)&&(note.SlideType=AlphaTab.Model.SlideType.IntoFromBelow),0!=(32&slideFlags)&&(note.SlideType=AlphaTab.Model.SlideType.IntoFromAbove)}}})),isBended&&(null==bendOrigin&&(bendOrigin=new AlphaTab.Model.BendPoint(0,0)),null==bendDestination&&(bendDestination=new AlphaTab.Model.BendPoint(60,0)),note.AddBendPoint(bendOrigin),null!=bendMiddleOffset1&&null!=bendMiddleValue&&note.AddBendPoint(new AlphaTab.Model.BendPoint(bendMiddleOffset1,bendMiddleValue)),null!=bendMiddleOffset2&&null!=bendMiddleValue&&note.AddBendPoint(new AlphaTab.Model.BendPoint(bendMiddleOffset2,bendMiddleValue)),null==bendMiddleOffset1&&null==bendMiddleOffset2&&null!=bendMiddleValue&&note.AddBendPoint(new AlphaTab.Model.BendPoint(30,bendMiddleValue)),note.AddBendPoint(bendDestination))},ToBendValue:function(gpxValue){var converted=.04*gpxValue;return 0|converted},ToBendOffset:function(gpxOffset){var converted=.6*gpxOffset;return 0|converted},ParseRhythms:function(node){AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"Rhythm":this.ParseRhythm(c)}}))},ParseRhythm:function(node){var rhythm=new AlphaTab.Importer.GpxRhythm,rhythmId=node.getAttribute("id");AlphaTab.Platform.Std.IterateChildren(node,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"NoteValue":switch(this.GetValue(c)){case"Long":rhythm.Value=AlphaTab.Model.Duration.QuadrupleWhole;break;case"DoubleWhole":rhythm.Value=AlphaTab.Model.Duration.DoubleWhole;break;case"Whole":rhythm.Value=AlphaTab.Model.Duration.Whole;break;case"Half":rhythm.Value=AlphaTab.Model.Duration.Half;break;case"Quarter":rhythm.Value=AlphaTab.Model.Duration.Quarter;break;case"Eighth":rhythm.Value=AlphaTab.Model.Duration.Eighth;break;case"16th":rhythm.Value=AlphaTab.Model.Duration.Sixteenth;break;case"32nd":rhythm.Value=AlphaTab.Model.Duration.ThirtySecond;break;case"64th":rhythm.Value=AlphaTab.Model.Duration.SixtyFourth;break;case"128th":rhythm.Value=AlphaTab.Model.Duration.OneHundredTwentyEighth;break;case"256th":rhythm.Value=AlphaTab.Model.Duration.TwoHundredFiftySixth}break;case"PrimaryTuplet":rhythm.TupletNumerator=AlphaTab.Platform.Std.ParseInt(c.getAttribute("num")),rhythm.TupletDenominator=AlphaTab.Platform.Std.ParseInt(c.getAttribute("den"));break;case"AugmentationDot":rhythm.Dots=AlphaTab.Platform.Std.ParseInt(c.getAttribute("count"))}})),this._rhythmById[rhythmId]=rhythm},GetValue:function(n){return AlphaTab.Platform.Std.GetNodeValue(n)},BuildModel:function(){for(var i=0,j=this._masterBars.length;j>i;i++){var masterBar=this._masterBars[i];this.Score.AddMasterBar(masterBar)}for(var $i18=0,$t18=this._tracksMapping,$l18=$t18.length,trackId=$t18[$i18];$l18>$i18;$i18++,trackId=$t18[$i18])if(null!=trackId&&0!=trackId.length){var track=this._tracksById[trackId];this.Score.AddTrack(track)}for(var masterBarIndex=0;masterBarIndex<this._barsOfMasterBar.length;masterBarIndex++)for(var barIds=this._barsOfMasterBar[masterBarIndex],staveIndex=0,barIndex=0,trackIndex=0;barIndex<barIds.length&&trackIndex<this.Score.Tracks.length;barIndex++){var barId=barIds[barIndex];if("-1"!=barId){var bar=this._barsById[barId],track=this.Score.Tracks[trackIndex];track.AddBarToStaff(staveIndex,bar),staveIndex==track.Staves.length-1?(trackIndex++,staveIndex=0):staveIndex++}else trackIndex++}for(var $i19=0,$t19=Object.keys(this._barsById),$l19=$t19.length,barId=$t19[$i19];$l19>$i19;$i19++,barId=$t19[$i19]){var bar=this._barsById[barId];if(this._voicesOfBar.hasOwnProperty(barId))for(var $i20=0,$t20=this._voicesOfBar[barId],$l20=$t20.length,voiceId=$t20[$i20];$l20>$i20;$i20++,voiceId=$t20[$i20])if("-1"!=voiceId)bar.AddVoice(this._voiceById[voiceId]);else{var voice=new AlphaTab.Model.Voice;bar.AddVoice(voice);var beat=new AlphaTab.Model.Beat;beat.IsEmpty=!0,beat.Duration=AlphaTab.Model.Duration.Quarter,voice.AddBeat(beat)}}for(var $i21=0,$t21=Object.keys(this._beatById),$l21=$t21.length,beatId=$t21[$i21];$l21>$i21;$i21++,beatId=$t21[$i21]){var beat=this._beatById[beatId],rhythmId=this._rhythmOfBeat[beatId],rhythm=this._rhythmById[rhythmId];if(beat.Duration=rhythm.Value,beat.Dots=rhythm.Dots,beat.TupletNumerator=rhythm.TupletNumerator,beat.TupletDenominator=rhythm.TupletDenominator,this._notesOfBeat.hasOwnProperty(beatId))for(var $i22=0,$t22=this._notesOfBeat[beatId],$l22=$t22.length,noteId=$t22[$i22];$l22>$i22;$i22++,noteId=$t22[$i22])"-1"!=noteId&&(beat.AddNote(this._noteById[noteId]),this._tappedNotes.hasOwnProperty(noteId)&&(beat.Tap=!0))}for(var $i23=0,$t23=Object.keys(this._voiceById),$l23=$t23.length,voiceId=$t23[$i23];$l23>$i23;$i23++,voiceId=$t23[$i23]){var voice=this._voiceById[voiceId];if(this._beatsOfVoice.hasOwnProperty(voiceId))for(var $i24=0,$t24=this._beatsOfVoice[voiceId],$l24=$t24.length,beatId=$t24[$i24];$l24>$i24;$i24++,beatId=$t24[$i24])"-1"!=beatId&&voice.AddBeat(this._beatById[beatId].Clone())}for(var $i25=0,$t25=Object.keys(this._masterTrackAutomations),$l25=$t25.length,barIndex=$t25[$i25];$l25>$i25;$i25++,barIndex=$t25[$i25])for(var automations=this._masterTrackAutomations[barIndex],masterBar=this.Score.MasterBars[AlphaTab.Platform.Std.ParseInt(barIndex)],i=0,j=automations.length;j>i;i++){var automation=automations[i];automation.Type==AlphaTab.Model.AutomationType.Tempo&&("0"==barIndex&&(this.Score.Tempo=0|automation.Value,null!=automation.Text&&(this.Score.TempoLabel=automation.Text)),masterBar.TempoAutomation=automation)}}},$StaticConstructor(function(){AlphaTab.Importer.GpxParser.InvalidId="-1",AlphaTab.Importer.GpxParser.BendPointPositionFactor=.6,AlphaTab.Importer.GpxParser.BendPointValueFactor=.04}),AlphaTab.Importer.MixTableChange=function(){this.Volume=0,this.Balance=0,this.Instrument=0,this.TempoName=null,this.Tempo=0,this.Duration=0,this.Volume=-1,this.Balance=-1,this.Instrument=-1,this.TempoName=null,this.Tempo=-1,this.Duration=0},AlphaTab.Importer.MusicXmlImporter=function(){this._score=null,this._trackById=null,this._trackFirstMeasureNumber=0,this._maxVoices=0,this._currentChord=null,this._divisionsPerQuarterNote=0,this._voiceOfStaff={},this._isBeamContinue=!1,this._previousBeatWasPulled=!1,this._previousBeat=null,AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.MusicXmlImporter.prototype={get_Name:function(){return"MusicXML"},ReadScore:function(){this._trackById={};var dom,xml=AlphaTab.Platform.Std.ToString(this.Data.ReadAll());try{dom=AlphaTab.Platform.Std.LoadXml(xml)}catch($$e3){throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error)}return this._score=new AlphaTab.Model.Score,this._score.Tempo=120,this.ParseDom(dom),this._score.Finish(),this._score},ParseDom:function(dom){var root=dom.documentElement;if(null!=root)switch(root.localName){case"score-partwise":this.ParsePartwise(root);break;case"score-timewise":break;default:throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error)}},ParsePartwise:function(element){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"movement-title":this._score.Title=AlphaTab.Platform.Std.GetNodeValue(c.firstChild);break;case"identification":this.ParseIdentification(c);break;case"part-list":this.ParsePartList(c);break;case"part":this.ParsePart(c)}}))},ParsePart:function(element){var id=element.getAttribute("id");if(this._trackById.hasOwnProperty(id)){var track=this._trackById[id],isFirstMeasure=!0;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"measure":this.ParseMeasure(c,track,isFirstMeasure)&&(isFirstMeasure=!1)}}))}},ParseMeasure:function(element,track,isFirstMeasure){if("yes"==element.getAttribute("implicit")&&0==element.getElementsByTagName("note").length)return!1;var barIndex=0;if(isFirstMeasure)this._divisionsPerQuarterNote=0,this._trackFirstMeasureNumber=AlphaTab.Platform.Std.ParseInt(element.getAttribute("number")),-2147483648==this._trackFirstMeasureNumber&&(this._trackFirstMeasureNumber=0),barIndex=0;else{if(barIndex=AlphaTab.Platform.Std.ParseInt(element.getAttribute("number")),-2147483648==barIndex)return!1;barIndex-=this._trackFirstMeasureNumber}if(isFirstMeasure){var attributes=element.getElementsByTagName("attributes");if(attributes.length>0){var stavesElements=attributes[0].getElementsByTagName("staves");if(stavesElements.length>0){var staves=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(stavesElements[0]));track.EnsureStaveCount(staves)}}}for(var bars=new Array(track.Staves.length),masterBar=null,b=track.Staves[0].Bars.length;barIndex>=b;b++)for(var s=0;s<track.Staves.length;s++){var bar=bars[s]=new AlphaTab.Model.Bar;if(track.Staves[s].Bars.length>0){var previousBar=track.Staves[s].Bars[track.Staves[s].Bars.length-1];bar.Clef=previousBar.Clef}masterBar=this.GetOrCreateMasterBar(barIndex),track.AddBarToStaff(s,bar);for(var v=0;v<this._maxVoices;v++){var emptyVoice=new AlphaTab.Model.Voice;bar.AddVoice(emptyVoice);var emptyBeat=function(){var $v2=new AlphaTab.Model.Beat;return $v2.IsEmpty=!0,$v2}.call(this);emptyVoice.AddBeat(emptyBeat)}}var attributesParsed=!1;return AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"note":this.ParseNoteBeat(c,bars);break;case"forward":this.ParseForward(c,bars);break;case"direction":this.ParseDirection(c,masterBar);break;case"attributes":attributesParsed||(this.ParseAttributes(c,bars,masterBar),attributesParsed=!0);break;case"harmony":this.ParseHarmony(c,track);break;case"sound":break;case"barline":this.ParseBarline(c,masterBar)}})),!0},GetOrCreateBeat:function(element,bars,chord){var voiceIndex=0,voiceNodes=element.getElementsByTagName("voice");voiceNodes.length>0&&(voiceIndex=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(voiceNodes[0]))-1);var previousBeatWasPulled=this._previousBeatWasPulled;this._previousBeatWasPulled=!1;var staffElement=element.getElementsByTagName("staff"),staff=1;if(staffElement.length>0){staff=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(staffElement[0])),(this._isBeamContinue||previousBeatWasPulled)&&this._previousBeat.Voice.Bar.Staff.Index!=staff-1&&(staff=this._previousBeat.Voice.Bar.Staff.Index+1,this._previousBeatWasPulled=!0);var staffId=bars[0].Staff.Track.Index+"-"+staff;this._voiceOfStaff.hasOwnProperty(staffId)||(this._voiceOfStaff[staffId]=voiceIndex),voiceIndex-=this._voiceOfStaff[staffId]}var beat,bar=bars[staff-1],voice=this.GetOrCreateVoice(bar,voiceIndex);return chord||1==voice.Beats.length&&voice.IsEmpty?beat=voice.Beats[voice.Beats.length-1]:(beat=new AlphaTab.Model.Beat,voice.AddBeat(beat)),this._isBeamContinue=!1,this._previousBeat=beat,beat},ParseForward:function(element,bars){for(var beat=this.GetOrCreateBeat(element,bars,!1),durationInDivisions=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(element.getElementsByTagName("duration")[0])),duration=4*durationInDivisions/this._divisionsPerQuarterNote,durations=new Int32Array([64,32,16,8,4,2,1]),$i26=0,$l26=durations.length,d=durations[$i26];$l26>$i26;$i26++,d=durations[$i26])if(duration>=d){beat.Duration=d,duration-=d;break}beat.IsEmpty=!1},ParseStaffDetails:function(element,track){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"staff-lines":track.Tuning=new Int32Array(AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c)));break;case"staff-tuning":this.ParseStaffTuning(c,track)}})),this.IsEmptyTuning(track.Tuning)&&(track.Tuning=new Int32Array(0))},ParseStaffTuning:function(element,track){var line=AlphaTab.Platform.Std.ParseInt(element.getAttribute("line")),tuningStep="C",tuningOctave="",tuningAlter=0;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"tuning-step":tuningStep=AlphaTab.Platform.Std.GetNodeValue(c);break;case"tuning-alter":tuningAlter=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"tuning-octave":tuningOctave=AlphaTab.Platform.Std.GetNodeValue(c)}})),track.Tuning[track.Tuning.length-line]=AlphaTab.Model.TuningParser.GetTuningForText(tuningStep+tuningOctave)+tuningAlter},ParseHarmony:function(element,track){var root=element.getElementsByTagName("root")[0],rootStep=AlphaTab.Platform.Std.GetNodeValue(root.getElementsByTagName("root-step")[0]),chord=(AlphaTab.Platform.Std.GetNodeValue(element.getElementsByTagName("kind")[0]),new AlphaTab.Model.Chord);chord.Name=rootStep,this._currentChord=AlphaTab.Platform.Std.NewGuid(),track.Chords[this._currentChord]=chord},ParseBarline:function(element,masterBar){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"repeat":this.ParseRepeat(c,masterBar);break;case"ending":this.ParseEnding(c,masterBar)}}))},ParseEnding:function(element,masterBar){var number=AlphaTab.Platform.Std.ParseInt(element.getAttribute("number"));number>0&&(--number,masterBar.AlternateEndings|=1<<number)},ParseRepeat:function(element,masterBar){var direction=element.getAttribute("direction"),times=AlphaTab.Platform.Std.ParseInt(element.getAttribute("times"));0>times&&(times=2),"backward"==direction?masterBar.RepeatCount=times:"forward"==direction&&(masterBar.IsRepeatStart=!0)},ParseNoteBeat:function(element,bars){var chord=element.getElementsByTagName("chord").length>0,beat=this.GetOrCreateBeat(element,bars,chord);beat.ChordId=this._currentChord,this._currentChord=null;var note=new AlphaTab.Model.Note;if(beat.AddNote(note),beat.IsEmpty=!1,beat.Dots=0,AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"grace":beat.GraceType=AlphaTab.Model.GraceType.BeforeBeat,beat.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case"duration":if(beat.get_IsRest()){var duration=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));switch(duration){case 1:beat.Duration=AlphaTab.Model.Duration.Whole;break;case 2:beat.Duration=AlphaTab.Model.Duration.Half;break;case 4:beat.Duration=AlphaTab.Model.Duration.Quarter;break;case 8:beat.Duration=AlphaTab.Model.Duration.Eighth;break;case 16:beat.Duration=AlphaTab.Model.Duration.Sixteenth;break;case 32:beat.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case 64:beat.Duration=AlphaTab.Model.Duration.SixtyFourth;break;default:beat.Duration=AlphaTab.Model.Duration.Quarter}}break;case"tie":AlphaTab.Importer.MusicXmlImporter.ParseTied(c,note);break;case"cue":break;case"instrument":break;case"type":switch(AlphaTab.Platform.Std.GetNodeValue(c)){case"256th":case"128th":case"64th":beat.Duration=AlphaTab.Model.Duration.SixtyFourth;break;case"32nd":beat.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case"16th":beat.Duration=AlphaTab.Model.Duration.Sixteenth;break;case"eighth":beat.Duration=AlphaTab.Model.Duration.Eighth;break;case"quarter":beat.Duration=AlphaTab.Model.Duration.Quarter;break;case"half":beat.Duration=AlphaTab.Model.Duration.Half;break;case"long":case"breve":case"whole":beat.Duration=AlphaTab.Model.Duration.Whole}beat.GraceType!=AlphaTab.Model.GraceType.None&&beat.Duration<AlphaTab.Model.Duration.Sixteenth&&(beat.Duration=AlphaTab.Model.Duration.Eighth);break;case"dot":beat.Dots++;break;case"accidental":this.ParseAccidental(c,note);break;case"time-modification":this.ParseTimeModification(c,beat);break;case"stem":break;case"notehead":"yes"==c.getAttribute("parentheses")&&(note.IsGhost=!0);break;case"beam":var beamMode=AlphaTab.Platform.Std.GetNodeValue(c);"continue"==beamMode&&(this._isBeamContinue=!0);break;case"notations":this.ParseNotations(c,beat,note);break;case"lyric":this.ParseLyric(c,beat);break;case"pitch":this.ParsePitch(c,note);break;case"unpitched":this.ParseUnpitched(c,note);break;case"rest":beat.IsEmpty=!1,beat.Notes=[]}})),note.get_IsStringed())for(var i=0;i<beat.Notes.length;i++)if(beat.Notes[i].String==note.String&&beat.Notes[i]!=note){beat.RemoveNote(note);break}},ParseLyric:function(element,beat){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"text":null!=beat.Text&&0!=beat.Text.length?beat.Text+=" "+AlphaTab.Platform.Std.GetNodeValue(c):beat.Text=AlphaTab.Platform.Std.GetNodeValue(c)}}))},ParseAccidental:function(element,note){switch(AlphaTab.Platform.Std.GetNodeValue(element)){case"sharp":note.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.ForceSharp;break;case"natural":note.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.ForceNatural;break;case"flat":note.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.ForceFlat;break;case"double-sharp":break;case"sharp-sharp":break;case"flat-flat":break;case"natural-sharp":break;case"natural-flat":break;case"quarter-flat":break;case"quarter-sharp":break;case"three-quarters-flat":break;case"three-quarters-sharp":}},ParseNotations:function(element,beat,note){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"articulations":this.ParseArticulations(c,note);break;case"tied":AlphaTab.Importer.MusicXmlImporter.ParseTied(c,note);break;case"slide":case"glissando":"start"==c.getAttribute("type")&&(note.SlideType=AlphaTab.Model.SlideType.Shift);break;case"dynamics":this.ParseDynamics(c,beat);break;case"technical":this.ParseTechnical(c,note);break;

case"ornaments":this.ParseOrnaments(c,note);break;case"slur":"start"==c.getAttribute("type")&&(beat.IsLegatoOrigin=!0)}}))},ParseOrnaments:function(element,note){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"tremolo":var tremoloSpeed=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));switch(tremoloSpeed){case 1:note.Beat.TremoloSpeed=AlphaTab.Model.Duration.Eighth;break;case 2:note.Beat.TremoloSpeed=AlphaTab.Model.Duration.Sixteenth;break;case 3:note.Beat.TremoloSpeed=AlphaTab.Model.Duration.ThirtySecond}}}))},ParseTechnical:function(element,note){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"string":note.String=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c)),-2147483648!=note.String&&(note.String=note.Beat.Voice.Bar.Staff.Track.Tuning.length-note.String+1);break;case"fret":note.Fret=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c))}})),(-2147483648==note.String||-2147483648==note.Fret)&&(note.String=-1,note.Fret=-1)},ParseArticulations:function(element,note){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){switch(c.localName){case"accent":note.Accentuated=AlphaTab.Model.AccentuationType.Normal;break;case"strong-accent":note.Accentuated=AlphaTab.Model.AccentuationType.Heavy;break;case"staccato":case"detached-legato":note.IsStaccato=!0}}))},ParseDynamics:function(element,beat){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"p":beat.Dynamic=AlphaTab.Model.DynamicValue.P;break;case"pp":beat.Dynamic=AlphaTab.Model.DynamicValue.PP;break;case"ppp":beat.Dynamic=AlphaTab.Model.DynamicValue.PPP;break;case"f":beat.Dynamic=AlphaTab.Model.DynamicValue.F;break;case"ff":beat.Dynamic=AlphaTab.Model.DynamicValue.FF;break;case"fff":beat.Dynamic=AlphaTab.Model.DynamicValue.FFF;break;case"mp":beat.Dynamic=AlphaTab.Model.DynamicValue.MP;break;case"mf":beat.Dynamic=AlphaTab.Model.DynamicValue.MF}}))},ParseTimeModification:function(element,beat){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"actual-notes":beat.TupletNumerator=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"normal-notes":beat.TupletDenominator=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c))}}))},ParseUnpitched:function(element,note){var step=null,semitones=0,octave=0;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"display-step":step=AlphaTab.Platform.Std.GetNodeValue(c);break;case"display-alter":semitones=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"display-octave":octave=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c))}}));var value=12*octave+AlphaTab.Model.TuningParser.GetToneForText(step)+semitones;note.Octave=value/12|0,note.Tone=value-12*note.Octave},ParsePitch:function(element,note){var step=null,semitones=0,octave=0;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"step":step=AlphaTab.Platform.Std.GetNodeValue(c);break;case"alter":semitones=AlphaTab.Platform.Std.ParseFloat(AlphaTab.Platform.Std.GetNodeValue(c)),System.Single.IsNaN(semitones)&&(semitones=0);break;case"octave":octave=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c))}}));var value=12*octave+AlphaTab.Model.TuningParser.GetToneForText(step)+semitones|0;note.Octave=value/12|0,note.Tone=value-12*note.Octave},GetOrCreateVoice:function(bar,index){if(index<bar.Voices.length)return bar.Voices[index];for(var i=bar.Voices.length;index>=i;i++)bar.AddVoice(new AlphaTab.Model.Voice);return this._maxVoices=Math.max(this._maxVoices,bar.Voices.length),bar.Voices[index]},ParseDirection:function(element,masterBar){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"sound":var tempo=c.getAttribute("tempo");if(null!=tempo&&0!=tempo.length){var tempoAutomation=new AlphaTab.Model.Automation;tempoAutomation.IsLinear=!0,tempoAutomation.Type=AlphaTab.Model.AutomationType.Tempo,tempoAutomation.Value=AlphaTab.Platform.Std.ParseInt(tempo),masterBar.TempoAutomation=tempoAutomation}break;case"direction-type":var directionType=c.firstChild;switch(directionType.localName){case"words":masterBar.Section=new AlphaTab.Model.Section,masterBar.Section.Text=AlphaTab.Platform.Std.GetNodeValue(directionType)}}}))},ParseAttributes:function(element,bars,masterBar){var number,hasTime=!1;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"divisions":this._divisionsPerQuarterNote=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"key":this.ParseKey(c,masterBar);break;case"time":this.ParseTime(c,masterBar),hasTime=!0;break;case"clef":number=AlphaTab.Platform.Std.ParseInt(c.getAttribute("number")),-2147483648==number&&(number=1),this.ParseClef(c,bars[number-1]);break;case"staff-details":number=AlphaTab.Platform.Std.ParseInt(c.getAttribute("number")),-2147483648==number&&(number=1),this.ParseStaffDetails(c,bars[number-1].Staff.Track)}})),hasTime||(masterBar.TimeSignatureCommon=!0)},ParseClef:function(element,bar){var sign=null,line=0;switch(AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"sign":sign=AlphaTab.Platform.Std.GetNodeValue(c);break;case"line":line=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"clef-octave-change":switch(AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c))){case-2:bar.ClefOttavia=AlphaTab.Model.ClefOttavia._15mb;break;case-1:bar.ClefOttavia=AlphaTab.Model.ClefOttavia._8vb;break;case 1:bar.ClefOttavia=AlphaTab.Model.ClefOttavia._8va;break;case 2:bar.ClefOttavia=AlphaTab.Model.ClefOttavia._15mb}}})),sign){case"G":bar.Clef=AlphaTab.Model.Clef.G2;break;case"F":bar.Clef=AlphaTab.Model.Clef.F4;break;case"C":bar.Clef=3==line?AlphaTab.Model.Clef.C3:AlphaTab.Model.Clef.C4;break;case"percussion":bar.Clef=AlphaTab.Model.Clef.Neutral;break;default:bar.Clef=AlphaTab.Model.Clef.G2}},ParseTime:function(element,masterBar){"common"==element.getAttribute("symbol")&&(masterBar.TimeSignatureCommon=!0);var beatsParsed=!1,beatTypeParsed=!1;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element){var v=AlphaTab.Platform.Std.GetNodeValue(c);switch(c.localName){case"beats":beatsParsed||(masterBar.TimeSignatureNumerator=-1!=!v.indexOf("+")?AlphaTab.Platform.Std.ParseInt(v):4,beatsParsed=!0);break;case"beat-type":beatTypeParsed||(masterBar.TimeSignatureDenominator=-1!=!v.indexOf("+")?AlphaTab.Platform.Std.ParseInt(v):4,beatTypeParsed=!0)}}}))},ParseKey:function(element,masterBar){var fifths=-2147483648,keyStep=-2147483648,keyAlter=-2147483648,mode=null;AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"fifths":fifths=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"key-step":keyStep=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"key-alter":keyAlter=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c));break;case"mode":mode=AlphaTab.Platform.Std.GetNodeValue(c)}})),masterBar.KeySignature=fifths>=-7&&7>=fifths?fifths:0,masterBar.KeySignatureType="minor"==mode?AlphaTab.Model.KeySignatureType.Minor:AlphaTab.Model.KeySignatureType.Major},GetOrCreateMasterBar:function(index){if(index<this._score.MasterBars.length)return this._score.MasterBars[index];for(var i=this._score.MasterBars.length;index>=i;i++){var mb=new AlphaTab.Model.MasterBar;if(this._score.MasterBars.length>0){var prev=this._score.MasterBars[this._score.MasterBars.length-1];mb.TimeSignatureDenominator=prev.TimeSignatureDenominator,mb.TimeSignatureNumerator=prev.TimeSignatureNumerator,mb.KeySignature=prev.KeySignature,mb.KeySignatureType=prev.KeySignatureType}this._score.AddMasterBar(mb)}return this._score.MasterBars[index]},ParseIdentification:function(element){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"creator":"composer"==c.getAttribute("type")&&(this._score.Words=AlphaTab.Platform.Std.GetNodeValue(c.firstChild));break;case"rights":null!=this._score.Copyright&&0!=this._score.Copyright.length&&(this._score.Copyright+="\n"),this._score.Copyright+=AlphaTab.Platform.Std.GetNodeValue(c.firstChild)}}))},ParsePartList:function(element){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"score-part":this.ParseScorePart(c)}}))},ParseScorePart:function(element){var id=element.getAttribute("id"),track=new AlphaTab.Model.Track(1);this._trackById[id]=track,this._score.AddTrack(track),AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"part-name":track.Name=AlphaTab.Platform.Std.GetNodeValue(c.firstChild);break;case"part-abbreviation":track.ShortName=AlphaTab.Platform.Std.GetNodeValue(c.firstChild);break;case"midi-instrument":this.ParseMidiInstrument(c,track)}})),this.IsEmptyTuning(track.Tuning)&&(track.Tuning=new Int32Array(0))},IsEmptyTuning:function(tuning){if(null==tuning)return!0;for(var i=0;i<tuning.length;i++)if(0!=tuning[i])return!1;return!0},ParseMidiInstrument:function(element,track){AlphaTab.Platform.Std.IterateChildren(element,$CreateAnonymousDelegate(this,function(c){if(c.nodeType==AlphaTab.Xml.XmlNodeType.Element)switch(c.localName){case"midi-channel":track.PlaybackInfo.PrimaryChannel=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c.firstChild));break;case"midi-program":track.PlaybackInfo.Program=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c.firstChild));break;case"midi-volume":track.PlaybackInfo.Volume=AlphaTab.Platform.Std.ParseInt(AlphaTab.Platform.Std.GetNodeValue(c.firstChild))}}))}},AlphaTab.Importer.MusicXmlImporter.ParseTied=function(element,note){note.Beat.GraceType==AlphaTab.Model.GraceType.None&&("start"==element.getAttribute("type")?note.IsTieOrigin=!0:note.IsTieDestination=!0)},$Inherit(AlphaTab.Importer.MusicXmlImporter,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.NoCompatibleReaderFoundException=function(){},AlphaTab.Importer.ScoreLoader=function(){},AlphaTab.Importer.ScoreLoader.LoadScoreAsync=function(path,success,error){var loader=AlphaTab.Environment.FileLoaders["default"]();AlphaTab.Util.Logger.Info("ScoreLoader","Loading score from '"+path+"'"),loader.LoadBinaryAsync(path,function(data){var score=null;try{score=AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(data)}catch(e){error(e)}null!=score&&success(score)},error)},AlphaTab.Importer.ScoreLoader.LoadScore=function(path){var loader=AlphaTab.Environment.FileLoaders["default"](),data=loader.LoadBinary(path);return AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(data)},AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes=function(data){var importers=AlphaTab.Importer.ScoreImporter.BuildImporters();AlphaTab.Util.Logger.Info("ScoreLoader","Loading score from "+data.length+" bytes using "+importers.length+" importers");for(var score=null,bb=AlphaTab.IO.ByteBuffer.FromBuffer(data),$i27=0,$l27=importers.length,importer=importers[$i27];$l27>$i27;$i27++,importer=importers[$i27]){bb.Reset();try{AlphaTab.Util.Logger.Info("ScoreLoader","Importing using importer "+importer.get_Name()),importer.Init(bb),score=importer.ReadScore(),AlphaTab.Util.Logger.Info("ScoreLoader","Score imported using "+importer.get_Name());break}catch(e){if(!(e.exception instanceof AlphaTab.Importer.UnsupportedFormatException))throw AlphaTab.Util.Logger.Info("ScoreLoader","Score import failed due to unexpected error: "+e.get_Message()),$CreateException(e,new Error);AlphaTab.Util.Logger.Info("ScoreLoader",importer.get_Name()+" does not support the file")}}if(null!=score)return score;throw AlphaTab.Util.Logger.Info("ScoreLoader","No compatible importer found for file"),$CreateException(new AlphaTab.Importer.NoCompatibleReaderFoundException,new Error)},AlphaTab.Importer.UnsupportedFormatException=function(){},AlphaTab.IO=AlphaTab.IO||{},AlphaTab.IO.BitReader=function(source){this._currentByte=0,this._position=0,this._source=null,this._source=source,this._position=8},AlphaTab.IO.BitReader.prototype={ReadByte:function(){return this.ReadBits(8)},ReadBytes:function(count){for(var bytes=new Uint8Array(count),i=0;count>i;i++)bytes[i]=this.ReadByte();return bytes},ReadBits:function(count){for(var bits=0,i=count-1;i>=0;)bits|=this.ReadBit()<<i,i--;return bits},ReadBitsReversed:function(count){for(var bits=0,i=0;count>i;i++)bits|=this.ReadBit()<<i;return bits},ReadBit:function(){if(this._position>=8){if(this._currentByte=this._source.ReadByte(),-1==this._currentByte)throw $CreateException(new AlphaTab.IO.EndOfReaderException,new Error);this._position=0}var value=this._currentByte>>8-this._position-1&1;return this._position++,value},ReadAll:function(){var all=AlphaTab.IO.ByteBuffer.Empty();try{for(;;)all.WriteByte(this.ReadByte())}catch($$e4){}return all.ToArray()}},$StaticConstructor(function(){AlphaTab.IO.BitReader.ByteSize=8}),AlphaTab.IO.FileLoadException=function(){},AlphaTab.IO.EndOfReaderException=function(){},AlphaTab.IO.ByteBuffer=function(){this._buffer=null,this._position=0,this._length=0,this._capacity=0},AlphaTab.IO.ByteBuffer.prototype={get_Length:function(){return this._length},GetBuffer:function(){return this._buffer},Reset:function(){this._position=0},Skip:function(offset){this._position+=offset},SetCapacity:function(value){if(value!=this._capacity){if(value>0){var newBuffer=new Uint8Array(value);this._length>0&&newBuffer.set(this._buffer.subarray(0,0+this._length),0),this._buffer=newBuffer}else this._buffer=null;this._capacity=value}},ReadByte:function(){var n=this._length-this._position;return 0>=n?-1:this._buffer[this._position++]},Read:function(buffer,offset,count){var n=this._length-this._position;if(n>count&&(n=count),0>=n)return 0;if(8>=n)for(var byteCount=n;--byteCount>=0;)buffer[offset+byteCount]=this._buffer[this._position+byteCount];else buffer.set(this._buffer.subarray(this._position,this._position+n),offset);return this._position+=n,n},WriteByte:function(value){var buffer=new Uint8Array(1);buffer[0]=value,this.Write(buffer,0,1)},Write:function(buffer,offset,count){var i=this._position+count;if(i>this._length&&(i>this._capacity&&this.EnsureCapacity(i),this._length=i),8>=count&&buffer!=this._buffer)for(var byteCount=count;--byteCount>=0;)this._buffer[this._position+byteCount]=buffer[offset+byteCount];else this._buffer.set(buffer.subarray(offset,offset+Math.min(count,buffer.length-offset)),this._position);this._position=i},EnsureCapacity:function(value){if(value>this._capacity){var newCapacity=value;256>newCapacity&&(newCapacity=256),newCapacity<2*this._capacity&&(newCapacity=2*this._capacity),this.SetCapacity(newCapacity)}},ReadAll:function(){return this.ToArray()},ToArray:function(){var copy=new Uint8Array(this._length);return copy.set(this._buffer.subarray(0,0+this._length),0),copy}},AlphaTab.IO.ByteBuffer.Empty=function(){return AlphaTab.IO.ByteBuffer.WithCapactiy(0)},AlphaTab.IO.ByteBuffer.WithCapactiy=function(capacity){var buffer=new AlphaTab.IO.ByteBuffer;return buffer._buffer=new Uint8Array(capacity),buffer._capacity=capacity,buffer},AlphaTab.IO.ByteBuffer.FromBuffer=function(data){var buffer=new AlphaTab.IO.ByteBuffer;return buffer._buffer=data,buffer._capacity=buffer._length=data.length,buffer},AlphaTab.Model.AccentuationType={None:0,Normal:1,Heavy:2},AlphaTab.Model.AccidentalType={None:0,Natural:1,Sharp:2,Flat:3},AlphaTab.Model.Automation=function(){this.IsLinear=!1,this.Type=AlphaTab.Model.AutomationType.Tempo,this.Value=0,this.RatioPosition=0,this.Text=null},AlphaTab.Model.Automation.prototype={Clone:function(){var a=new AlphaTab.Model.Automation;return AlphaTab.Model.Automation.CopyTo(this,a),a}},AlphaTab.Model.Automation.BuildTempoAutomation=function(isLinear,ratioPosition,value,reference){(1>reference||reference>5)&&(reference=2);var references=new Float32Array([1,.5,1,1.5,2,3]),automation=new AlphaTab.Model.Automation;return automation.Type=AlphaTab.Model.AutomationType.Tempo,automation.IsLinear=isLinear,automation.RatioPosition=ratioPosition,automation.Value=value*references[reference],automation},AlphaTab.Model.Automation.CopyTo=function(src,dst){dst.IsLinear=src.IsLinear,dst.RatioPosition=src.RatioPosition,dst.Text=src.Text,dst.Type=src.Type,dst.Value=src.Value},AlphaTab.Model.AutomationType={Tempo:0,Volume:1,Instrument:2,Balance:3},AlphaTab.Model.Bar=function(){this.Id=0,this.Index=0,this.NextBar=null,this.PreviousBar=null,this.Clef=AlphaTab.Model.Clef.Neutral,this.ClefOttavia=AlphaTab.Model.ClefOttavia._15ma,this.Staff=null,this.Voices=null,this.Id=AlphaTab.Model.Bar.GlobalBarId++,this.Voices=[],this.Clef=AlphaTab.Model.Clef.G2,this.ClefOttavia=AlphaTab.Model.ClefOttavia.Regular},AlphaTab.Model.Bar.prototype={AddVoice:function(voice){voice.Bar=this,voice.Index=this.Voices.length,this.Voices.push(voice)},get_MasterBar:function(){return this.Staff.Track.Score.MasterBars[this.Index]},get_IsEmpty:function(){for(var i=0,j=this.Voices.length;j>i;i++)if(!this.Voices[i].IsEmpty)return!1;return!0},Finish:function(){for(var i=0,j=this.Voices.length;j>i;i++){var voice=this.Voices[i];voice.Finish()}}},$StaticConstructor(function(){AlphaTab.Model.Bar.GlobalBarId=0}),AlphaTab.Model.Bar.CopyTo=function(src,dst){dst.Id=src.Id,dst.Index=src.Index,dst.Clef=src.Clef,dst.ClefOttavia=src.ClefOttavia},AlphaTab.Model.Beat=function(){this._minNote=null,this._maxNote=null,this._maxStringNote=null,this._minStringNote=null,this.PreviousBeat=null,this.NextBeat=null,this.Id=0,this.Index=0,this.Voice=null,this.Notes=null,this.IsEmpty=!1,this.IsLegatoOrigin=!1,this.Duration=AlphaTab.Model.Duration.QuadrupleWhole,this.Automations=null,this.Dots=0,this.FadeIn=!1,this.Lyrics=null,this.Pop=!1,this.HasRasgueado=!1,this.Slap=!1,this.Tap=!1,this.Text=null,this.BrushType=AlphaTab.Model.BrushType.None,this.BrushDuration=0,this.TupletDenominator=0,this.TupletNumerator=0,this.WhammyBarPoints=null,this.MaxWhammyPoint=null,this.Vibrato=AlphaTab.Model.VibratoType.None,this.ChordId=null,this.GraceType=AlphaTab.Model.GraceType.None,this.PickStroke=AlphaTab.Model.PickStrokeType.None,this.TremoloSpeed=null,this.Crescendo=AlphaTab.Model.CrescendoType.None,this.Start=0,this.Dynamic=AlphaTab.Model.DynamicValue.PPP,this.InvertBeamDirection=!1,this.Id=AlphaTab.Model.Beat.GlobalBeatId++,this.WhammyBarPoints=[],this.Notes=[],this.BrushType=AlphaTab.Model.BrushType.None,this.Vibrato=AlphaTab.Model.VibratoType.None,this.GraceType=AlphaTab.Model.GraceType.None,this.PickStroke=AlphaTab.Model.PickStrokeType.None,this.Duration=AlphaTab.Model.Duration.Quarter,this.TremoloSpeed=null,this.Automations=[],this.Dots=0,this.Start=0,this.TupletDenominator=-1,this.TupletNumerator=-1,this.Dynamic=AlphaTab.Model.DynamicValue.F,this.Crescendo=AlphaTab.Model.CrescendoType.None,this.InvertBeamDirection=!1,this.Lyrics=[]},AlphaTab.Model.Beat.prototype={get_IsLegatoDestination:function(){return null!=this.PreviousBeat&&this.PreviousBeat.IsLegatoOrigin},get_MinNote:function(){return null==this._minNote&&this.RefreshNotes(),this._minNote},get_MaxNote:function(){return null==this._maxNote&&this.RefreshNotes(),this._maxNote},get_MaxStringNote:function(){return null==this._maxStringNote&&this.RefreshNotes(),this._maxStringNote},get_MinStringNote:function(){return null==this._minStringNote&&this.RefreshNotes(),this._minStringNote},get_IsRest:function(){return 0==this.Notes.length},get_HasTuplet:function(){return!(-1==this.TupletDenominator&&-1==this.TupletNumerator||1==this.TupletDenominator&&1==this.TupletNumerator)},get_HasWhammyBar:function(){return this.WhammyBarPoints.length>0},get_HasChord:function(){return null!=this.ChordId},get_Chord:function(){return this.Voice.Bar.Staff.Track.Chords[this.ChordId]},get_IsTremolo:function(){return null!=this.TremoloSpeed},get_AbsoluteStart:function(){return this.Voice.Bar.get_MasterBar().Start+this.Start},Clone:function(){for(var beat=new AlphaTab.Model.Beat,id=beat.Id,i=0,j=this.WhammyBarPoints.length;j>i;i++)beat.AddWhammyBarPoint(this.WhammyBarPoints[i].Clone());for(var i=0,j=this.Notes.length;j>i;i++)beat.AddNote(this.Notes[i].Clone());AlphaTab.Model.Beat.CopyTo(this,beat);for(var i=0,j=this.Automations.length;j>i;i++)beat.Automations.push(this.Automations[i].Clone());return beat.Id=id,beat},AddWhammyBarPoint:function(point){this.WhammyBarPoints.push(point),(null==this.MaxWhammyPoint||point.Value>this.MaxWhammyPoint.Value)&&(this.MaxWhammyPoint=point)},RemoveWhammyBarPoint:function(index){if(!(0>index||index>=this.WhammyBarPoints.length)){this.WhammyBarPoints.splice(index,1);var point=this.WhammyBarPoints[index];if(point==this.MaxWhammyPoint){this.MaxWhammyPoint=null;for(var $i28=0,$t28=this.WhammyBarPoints,$l28=$t28.length,currentPoint=$t28[$i28];$l28>$i28;$i28++,currentPoint=$t28[$i28])(null==this.MaxWhammyPoint||currentPoint.Value>this.MaxWhammyPoint.Value)&&(this.MaxWhammyPoint=currentPoint)}}},CalculateDuration:function(){var ticks=AlphaTab.Audio.MidiUtils.ToTicks(this.Duration);return 2==this.Dots?ticks=AlphaTab.Audio.MidiUtils.ApplyDot(ticks,!0):1==this.Dots&&(ticks=AlphaTab.Audio.MidiUtils.ApplyDot(ticks,!1)),this.TupletDenominator>0&&this.TupletNumerator>=0&&(ticks=AlphaTab.Audio.MidiUtils.ApplyTuplet(ticks,this.TupletNumerator,this.TupletDenominator)),ticks},AddNote:function(note){note.Beat=this,note.Index=this.Notes.length,this.Notes.push(note)},RemoveNote:function(note){var index=this.Notes.indexOf(note);index>=0&&this.Notes.splice(index,1),(note==this._minNote||note==this._maxNote||note==this._minStringNote||note==this._maxStringNote)&&this.RefreshNotes()},RefreshNotes:function(){for(var i=0,j=this.Notes.length;j>i;i++){var note=this.Notes[i];(null==this._minNote||note.get_RealValue()<this._minNote.get_RealValue())&&(this._minNote=note),(null==this._maxNote||note.get_RealValue()>this._maxNote.get_RealValue())&&(this._maxNote=note),(null==this._minStringNote||note.String<this._minStringNote.String)&&(this._minStringNote=note),(null==this._maxStringNote||note.String>this._maxStringNote.String)&&(this._maxStringNote=note)}},GetAutomation:function(type){for(var i=0,j=this.Automations.length;j>i;i++){var automation=this.Automations[i];if(automation.Type==type)return automation}return null},GetNoteOnString:function(string){for(var i=0,j=this.Notes.length;j>i;i++){var note=this.Notes[i];if(note.String==string)return note}return null},Finish:function(){this.Start=0==this.Index?0:this.PreviousBeat.Start+this.PreviousBeat.CalculateDuration();for(var i=0,j=this.Notes.length;j>i;i++)this.Notes[i].Finish()}},$StaticConstructor(function(){AlphaTab.Model.Beat.WhammyBarMaxPosition=60,AlphaTab.Model.Beat.WhammyBarMaxValue=24,AlphaTab.Model.Beat.GlobalBeatId=0}),AlphaTab.Model.Beat.CopyTo=function(src,dst){dst.Id=src.Id,dst.Index=src.Index,dst.IsEmpty=src.IsEmpty,dst.Duration=src.Duration,dst.Dots=src.Dots,dst.FadeIn=src.FadeIn,dst.Lyrics=null==src.Lyrics?null:src.Lyrics.slice(),dst.Pop=src.Pop,dst.HasRasgueado=src.HasRasgueado,dst.Slap=src.Slap,dst.Tap=src.Tap,dst.Text=src.Text,dst.BrushType=src.BrushType,dst.BrushDuration=src.BrushDuration,dst.TupletDenominator=src.TupletDenominator,dst.TupletNumerator=src.TupletNumerator,dst.Vibrato=src.Vibrato,dst.ChordId=src.ChordId,dst.GraceType=src.GraceType,dst.PickStroke=src.PickStroke,dst.TremoloSpeed=src.TremoloSpeed,dst.Crescendo=src.Crescendo,dst.Start=src.Start,dst.Dynamic=src.Dynamic,dst.IsLegatoOrigin=src.IsLegatoOrigin,dst.InvertBeamDirection=src.InvertBeamDirection},AlphaTab.Model.BendPoint=function(offset,value){this.Offset=0,this.Value=0,this.Offset=offset,this.Value=value},AlphaTab.Model.BendPoint.prototype={Clone:function(){var point=new AlphaTab.Model.BendPoint(0,0);return AlphaTab.Model.BendPoint.CopyTo(this,point),point}},$StaticConstructor(function(){AlphaTab.Model.BendPoint.MaxPosition=60,AlphaTab.Model.BendPoint.MaxValue=12}),AlphaTab.Model.BendPoint.CopyTo=function(src,dst){dst.Offset=src.Offset,dst.Value=src.Value},AlphaTab.Model.BrushType={None:0,BrushUp:1,BrushDown:2,ArpeggioUp:3,ArpeggioDown:4},AlphaTab.Model.Chord=function(){this.Name=null,this.FirstFret=0,this.Strings=null,this.BarreFrets=null,this.Strings=[],this.BarreFrets=[]},AlphaTab.Model.Chord.CopyTo=function(src,dst){dst.FirstFret=src.FirstFret,dst.Name=src.Name,dst.Strings=src.Strings.slice()},AlphaTab.Model.Clef={Neutral:0,C3:1,C4:2,F4:3,G2:4},AlphaTab.Model.ClefOttavia={_15ma:0,_8va:1,Regular:2,_8vb:3,_15mb:4},AlphaTab.Model.CrescendoType={None:0,Crescendo:1,Decrescendo:2},AlphaTab.Model.Duration={QuadrupleWhole:-4,DoubleWhole:-2,Whole:1,Half:2,Quarter:4,Eighth:8,Sixteenth:16,ThirtySecond:32,SixtyFourth:64,OneHundredTwentyEighth:128,TwoHundredFiftySixth:256},AlphaTab.Model.DynamicValue={PPP:0,PP:1,P:2,MP:3,MF:4,F:5,FF:6,FFF:7},AlphaTab.Model.Fingers={Unknown:-2,NoOrDead:-1,Thumb:0,IndexFinger:1,MiddleFinger:2,AnnularFinger:3,LittleFinger:4},AlphaTab.Model.GraceType={None:0,OnBeat:1,BeforeBeat:2},AlphaTab.Model.HarmonicType={None:0,Natural:1,Artificial:2,Pinch:3,Tap:4,Semi:5,Feedback:6},AlphaTab.Model.KeySignatureType={Major:0,Minor:1},AlphaTab.Model.MasterBar=function(){this.AlternateEndings=0,this.NextMasterBar=null,this.PreviousMasterBar=null,this.Index=0,this.KeySignature=0,this.KeySignatureType=AlphaTab.Model.KeySignatureType.Major,this.IsDoubleBar=!1,this.IsRepeatStart=!1,this.RepeatCount=0,this.RepeatGroup=null,this.TimeSignatureNumerator=0,this.TimeSignatureDenominator=0,this.TimeSignatureCommon=!1,this.TripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,this.Section=null,this.TempoAutomation=null,this.VolumeAutomation=null,this.Score=null,this.Start=0,this.TimeSignatureDenominator=4,this.TimeSignatureNumerator=4,this.TripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,this.KeySignatureType=AlphaTab.Model.KeySignatureType.Major,this.TimeSignatureCommon=!1},AlphaTab.Model.MasterBar.prototype={get_IsRepeatEnd:function(){return this.RepeatCount>0},get_IsSectionStart:function(){return null!=this.Section},CalculateDuration:function(){return this.TimeSignatureNumerator*AlphaTab.Audio.MidiUtils.ValueToTicks(this.TimeSignatureDenominator)}},$StaticConstructor(function(){AlphaTab.Model.MasterBar.MaxAlternateEndings=8}),AlphaTab.Model.MasterBar.CopyTo=function(src,dst){dst.AlternateEndings=src.AlternateEndings,dst.Index=src.Index,dst.KeySignature=src.KeySignature,dst.KeySignatureType=src.KeySignatureType,dst.IsDoubleBar=src.IsDoubleBar,dst.IsRepeatStart=src.IsRepeatStart,dst.RepeatCount=src.RepeatCount,dst.TimeSignatureNumerator=src.TimeSignatureNumerator,dst.TimeSignatureDenominator=src.TimeSignatureDenominator,dst.TimeSignatureCommon=src.TimeSignatureCommon,dst.TripletFeel=src.TripletFeel,dst.Start=src.Start},AlphaTab.Model.ModelUtils=function(){},AlphaTab.Model.ModelUtils.GetIndex=function(duration){var index=0,value=duration;return 0>value?index:0|Math.log2(duration)},AlphaTab.Model.ModelUtils.KeySignatureIsFlat=function(ks){return 0>ks},AlphaTab.Model.ModelUtils.KeySignatureIsNatural=function(ks){return 0==ks},AlphaTab.Model.ModelUtils.KeySignatureIsSharp=function(ks){return ks>0},AlphaTab.Model.NoteAccidentalMode={Default:0,SwapAccidentals:1,ForceNatural:2,ForceSharp:3,ForceFlat:4},AlphaTab.Model.Note=function(){this.Id=0,this.Index=0,this.Accentuated=AlphaTab.Model.AccentuationType.None,this.BendPoints=null,this.MaxBendPoint=null,this.Fret=0,this.String=0,this.Octave=0,this.Tone=0,this.Element=0,this.Variation=0,this.IsHammerPullOrigin=!1,this.HammerPullOrigin=null,this.HammerPullDestination=null,this.HarmonicValue=0,this.HarmonicType=AlphaTab.Model.HarmonicType.None,this.IsGhost=!1,this.IsLetRing=!1,this.IsPalmMute=!1,this.IsDead=!1,this.IsStaccato=!1,this.SlideType=AlphaTab.Model.SlideType.None,this.SlideTarget=null,this.Vibrato=AlphaTab.Model.VibratoType.None,this.TieOrigin=null,this.TieDestination=null,this.IsTieDestination=!1,this.IsTieOrigin=!1,this.LeftHandFinger=AlphaTab.Model.Fingers.Thumb,this.RightHandFinger=AlphaTab.Model.Fingers.Thumb,this.IsFingering=!1,this.TrillValue=0,this.TrillSpeed=AlphaTab.Model.Duration.QuadrupleWhole,this.DurationPercent=0,this.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.Default,this.Beat=null,this.Dynamic=AlphaTab.Model.DynamicValue.PPP,this.Id=AlphaTab.Model.Note.GlobalNoteId++,this.BendPoints=[],this.Dynamic=AlphaTab.Model.DynamicValue.F,this.Accentuated=AlphaTab.Model.AccentuationType.None,this.Fret=-2147483648,this.HarmonicType=AlphaTab.Model.HarmonicType.None,this.SlideType=AlphaTab.Model.SlideType.None,this.Vibrato=AlphaTab.Model.VibratoType.None,this.LeftHandFinger=AlphaTab.Model.Fingers.Unknown,this.RightHandFinger=AlphaTab.Model.Fingers.Unknown,this.TrillValue=-1,this.TrillSpeed=AlphaTab.Model.Duration.ThirtySecond,this.DurationPercent=1,this.Octave=-1,this.Tone=-1,this.Fret=-1,this.String=-1,this.Element=-1,this.Variation=-1},AlphaTab.Model.Note.prototype={get_HasBend:function(){return this.BendPoints.length>0},get_IsStringed:function(){return this.Fret>=0&&this.String>=0},get_IsPiano:function(){return this.get_IsStringed()?!1:this.Octave>=0&&this.Tone>=0},get_IsPercussion:function(){return this.get_IsStringed()?!1:this.Element>=0&&this.Variation>=0},get_IsHammerPullDestination:function(){return null!=this.HammerPullOrigin},get_IsHarmonic:function(){return this.HarmonicType!=AlphaTab.Model.HarmonicType.None},get_TrillFret:function(){return this.TrillValue-this.get_StringTuning()},get_IsTrill:function(){return this.TrillValue>=0},get_StringTuning:function(){return this.Beat.Voice.Bar.Staff.Track.Capo+AlphaTab.Model.Note.GetStringTuning(this.Beat.Voice.Bar.Staff.Track,this.String)},get_RealValue:function(){return this.get_IsPercussion()?AlphaTab.Rendering.Utils.PercussionMapper.MidiFromElementVariation(this):this.get_IsStringed()?this.Fret+this.get_StringTuning():this.get_IsPiano()?12*this.Octave+this.Tone:0},Clone:function(){var n=new AlphaTab.Model.Note;AlphaTab.Model.Note.CopyTo(this,n);for(var i=0,j=this.BendPoints.length;j>i;i++)n.AddBendPoint(this.BendPoints[i].Clone());return n},AddBendPoint:function(point){this.BendPoints.push(point),(null==this.MaxBendPoint||point.Value>this.MaxBendPoint.Value)&&(this.MaxBendPoint=point)},Finish:function(){var nextNoteOnLine=new AlphaTab.Util.Lazy($CreateAnonymousDelegate(this,function(){return AlphaTab.Model.Note.NextNoteOnSameLine(this)})),prevNoteOnLine=new AlphaTab.Util.Lazy($CreateAnonymousDelegate(this,function(){return AlphaTab.Model.Note.PreviousNoteOnSameLine(this)}));this.IsTieDestination&&(null==prevNoteOnLine.get_Value()?this.IsTieDestination=!1:(this.TieOrigin=prevNoteOnLine.get_Value(),this.TieOrigin.IsTieOrigin=!0,this.TieOrigin.TieDestination=this,this.Fret=this.TieOrigin.Fret)),this.IsHammerPullOrigin&&(null==nextNoteOnLine.get_Value()?this.IsHammerPullOrigin=!1:(this.HammerPullDestination=nextNoteOnLine.get_Value(),this.HammerPullDestination.HammerPullOrigin=this)),this.SlideType!=AlphaTab.Model.SlideType.None&&(this.SlideTarget=nextNoteOnLine.get_Value());

}},$StaticConstructor(function(){AlphaTab.Model.Note.GlobalNoteId=0,AlphaTab.Model.Note.MaxOffsetForSameLineSearch=3}),AlphaTab.Model.Note.GetStringTuning=function(track,noteString){return track.Tuning.length>0?track.Tuning[track.Tuning.length-(noteString-1)-1]:0},AlphaTab.Model.Note.CopyTo=function(src,dst){dst.Id=src.Id,dst.Accentuated=src.Accentuated,dst.Fret=src.Fret,dst.String=src.String,dst.IsHammerPullOrigin=src.IsHammerPullOrigin,dst.HarmonicValue=src.HarmonicValue,dst.HarmonicType=src.HarmonicType,dst.IsGhost=src.IsGhost,dst.IsLetRing=src.IsLetRing,dst.IsPalmMute=src.IsPalmMute,dst.IsDead=src.IsDead,dst.IsStaccato=src.IsStaccato,dst.SlideType=src.SlideType,dst.Vibrato=src.Vibrato,dst.IsTieDestination=src.IsTieDestination,dst.LeftHandFinger=src.LeftHandFinger,dst.RightHandFinger=src.RightHandFinger,dst.IsFingering=src.IsFingering,dst.TrillValue=src.TrillValue,dst.TrillSpeed=src.TrillSpeed,dst.DurationPercent=src.DurationPercent,dst.AccidentalMode=src.AccidentalMode,dst.Dynamic=src.Dynamic,dst.Octave=src.Octave,dst.Tone=src.Tone,dst.Element=src.Element,dst.Variation=src.Variation},AlphaTab.Model.Note.NextNoteOnSameLine=function(note){for(var nextBeat=note.Beat.NextBeat;null!=nextBeat&&nextBeat.Voice.Bar.Index<=note.Beat.Voice.Bar.Index+3;){var noteOnString=nextBeat.GetNoteOnString(note.String);if(null!=noteOnString)return noteOnString;nextBeat=nextBeat.NextBeat}return null},AlphaTab.Model.Note.PreviousNoteOnSameLine=function(note){for(var previousBeat=note.Beat.PreviousBeat;null!=previousBeat&&previousBeat.Voice.Bar.Index>=note.Beat.Voice.Bar.Index-3;){var noteOnString=previousBeat.GetNoteOnString(note.String);if(null!=noteOnString)return noteOnString;previousBeat=previousBeat.PreviousBeat}return null},AlphaTab.Model.PickStrokeType={None:0,Up:1,Down:2},AlphaTab.Model.PlaybackInformation=function(){this.Volume=0,this.Balance=0,this.Port=0,this.Program=0,this.PrimaryChannel=0,this.SecondaryChannel=0,this.IsMute=!1,this.IsSolo=!1,this.Volume=15,this.Balance=8,this.Port=1},AlphaTab.Model.PlaybackInformation.CopyTo=function(src,dst){dst.Volume=src.Volume,dst.Balance=src.Balance,dst.Port=src.Port,dst.Program=src.Program,dst.PrimaryChannel=src.PrimaryChannel,dst.SecondaryChannel=src.SecondaryChannel,dst.IsMute=src.IsMute,dst.IsSolo=src.IsSolo},AlphaTab.Model.RepeatGroup=function(){this.MasterBars=null,this.Openings=null,this.Closings=null,this.IsClosed=!1,this.MasterBars=[],this.Openings=[],this.Closings=[],this.IsClosed=!1},AlphaTab.Model.RepeatGroup.prototype={AddMasterBar:function(masterBar){0==this.Openings.length&&this.Openings.push(masterBar),this.MasterBars.push(masterBar),masterBar.RepeatGroup=this,masterBar.get_IsRepeatEnd()?(this.Closings.push(masterBar),this.IsClosed=!0):this.IsClosed&&(this.IsClosed=!1,this.Openings.push(masterBar))}},AlphaTab.Model.Score=function(){this._currentRepeatGroup=null,this.Album=null,this.Artist=null,this.Copyright=null,this.Instructions=null,this.Music=null,this.Notices=null,this.SubTitle=null,this.Title=null,this.Words=null,this.Tab=null,this.Tempo=0,this.TempoLabel=null,this.MasterBars=null,this.Tracks=null,this.MasterBars=[],this.Tracks=[],this._currentRepeatGroup=new AlphaTab.Model.RepeatGroup,this.Album=this.Artist=this.Copyright=this.Instructions=this.Music=this.Notices=this.SubTitle=this.Title=this.Words=this.Tab=this.TempoLabel="",this.Tempo=120},AlphaTab.Model.Score.prototype={AddMasterBar:function(bar){bar.Score=this,bar.Index=this.MasterBars.length,0!=this.MasterBars.length&&(bar.PreviousMasterBar=this.MasterBars[this.MasterBars.length-1],bar.PreviousMasterBar.NextMasterBar=bar,bar.Start=bar.PreviousMasterBar.Start+bar.PreviousMasterBar.CalculateDuration()),(bar.IsRepeatStart||this._currentRepeatGroup.IsClosed&&bar.AlternateEndings<=0)&&(this._currentRepeatGroup=new AlphaTab.Model.RepeatGroup),this._currentRepeatGroup.AddMasterBar(bar),this.MasterBars.push(bar)},AddTrack:function(track){track.Score=this,track.Index=this.Tracks.length,this.Tracks.push(track)},Finish:function(){for(var i=0,j=this.Tracks.length;j>i;i++)this.Tracks[i].Finish()}},AlphaTab.Model.Score.CopyTo=function(src,dst){dst.Album=src.Album,dst.Artist=src.Artist,dst.Copyright=src.Copyright,dst.Instructions=src.Instructions,dst.Music=src.Music,dst.Notices=src.Notices,dst.SubTitle=src.SubTitle,dst.Title=src.Title,dst.Words=src.Words,dst.Tab=src.Tab,dst.Tempo=src.Tempo,dst.TempoLabel=src.TempoLabel},AlphaTab.Model.Section=function(){this.Marker=null,this.Text=null,this.Text=this.Marker=""},AlphaTab.Model.Section.CopyTo=function(src,dst){dst.Marker=src.Marker,dst.Text=src.Text},AlphaTab.Model.SlideType={None:0,Shift:1,Legato:2,IntoFromBelow:3,IntoFromAbove:4,OutUp:5,OutDown:6},AlphaTab.Model.Staff=function(){this.Bars=null,this.Track=null,this.Index=0,this.Bars=[]},AlphaTab.Model.Staff.prototype={Finish:function(){for(var i=0,j=this.Bars.length;j>i;i++)this.Bars[i].Finish()}},AlphaTab.Model.Track=function(staveCount){this.Capo=0,this.Index=0,this.Name=null,this.ShortName=null,this.Tuning=null,this.TuningName=null,this.Color=null,this.PlaybackInfo=null,this.IsPercussion=!1,this.Score=null,this.Staves=null,this.Chords=null,this.Name="",this.ShortName="",this.Tuning=new Int32Array(0),this.Chords={},this.PlaybackInfo=new AlphaTab.Model.PlaybackInformation,this.Color=new AlphaTab.Platform.Model.Color(200,0,0,255),this.Staves=[],this.EnsureStaveCount(staveCount)},AlphaTab.Model.Track.prototype={EnsureStaveCount:function(staveCount){for(;this.Staves.length<staveCount;){var staff=new AlphaTab.Model.Staff;staff.Index=this.Staves.length,staff.Track=this,this.Staves.push(staff)}},AddBarToStaff:function(staffIndex,bar){var staff=this.Staves[staffIndex],bars=staff.Bars;bar.Staff=staff,bar.Index=bars.length,bars.length>0&&(bar.PreviousBar=bars[bars.length-1],bar.PreviousBar.NextBar=bar),bars.push(bar)},Finish:function(){(null==this.ShortName||0==this.ShortName.length)&&(this.ShortName=this.Name,this.ShortName.length>10&&(this.ShortName=this.ShortName.substr(0,10)));for(var i=0,j=this.Staves.length;j>i;i++)this.Staves[i].Finish()}},$StaticConstructor(function(){AlphaTab.Model.Track.ShortNameMaxLength=10}),AlphaTab.Model.Track.CopyTo=function(src,dst){dst.Name=src.Name,dst.Capo=src.Capo,dst.Index=src.Index,dst.ShortName=src.ShortName,dst.Tuning=new Int32Array(src.Tuning),dst.Color.Raw=src.Color.Raw,dst.IsPercussion=src.IsPercussion},AlphaTab.Model.TripletFeel={NoTripletFeel:0,Triplet16th:1,Triplet8th:2,Dotted16th:3,Dotted8th:4,Scottish16th:5,Scottish8th:6},AlphaTab.Model.Tuning=function(name,tuning,isStandard){this.IsStandard=!1,this.Name=null,this.Tunings=null,this.IsStandard=isStandard,this.Name=name,this.Tunings=tuning},AlphaTab.Model.Tuning.GetTextForTuning=function(tuning,includeOctave){var octave=tuning/12|0,note=tuning%12,notes=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],result=notes[note];return includeOctave&&(result+=octave-1),result},AlphaTab.Model.Tuning.GetDefaultTuningFor=function(stringCount){return AlphaTab.Model.Tuning._defaultTunings.hasOwnProperty(stringCount)?AlphaTab.Model.Tuning._defaultTunings[stringCount]:null},AlphaTab.Model.Tuning.GetPresetsFor=function(stringCount){switch(stringCount){case 7:return AlphaTab.Model.Tuning._sevenStrings;case 6:return AlphaTab.Model.Tuning._sixStrings;case 5:return AlphaTab.Model.Tuning._fiveStrings;case 4:return AlphaTab.Model.Tuning._fourStrings}return[]},$StaticConstructor(function(){AlphaTab.Model.Tuning._sevenStrings=null,AlphaTab.Model.Tuning._sixStrings=null,AlphaTab.Model.Tuning._fiveStrings=null,AlphaTab.Model.Tuning._fourStrings=null,AlphaTab.Model.Tuning._defaultTunings=null,AlphaTab.Model.Tuning.Initialize()}),AlphaTab.Model.Tuning.Initialize=function(){AlphaTab.Model.Tuning._sevenStrings=[],AlphaTab.Model.Tuning._sixStrings=[],AlphaTab.Model.Tuning._fiveStrings=[],AlphaTab.Model.Tuning._fourStrings=[],AlphaTab.Model.Tuning._defaultTunings={},AlphaTab.Model.Tuning._defaultTunings[7]=new AlphaTab.Model.Tuning("Guitar 7 strings",new Int32Array([64,59,55,50,45,40,35]),!0),AlphaTab.Model.Tuning._sevenStrings.push(AlphaTab.Model.Tuning._defaultTunings[7]),AlphaTab.Model.Tuning._defaultTunings[6]=new AlphaTab.Model.Tuning("Guitar Standard Tuning",new Int32Array([64,59,55,50,45,40]),!0),AlphaTab.Model.Tuning._sixStrings.push(AlphaTab.Model.Tuning._defaultTunings[6]),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Tune down  step",new Int32Array([63,58,54,49,44,39]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Tune down 1 step",new Int32Array([62,57,53,48,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Tune down 2 step",new Int32Array([60,55,51,46,41,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped D Tuning",new Int32Array([64,59,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped D Tuning variant",new Int32Array([64,57,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Double Dropped D Tuning",new Int32Array([62,59,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped E Tuning",new Int32Array([66,61,57,52,47,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped C Tuning",new Int32Array([62,57,53,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open C Tuning",new Int32Array([64,60,55,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Cm Tuning",new Int32Array([63,60,55,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open C6 Tuning",new Int32Array([64,57,55,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Cmaj7 Tuning",new Int32Array([64,59,55,52,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open D Tuning",new Int32Array([62,57,54,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Dm Tuning",new Int32Array([62,57,53,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open D5 Tuning",new Int32Array([62,57,50,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open D6 Tuning",new Int32Array([62,59,54,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Dsus4 Tuning",new Int32Array([62,57,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open E Tuning",new Int32Array([64,59,56,52,47,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Em Tuning",new Int32Array([64,59,55,52,47,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Esus11 Tuning",new Int32Array([64,59,55,52,45,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open F Tuning",new Int32Array([65,60,53,48,45,41]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open G Tuning",new Int32Array([62,59,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Gm Tuning",new Int32Array([62,58,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open G6 Tuning",new Int32Array([64,59,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Gsus4 Tuning",new Int32Array([62,60,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open A Tuning",new Int32Array([64,61,57,52,45,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Am Tuning",new Int32Array([64,60,57,52,45,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Nashville Tuning",new Int32Array([64,59,67,62,57,52]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Bass 6 Strings Tuning",new Int32Array([48,43,38,33,28,23]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Lute or Vihuela Tuning",new Int32Array([64,59,54,50,45,40]),!1)),AlphaTab.Model.Tuning._defaultTunings[5]=new AlphaTab.Model.Tuning("Bass 5 Strings Tuning",new Int32Array([43,38,33,28,23]),!0),AlphaTab.Model.Tuning._fiveStrings.push(AlphaTab.Model.Tuning._defaultTunings[5]),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo Dropped C Tuning",new Int32Array([62,59,55,48,67]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo Open D Tuning",new Int32Array([62,57,54,50,69]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo Open G Tuning",new Int32Array([62,59,55,50,67]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo G Minor Tuning",new Int32Array([62,58,55,50,67]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo G Modal Tuning",new Int32Array([62,57,55,50,67]),!1)),AlphaTab.Model.Tuning._defaultTunings[4]=new AlphaTab.Model.Tuning("Bass Standard Tuning",new Int32Array([43,38,33,28]),!0),AlphaTab.Model.Tuning._fourStrings.push(AlphaTab.Model.Tuning._defaultTunings[4]),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Tune down  step",new Int32Array([42,37,32,27]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Tune down 1 step",new Int32Array([41,36,31,26]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Tune down 2 step",new Int32Array([39,34,29,24]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Dropped D Tuning",new Int32Array([43,38,33,26]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Ukulele C Tuning",new Int32Array([45,40,36,43]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Ukulele G Tuning",new Int32Array([52,47,43,38]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Mandolin Standard Tuning",new Int32Array([64,57,50,43]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Mandolin or Violin Tuning",new Int32Array([76,69,62,55]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Viola Tuning",new Int32Array([69,62,55,48]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Cello Tuning",new Int32Array([57,50,43,36]),!1))},AlphaTab.Model.Tuning.FindTuning=function(strings){for(var tunings=AlphaTab.Model.Tuning.GetPresetsFor(strings.length),t=0,tc=tunings.length;tc>t;t++){for(var tuning=tunings[t],equals=!0,i=0,j=strings.length;j>i;i++)if(strings[i]!=tuning.Tunings[i]){equals=!1;break}if(equals)return tuning}return null},AlphaTab.Model.TuningParser=function(){},AlphaTab.Model.TuningParser.IsTuning=function(name){return null!=AlphaTab.Model.TuningParser.Parse(name)},AlphaTab.Model.TuningParser.Parse=function(name){for(var note="",octave="",i=0;i<name.length;i++){var c=name.charCodeAt(i);if(AlphaTab.Platform.Std.IsCharNumber(c,!1)){if(null==note||0==note.length)return null;octave+=String.fromCharCode(c)}else{if(!(c>=65&&90>=c||c>=97&&122>=c))return null;if(null!=note&&0!=note.length)return null;note+=String.fromCharCode(c)}}if(null==octave||0==octave.length||null==note||0==note.length)return null;var result=new AlphaTab.Model.TuningParser.TuningParseResult;return result.Octave=AlphaTab.Platform.Std.ParseInt(octave),result.Note=note.toLowerCase(),result},AlphaTab.Model.TuningParser.GetTuningForText=function(str){var b=0,result=AlphaTab.Model.TuningParser.Parse(str);return null==result?-1:(b=AlphaTab.Model.TuningParser.GetToneForText(result.Note),b+=12*(result.Octave+1))},AlphaTab.Model.TuningParser.GetToneForText=function(note){var b;switch(note.toLowerCase()){case"c":b=0;break;case"db":b=1;break;case"d":b=2;break;case"eb":b=3;break;case"e":b=4;break;case"f":b=5;break;case"gb":b=6;break;case"g":b=7;break;case"ab":b=8;break;case"a":b=9;break;case"bb":b=10;break;case"b":b=11;break;default:return 0}return b},AlphaTab.Model.VibratoType={None:0,Slight:1,Wide:2},AlphaTab.Model.Voice=function(){this.Index=0,this.Bar=null,this.Beats=null,this.IsEmpty=!1,this.Beats=[],this.IsEmpty=!0},AlphaTab.Model.Voice.prototype={AddBeat:function(beat){beat.Voice=this,beat.Index=this.Beats.length,this.Beats.push(beat),beat.IsEmpty||(this.IsEmpty=!1)},Chain:function(beat){if(null!=this.Bar)if(beat.Index<this.Beats.length-1)beat.NextBeat=this.Beats[beat.Index+1],beat.NextBeat.PreviousBeat=beat;else if(beat.Index==beat.Voice.Beats.length-1&&null!=beat.Voice.Bar.NextBar){var nextVoice=this.Bar.NextBar.Voices[this.Index];nextVoice.Beats.length>0?(beat.NextBeat=nextVoice.Beats[0],beat.NextBeat.PreviousBeat=beat):beat.NextBeat.PreviousBeat=beat}},AddGraceBeat:function(beat){if(0==this.Beats.length)return void this.AddBeat(beat);var lastBeat=this.Beats[this.Beats.length-1];this.Beats.splice(this.Beats.length-1,1),this.AddBeat(beat),this.AddBeat(lastBeat),this.IsEmpty=!1},Finish:function(){for(var i=0,j=this.Beats.length;j>i;i++){var beat=this.Beats[i];this.Chain(beat)}for(var i=0,j=this.Beats.length;j>i;i++){var beat=this.Beats[i];beat.Finish()}}},AlphaTab.Model.Voice.CopyTo=function(src,dst){dst.Index=src.Index,dst.IsEmpty=src.IsEmpty},AlphaTab.Platform.Model=AlphaTab.Platform.Model||{},AlphaTab.Platform.Model.Color=function(r,g,b,a){this.Raw=0,this.RGBA=null,this.Raw=a<<24|r<<16|g<<8|b,this.RGBA=255==a?"#"+AlphaTab.Platform.Std.ToHexString(this.get_R(),2)+AlphaTab.Platform.Std.ToHexString(this.get_G(),2)+AlphaTab.Platform.Std.ToHexString(this.get_B(),2):"rgba("+this.get_R()+","+this.get_G()+","+this.get_B()+","+this.get_A()/255+")"},AlphaTab.Platform.Model.Color.prototype={get_A:function(){return this.Raw>>24&255},get_R:function(){return this.Raw>>16&255},get_G:function(){return this.Raw>>8&255},get_B:function(){return 255&this.Raw}},$StaticConstructor(function(){AlphaTab.Platform.Model.Color.BlackRgb="#000000"}),AlphaTab.Platform.Model.FontStyle={Plain:0,Bold:1,Italic:2},AlphaTab.Platform.Model.Font=function(family,size,style){this._css=null,this.Family=null,this.Size=0,this.Style=AlphaTab.Platform.Model.FontStyle.Plain,this.Family=family,this.Size=size,this.Style=style,this._css=this.ToCssString(1)},AlphaTab.Platform.Model.Font.prototype={get_IsBold:function(){return(this.Style&AlphaTab.Platform.Model.FontStyle.Bold)!=AlphaTab.Platform.Model.FontStyle.Plain},get_IsItalic:function(){return(this.Style&AlphaTab.Platform.Model.FontStyle.Italic)!=AlphaTab.Platform.Model.FontStyle.Plain},Clone:function(){return new AlphaTab.Platform.Model.Font(this.Family,this.Size,this.Style)},ToCssString:function(scale){if(null!=this._css&&1==scale)return this._css;var buf=new String;return this.get_IsBold()&&(buf+="bold "),this.get_IsItalic()&&(buf+="italic "),buf+=this.Size*scale,buf+="px ",buf+="'",buf+=this.Family,buf+="'"}},AlphaTab.Platform.Model.TextAlign={Left:0,Center:1,Right:2},AlphaTab.Platform.Model.TextBaseline={Top:0,Middle:1,Bottom:2},AlphaTab.Platform.Svg=AlphaTab.Platform.Svg||{},AlphaTab.Platform.Svg.FontSizes=function(){},$StaticConstructor(function(){AlphaTab.Platform.Svg.FontSizes.TimesNewRoman=new Uint8Array([3,4,5,6,6,9,9,2,4,4,6,6,3,4,3,3,6,6,6,6,6,6,6,6,6,6,3,3,6,6,6,5,10,8,7,7,8,7,6,7,8,4,4,8,7,10,8,8,7,8,7,5,8,8,7,11,8,8,7,4,3,4,5,6,4,5,5,5,5,5,4,5,6,3,3,6,3,9,6,6,6,5,4,4,4,5,6,7,6,6,5,5,2,5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,6,6,6,6,2,5,4,8,4,6,6,0,8,6,4,6,3,3,4,5,5,4,4,3,3,6,8,8,8,5,8,8,8,8,8,8,11,7,7,7,7,7,4,4,4,4,8,8,8,8,8,8,8,6,8,8,8,8,8,8,6,5,5,5,5,5,5,5,8,5,5,5,5,5,3,3,3,3,6,6,6,6,6,6,6,6,6,5,5,5,5,6,6]),AlphaTab.Platform.Svg.FontSizes.Arial11Pt=new Uint8Array([3,3,4,6,6,10,7,2,4,4,4,6,3,4,3,3,6,6,6,6,6,6,6,6,6,6,3,3,6,6,6,6,11,7,7,8,8,7,7,9,8,3,6,7,6,9,8,9,7,9,8,7,7,8,7,10,7,7,7,3,3,3,5,6,4,6,6,6,6,6,3,6,6,2,2,6,2,9,6,6,6,6,4,6,3,6,6,8,6,6,6,4,3,4,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,6,6,6,6,3,6,4,8,4,6,6,0,8,6,4,6,4,4,4,6,6,4,4,4,4,6,9,9,9,7,7,7,7,7,7,7,11,8,7,7,7,7,3,3,3,3,8,8,9,9,9,9,9,6,9,8,8,8,8,7,7,7,6,6,6,6,6,6,10,6,6,6,6,6,3,3,3,3,6,6,6,6,6,6,6,6,7,6,6,6,6,6,6]),AlphaTab.Platform.Svg.FontSizes.ControlChars=32}),AlphaTab.Platform.Svg.FontSizes.MeasureString=function(s,f,size,style){var data,dataSize,factor=1;(style&AlphaTab.Platform.Model.FontStyle.Italic)!=AlphaTab.Platform.Model.FontStyle.Plain&&(factor*=1.2),(style&AlphaTab.Platform.Model.FontStyle.Bold)!=AlphaTab.Platform.Model.FontStyle.Plain&&(factor*=1.2),f==AlphaTab.Platform.Svg.SupportedFonts.TimesNewRoman?(data=AlphaTab.Platform.Svg.FontSizes.TimesNewRoman,dataSize=11):f==AlphaTab.Platform.Svg.SupportedFonts.Arial?(data=AlphaTab.Platform.Svg.FontSizes.Arial11Pt,dataSize=11):(data=new Uint8Array([8]),dataSize=11);for(var stringSize=0,i=0;i<s.length;i++){var code=Math.min(data.length-1,s.charCodeAt(i)-32);code>=0&&(stringSize+=data[code]*size/dataSize)}return stringSize*factor},AlphaTab.Platform.Svg.SupportedFonts={TimesNewRoman:0,Arial:1},AlphaTab.Platform.Svg.SvgCanvas=function(){this.Buffer=null,this._currentPath=null,this._currentPathIsEmpty=!1,this._Color=null,this._LineWidth=0,this._Font=null,this._TextAlign=AlphaTab.Platform.Model.TextAlign.Left,this._TextBaseline=AlphaTab.Platform.Model.TextBaseline.Top,this._Resources=null,this._currentPath=new String,this._currentPathIsEmpty=!0,this.set_Color(new AlphaTab.Platform.Model.Color(255,255,255,255)),this.set_LineWidth(1),this.set_Font(new AlphaTab.Platform.Model.Font("Arial",10,AlphaTab.Platform.Model.FontStyle.Plain)),this.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left),this.set_TextBaseline(AlphaTab.Platform.Model.TextBaseline.Top)},AlphaTab.Platform.Svg.SvgCanvas.prototype={get_Color:function(){return this._Color},set_Color:function(value){this._Color=value},get_LineWidth:function(){return this._LineWidth},set_LineWidth:function(value){this._LineWidth=value},get_Font:function(){return this._Font},set_Font:function(value){this._Font=value},get_TextAlign:function(){return this._TextAlign},set_TextAlign:function(value){this._TextAlign=value},get_TextBaseline:function(){return this._TextBaseline},set_TextBaseline:function(value){this._TextBaseline=value},get_Resources:function(){return this._Resources},set_Resources:function(value){this._Resources=value},BeginRender:function(width,height){this.Buffer=new String,this.Buffer+='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="',this.Buffer+=width,this.Buffer+='px" height="',this.Buffer+=height,this.Buffer+='px" class="alphaTabSurfaceSvg">\n',this._currentPath=new String,this._currentPathIsEmpty=!0},BeginGroup:function(identifier){this.Buffer+='<g class="'+identifier+'">'},EndGroup:function(){this.Buffer+="</g>"},EndRender:function(){return this.Buffer+="</svg>",this.Buffer},FillRect:function(x,y,w,h){w>0&&(this.Buffer+='<rect x="'+(-0.5|x)+'" y="'+(-0.5|y)+'" width="'+w+'" height="'+h+'" fill="'+this.get_Color().RGBA+'" />\n')},StrokeRect:function(x,y,w,h){this.Buffer+='<rect x="'+(-0.5|x)+'" y="'+(-0.5|y)+'" width="'+w+'" height="'+h+'" stroke="'+this.get_Color().RGBA+'"',1!=this.get_LineWidth()&&(this.Buffer+=' stroke-width="'+this.get_LineWidth()+'"'),this.Buffer+=' fill="transparent" />\n'},BeginPath:function(){},ClosePath:function(){this._currentPath+=" z"},MoveTo:function(x,y){this._currentPath+=" M"+(x-.5)+","+(y-.5)},LineTo:function(x,y){this._currentPathIsEmpty=!1,this._currentPath+=" L"+(x-.5)+","+(y-.5)},QuadraticCurveTo:function(cpx,cpy,x,y){this._currentPathIsEmpty=!1,this._currentPath+=" Q"+cpx+","+cpy+","+x+","+y},BezierCurveTo:function(cp1x,cp1y,cp2x,cp2y,x,y){this._currentPathIsEmpty=!1,this._currentPath+=" C"+cp1x+","+cp1y+","+cp2x+","+cp2y+","+x+","+y},FillCircle:function(x,y,radius){this._currentPathIsEmpty=!1,this._currentPath+=" M"+(x-radius)+","+y+" A1,1 0 0,0 "+(x+radius)+","+y+" A1,1 0 0,0 "+(x-radius)+","+y+" z",this.Fill()},Fill:function(){this._currentPathIsEmpty||(this.Buffer+='<path d="'+this._currentPath+'"',"#000000"!=this.get_Color().RGBA&&(this.Buffer+=' fill="'+this.get_Color().RGBA+'"'),this.Buffer+=' stroke="none"/>'),this._currentPath=new String,this._currentPathIsEmpty=!0},Stroke:function(){if(!this._currentPathIsEmpty){var s='<path d="'+this._currentPath+'" stroke="'+this.get_Color().RGBA+'"';1!=this.get_LineWidth()&&(s+=' stroke-width="'+this.get_LineWidth()+'"'),s+=' fill="none" />',this.Buffer+=s}this._currentPath=new String,this._currentPathIsEmpty=!0},FillText:function(text,x,y){var s='<text x="'+(0|x)+'" y="'+(0|y)+'" style="font:'+this.get_Font().ToCssString(1)+'"  dominant-baseline="'+this.GetSvgBaseLine()+'"';"#000000"!=this.get_Color().RGBA&&(s+=' fill="'+this.get_Color().RGBA+'"'),this.get_TextAlign()!=AlphaTab.Platform.Model.TextAlign.Left&&(s+=' text-anchor="'+this.GetSvgTextAlignment()+'"'),s+=">"+text+"</text>",this.Buffer+=s},GetSvgTextAlignment:function(){switch(this.get_TextAlign()){case AlphaTab.Platform.Model.TextAlign.Left:return"start";case AlphaTab.Platform.Model.TextAlign.Center:return"middle";case AlphaTab.Platform.Model.TextAlign.Right:return"end"}return""},GetSvgBaseLine:function(){switch(this.get_TextBaseline()){case AlphaTab.Platform.Model.TextBaseline.Top:return"hanging";case AlphaTab.Platform.Model.TextBaseline.Middle:return"middle";case AlphaTab.Platform.Model.TextBaseline.Bottom:return"bottom";default:return""}},MeasureText:function(text){if(null==text||0==text.length)return 0;var font=AlphaTab.Platform.Svg.SupportedFonts.Arial;return-1!=this.get_Font().Family.indexOf("Times")&&(font=AlphaTab.Platform.Svg.SupportedFonts.TimesNewRoman),AlphaTab.Platform.Svg.FontSizes.MeasureString(text,font,this.get_Font().Size,this.get_Font().Style)},OnPreRender:function(){return null},OnRenderFinished:function(){return null}},$StaticConstructor(function(){AlphaTab.Platform.Svg.SvgCanvas.BlurCorrection=.5}),AlphaTab.Platform.Svg.FontSvgCanvas=function(){AlphaTab.Platform.Svg.SvgCanvas.call(this)},AlphaTab.Platform.Svg.FontSvgCanvas.prototype={FillMusicFontSymbol:function(x,y,scale,symbol){this.Buffer+='<g transform="translate('+(-0.5|x)+" "+(-0.5|y)+')" class="at" ><text',1!=scale&&(this.Buffer+='  style="font-size: '+100*scale+'%"'),"#000000"!=this.get_Color().RGBA&&(this.Buffer+=' fill="'+this.get_Color().RGBA+'"'),this.Buffer+=">&#"+symbol+";</text></g>"}},$Inherit(AlphaTab.Platform.Svg.FontSvgCanvas,AlphaTab.Platform.Svg.SvgCanvas),AlphaTab.Rendering.BarRendererBase=function(renderer,bar){this._preBeatGlyphs=null,this._voiceContainers=null,this._postBeatGlyphs=null,this._wasFirstOfLine=!1,this._appliedLayoutingInfo=0,this.Staff=null,this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Index=0,this.TopOverflow=0,this.BottomOverflow=0,this.Helpers=null,this.Bar=null,this.IsLinkedToPrevious=!1,this.ScoreRenderer=null,this.LayoutingInfo=null,this.IsFinalized=!1,this.TopPadding=0,this.BottomPadding=0,this.Bar=bar,this.ScoreRenderer=renderer,this.Helpers=new AlphaTab.Rendering.Utils.BarHelpers(bar)},AlphaTab.Rendering.BarRendererBase.prototype={get_NextRenderer:function(){return null==this.Bar.NextBar?null:this.ScoreRenderer.Layout.GetRendererForBar(this.Staff.get_StaveId(),this.Bar.NextBar)},get_PreviousRenderer:function(){return null==this.Bar.PreviousBar?null:this.ScoreRenderer.Layout.GetRendererForBar(this.Staff.get_StaveId(),this.Bar.PreviousBar)},RegisterOverflowTop:function(topOverflow){topOverflow>this.TopOverflow&&(this.TopOverflow=topOverflow)},RegisterOverflowBottom:function(bottomOverflow){bottomOverflow>this.BottomOverflow&&(this.BottomOverflow=bottomOverflow)},ScaleToWidth:function(width){var containerWidth=width-this._preBeatGlyphs.Width-this._postBeatGlyphs.Width;for(var voice in this._voiceContainers){var c=this._voiceContainers[voice];c.ScaleToWidth(containerWidth)}this._postBeatGlyphs.X=this._preBeatGlyphs.X+this._preBeatGlyphs.Width+containerWidth,this.Width=width},get_Resources:function(){return this.ScoreRenderer.RenderingResources},get_Settings:function(){return this.ScoreRenderer.Settings},get_Scale:function(){return this.get_Settings().Scale},get_IsFirstOfLine:function(){return 0==this.Index},get_IsLast:function(){return this.Staff.StaveGroup.IsLast&&this.Index==this.Staff.BarRenderers.length-1},RegisterLayoutingInfo:function(){var info=this.LayoutingInfo,preSize=this._preBeatGlyphs.Width;info.PreBeatSize<preSize&&(info.PreBeatSize=preSize);for(var voice in this._voiceContainers){var c=this._voiceContainers[voice];c.RegisterLayoutingInfo(info)}var postSize=this._postBeatGlyphs.Width;info.PostBeatSize<postSize&&(info.PostBeatSize=postSize)},ApplyLayoutingInfo:function(){if(this._appliedLayoutingInfo>=this.LayoutingInfo.Version)return!1;this._appliedLayoutingInfo=this.LayoutingInfo.Version,this._preBeatGlyphs.Width=this.LayoutingInfo.PreBeatSize;var voiceEnd=this._preBeatGlyphs.X+this._preBeatGlyphs.Width;for(var voice in this._voiceContainers){var c=this._voiceContainers[voice];c.X=this._preBeatGlyphs.X+this._preBeatGlyphs.Width,c.ApplyLayoutingInfo(this.LayoutingInfo);var newEnd=c.X+c.Width;newEnd>voiceEnd&&(voiceEnd=newEnd)}return this._postBeatGlyphs.X=voiceEnd,this._postBeatGlyphs.Width=this.LayoutingInfo.PostBeatSize,this.Width=this._postBeatGlyphs.X+this._postBeatGlyphs.Width,!0},FinalizeRenderer:function(){this.IsFinalized=!0},DoLayout:function(){this._preBeatGlyphs=new AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,this._preBeatGlyphs.Renderer=this,this._voiceContainers={},this._postBeatGlyphs=new AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,this._postBeatGlyphs.Renderer=this;for(var i=0;i<this.Bar.Voices.length;i++){var voice=this.Bar.Voices[i];if(this.HasVoiceContainer(voice)){var c=new AlphaTab.Rendering.Glyphs.VoiceContainerGlyph(0,0,voice);c.Renderer=this,this._voiceContainers[this.Bar.Voices[i].Index]=c}}this.CreatePreBeatGlyphs(),this.CreateBeatGlyphs(),this.CreatePostBeatGlyphs(),this.UpdateSizes()},HasVoiceContainer:function(voice){return!voice.IsEmpty||0==voice.Index},UpdateSizes:function(){this.Staff.RegisterStaffTop(this.TopPadding),this.Staff.RegisterStaffBottom(this.Height-this.BottomPadding);var voiceContainers=this._voiceContainers,beatGlyphsStart=this.get_BeatGlyphsStart(),postBeatStart=beatGlyphsStart;for(var voice in voiceContainers){var c=voiceContainers[voice];c.X=beatGlyphsStart,c.DoLayout();var x=c.X+c.Width;x>postBeatStart&&(postBeatStart=x)}this._postBeatGlyphs.X=postBeatStart,this.Width=this._postBeatGlyphs.X+this._postBeatGlyphs.Width},AddPreBeatGlyph:function(g){this._preBeatGlyphs.AddGlyph(g)},AddBeatGlyph:function(g){g.Renderer=this,g.PreNotes.Renderer=this,g.OnNotes.Renderer=this,g.OnNotes.BeamingHelper=this.Helpers.BeamHelperLookup[g.Beat.Voice.Index][g.Beat.Index],this.GetOrCreateVoiceContainer(g.Beat.Voice).AddGlyph(g)},GetOrCreateVoiceContainer:function(voice){return this._voiceContainers[voice.Index]},GetBeatContainer:function(beat){return this.GetOrCreateVoiceContainer(beat.Voice).BeatGlyphs[beat.Index]},GetPreNotesGlyphForBeat:function(beat){return this.GetBeatContainer(beat).PreNotes},GetOnNotesGlyphForBeat:function(beat){return this.GetBeatContainer(beat).OnNotes},Paint:function(cx,cy,canvas){this.PaintBackground(cx,cy,canvas),canvas.set_Color(this.get_Resources().MainGlyphColor),this._preBeatGlyphs.Paint(cx+this.X,cy+this.Y,canvas);for(var voice in this._voiceContainers){var c=this._voiceContainers[voice];canvas.set_Color(0==c.Voice.Index?this.get_Resources().MainGlyphColor:this.get_Resources().SecondaryGlyphColor),c.Paint(cx+this.X,cy+this.Y,canvas)}canvas.set_Color(this.get_Resources().MainGlyphColor),this._postBeatGlyphs.Paint(cx+this.X,cy+this.Y,canvas)},PaintBackground:function(){},BuildBoundingsLookup:function(masterBarBounds,cx,cy){var barBounds=new AlphaTab.Rendering.Utils.BarBounds;barBounds.Bar=this.Bar,barBounds.VisualBounds={X:cx+this.X,Y:cy+this.Y+this.TopPadding,W:this.Width,H:this.Height-this.TopPadding-this.BottomPadding},barBounds.RealBounds={X:cx+this.X,Y:cy+this.Y,W:this.Width,
H:this.Height},masterBarBounds.AddBar(barBounds);for(var voice in this._voiceContainers){var c=this._voiceContainers[voice];if(!c.Voice.IsEmpty)for(var i=0,j=c.BeatGlyphs.length;j>i;i++){var bc=c.BeatGlyphs[i],beatBoundings=new AlphaTab.Rendering.Utils.BeatBounds;beatBoundings.Beat=bc.Beat,beatBoundings.VisualBounds={X:cx+this.X+c.X+bc.X+bc.OnNotes.X,Y:barBounds.VisualBounds.Y,W:bc.OnNotes.Width,H:barBounds.VisualBounds.H},beatBoundings.RealBounds={X:cx+this.X+c.X+bc.X,Y:barBounds.RealBounds.Y,W:bc.Width,H:barBounds.RealBounds.H},barBounds.AddBeat(beatBoundings)}}},AddPostBeatGlyph:function(g){this._postBeatGlyphs.AddGlyph(g)},CreatePreBeatGlyphs:function(){this._wasFirstOfLine=this.get_IsFirstOfLine()},CreateBeatGlyphs:function(){},CreatePostBeatGlyphs:function(){this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()))},get_BeatGlyphsStart:function(){return this._preBeatGlyphs.X+this._preBeatGlyphs.Width},GetNoteX:function(){return 0},GetBeatX:function(beat,requestedPosition){var container=this.GetBeatContainer(beat);if(null!=container)switch(requestedPosition){case AlphaTab.Rendering.BeatXPosition.PreNotes:return container.VoiceContainer.X+container.X+container.PreNotes.X;case AlphaTab.Rendering.BeatXPosition.OnNotes:return container.VoiceContainer.X+container.X+container.OnNotes.X;case AlphaTab.Rendering.BeatXPosition.PostNotes:return container.VoiceContainer.X+container.X+container.OnNotes.X+container.OnNotes.Width;case AlphaTab.Rendering.BeatXPosition.EndBeat:return container.VoiceContainer.X+container.X+container.Width}return 0},GetNoteY:function(){return 0},ReLayout:function(){this._wasFirstOfLine^this.get_IsFirstOfLine()&&(this._preBeatGlyphs=new AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,this._preBeatGlyphs.Renderer=this,this.CreatePreBeatGlyphs()),this.UpdateSizes(),this.RegisterLayoutingInfo()}},AlphaTab.Rendering.BeatXPosition={PreNotes:0,OnNotes:1,PostNotes:2,EndBeat:3},AlphaTab.Rendering.BarRendererFactory=function(){this.IsInAccolade=!1,this.HideOnMultiTrack=!1,this.HideOnPercussionTrack=!1,this.IsInAccolade=!0,this.HideOnPercussionTrack=!1,this.HideOnMultiTrack=!1},AlphaTab.Rendering.BarRendererFactory.prototype={CanCreate:function(track){return!this.HideOnPercussionTrack||!track.IsPercussion}},AlphaTab.Rendering.EffectBarGlyphSizing={SinglePreBeat:0,SingleOnBeat:1,GroupedBeforeBeat:2,GroupedOnBeat:3,FullBar:4},AlphaTab.Rendering.Glyphs=AlphaTab.Rendering.Glyphs||{},AlphaTab.Rendering.Glyphs.Glyph=function(x,y){this.X=0,this.Y=0,this.Width=0,this.Renderer=null,this.X=x,this.Y=y},AlphaTab.Rendering.Glyphs.Glyph.prototype={get_Scale:function(){return this.Renderer.get_Scale()},DoLayout:function(){},Paint:function(){}},AlphaTab.Rendering.EffectBand=function(info){this._uniqueEffectGlyphs=null,this._effectGlyphs=null,this.IsEmpty=!1,this.PreviousBand=null,this.IsLinkedToPrevious=!1,this.FirstBeat=null,this.LastBeat=null,this.Height=0,this.Info=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this.Info=info,this._uniqueEffectGlyphs=[],this._effectGlyphs=[],this.IsEmpty=!0},AlphaTab.Rendering.EffectBand.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this);for(var i=0;i<this.Renderer.Bar.Voices.length;i++)this._effectGlyphs.push({}),this._uniqueEffectGlyphs.push([])},CreateGlyph:function(beat){if(this.Info.ShouldCreateGlyph(beat)&&(!this.Info.get_HideOnMultiTrack()||0==this.Renderer.Staff.TrackIndex)){this.IsEmpty=!1,(null==this.FirstBeat||this.FirstBeat.Index>beat.Index)&&(this.FirstBeat=beat),(null==this.LastBeat||this.LastBeat.Index<beat.Index)&&(this.LastBeat=beat);var glyph=this.CreateOrResizeGlyph(this.Info.get_SizingMode(),beat);glyph.Height>this.Height&&(this.Height=glyph.Height)}},CreateOrResizeGlyph:function(sizing,b){var g;switch(sizing){case AlphaTab.Rendering.EffectBarGlyphSizing.FullBar:return g=this.Info.CreateNewGlyph(this.Renderer,b),g.Renderer=this.Renderer,g.Beat=b,g.DoLayout(),this._effectGlyphs[b.Voice.Index][b.Index]=g,this._uniqueEffectGlyphs[b.Voice.Index].push(g),g;case AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat:case AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat:return g=this.Info.CreateNewGlyph(this.Renderer,b),g.Renderer=this.Renderer,g.Beat=b,g.DoLayout(),this._effectGlyphs[b.Voice.Index][b.Index]=g,this._uniqueEffectGlyphs[b.Voice.Index].push(g),g;case AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat:if(b.Index>0||this.Renderer.Index>0){var prevBeat=b.PreviousBeat;if(this.Info.ShouldCreateGlyph(prevBeat)){var prevEffect=null;if(b.Index>0&&this._effectGlyphs[b.Voice.Index].hasOwnProperty(prevBeat.Index))prevEffect=this._effectGlyphs[b.Voice.Index][prevBeat.Index];else if(this.Renderer.Index>0){var previousRenderer=this.Renderer.get_PreviousRenderer(),previousBand=previousRenderer.BandLookup[this.Info.get_EffectId()],voiceGlyphs=previousBand._effectGlyphs[b.Voice.Index];voiceGlyphs.hasOwnProperty(prevBeat.Index)&&(prevEffect=voiceGlyphs[prevBeat.Index])}var newGlyph=this.CreateOrResizeGlyph(AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat,b);return null!=prevEffect&&this.Info.CanExpand(prevBeat,b)&&(prevEffect.NextGlyph=newGlyph,newGlyph.PreviousGlyph=prevEffect,this.IsLinkedToPrevious=!0),newGlyph}return this.CreateOrResizeGlyph(AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat,b)}return this.CreateOrResizeGlyph(AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat,b)}return null},Paint:function(cx,cy,canvas){AlphaTab.Rendering.Glyphs.Glyph.prototype.Paint.call(this,cx,cy,canvas);for(var i=0,j=this._uniqueEffectGlyphs.length;j>i;i++)for(var v=this._uniqueEffectGlyphs[i],k=0,l=v.length;l>k;k++){var g=v[k];g.Paint(cx+this.X,cy+this.Y,canvas)}},AlignGlyphs:function(){for(var v=0;v<this._effectGlyphs.length;v++)for(var key in this._effectGlyphs[v])this.AlignGlyph(this.Info.get_SizingMode(),this.Renderer.Bar.Voices[v].Beats[key])},AlignGlyph:function(sizing,beat){var pos,g=this._effectGlyphs[beat.Voice.Index][beat.Index],container=this.Renderer.GetBeatContainer(beat);switch(sizing){case AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat:pos=container.PreNotes,g.X=this.Renderer.get_BeatGlyphsStart()+pos.X+container.X,g.Width=pos.Width;break;case AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat:case AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat:pos=container.OnNotes,g.X=this.Renderer.get_BeatGlyphsStart()+pos.X+container.X,g.Width=pos.Width;break;case AlphaTab.Rendering.EffectBarGlyphSizing.FullBar:g.Width=this.Renderer.Width}}},$Inherit(AlphaTab.Rendering.EffectBand,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.EffectBandSizingInfo=function(){this._effectSlot=null,this.Slots=null,this.Slots=[],this._effectSlot={}},AlphaTab.Rendering.EffectBandSizingInfo.prototype={GetOrCreateSlot:function(band){if(this._effectSlot.hasOwnProperty(band.Info.get_EffectId())){var slot=this._effectSlot[band.Info.get_EffectId()];if(slot.CanBeUsed(band))return slot}for(var $i29=0,$t29=this.Slots,$l29=$t29.length,slot=$t29[$i29];$l29>$i29;$i29++,slot=$t29[$i29])if(slot.CanBeUsed(band))return slot;var newSlot=new AlphaTab.Rendering.EffectBandSlot;return this.Slots.push(newSlot),newSlot},CopySlots:function(sizingInfo){for(var $i30=0,$t30=sizingInfo.Slots,$l30=$t30.length,slot=$t30[$i30];$l30>$i30;$i30++,slot=$t30[$i30]){var copy=new AlphaTab.Rendering.EffectBandSlot;copy.Y=slot.Y,copy.Height=slot.Height,copy.UniqueEffectId=slot.UniqueEffectId,this.Slots.push(copy);for(var $i31=0,$t31=slot.Bands,$l31=$t31.length,band=$t31[$i31];$l31>$i31;$i31++,band=$t31[$i31])this._effectSlot[band.Info.get_EffectId()]=copy}},Register:function(effectBand){var freeSlot=this.GetOrCreateSlot(effectBand);freeSlot.Update(effectBand),this._effectSlot[effectBand.Info.get_EffectId()]=freeSlot}},AlphaTab.Rendering.EffectBandSlot=function(){this.Y=0,this.Height=0,this.FirstBeat=null,this.LastBeat=null,this.Bands=null,this.UniqueEffectId=null,this.Bands=[]},AlphaTab.Rendering.EffectBandSlot.prototype={Update:function(effectBand){effectBand.Info.get_CanShareBand()||(this.UniqueEffectId=effectBand.Info.get_EffectId()),this.Bands.push(effectBand),effectBand.Height>this.Height&&(this.Height=effectBand.Height),(null==this.FirstBeat||this.FirstBeat.Index>effectBand.FirstBeat.Index)&&(this.FirstBeat=effectBand.FirstBeat),(null==this.LastBeat||this.LastBeat.Index<effectBand.LastBeat.Index)&&(this.LastBeat=effectBand.LastBeat)},CanBeUsed:function(band){return(null==this.UniqueEffectId&&band.Info.get_CanShareBand()||band.Info.get_EffectId()==this.UniqueEffectId)&&(null==this.FirstBeat||this.LastBeat.Index<band.FirstBeat.Index||band.LastBeat.Index<this.FirstBeat.Index)}},AlphaTab.Rendering.EffectBarRenderer=function(renderer,bar,infos){this._infos=null,this._bands=null,this.BandLookup=null,this.SizingInfo=null,AlphaTab.Rendering.BarRendererBase.call(this,renderer,bar),this._infos=infos},AlphaTab.Rendering.EffectBarRenderer.prototype={UpdateSizes:function(){this.TopOverflow=0,this.BottomOverflow=0,this.TopPadding=0,this.BottomPadding=0,this.UpdateHeight(),AlphaTab.Rendering.BarRendererBase.prototype.UpdateSizes.call(this)},UpdateHeight:function(){if(null!=this.SizingInfo){for(var y=0,$i32=0,$t32=this.SizingInfo.Slots,$l32=$t32.length,slot=$t32[$i32];$l32>$i32;$i32++,slot=$t32[$i32]){slot.Y=y;for(var $i33=0,$t33=slot.Bands,$l33=$t33.length,band=$t33[$i33];$l33>$i33;$i33++,band=$t33[$i33])band.Y=y,band.Height=slot.Height;y+=slot.Height}this.Height=y}},ApplyLayoutingInfo:function(){if(!AlphaTab.Rendering.BarRendererBase.prototype.ApplyLayoutingInfo.call(this))return!1;if(this.SizingInfo=new AlphaTab.Rendering.EffectBandSizingInfo,this.Index>0){var previousRenderer=this.get_PreviousRenderer();this.SizingInfo.CopySlots(previousRenderer.SizingInfo)}for(var $i34=0,$t34=this._bands,$l34=$t34.length,effectBand=$t34[$i34];$l34>$i34;$i34++,effectBand=$t34[$i34])effectBand.AlignGlyphs(),effectBand.IsEmpty||this.SizingInfo.Register(effectBand);return this.UpdateHeight(),!0},ScaleToWidth:function(width){AlphaTab.Rendering.BarRendererBase.prototype.ScaleToWidth.call(this,width);for(var $i35=0,$t35=this._bands,$l35=$t35.length,effectBand=$t35[$i35];$l35>$i35;$i35++,effectBand=$t35[$i35])effectBand.AlignGlyphs()},CreateBeatGlyphs:function(){this._bands=new Array(this._infos.length),this.BandLookup={};for(var i=0;i<this._infos.length;i++)this._bands[i]=new AlphaTab.Rendering.EffectBand(this._infos[i]),this._bands[i].Renderer=this,this._bands[i].DoLayout(),this.BandLookup[this._infos[i].get_EffectId()]=this._bands[i];for(var $i36=0,$t36=this.Bar.Voices,$l36=$t36.length,voice=$t36[$i36];$l36>$i36;$i36++,voice=$t36[$i36])this.HasVoiceContainer(voice)&&this.CreateVoiceGlyphs(voice);for(var $i37=0,$t37=this._bands,$l37=$t37.length,effectBand=$t37[$i37];$l37>$i37;$i37++,effectBand=$t37[$i37])effectBand.IsLinkedToPrevious&&(this.IsLinkedToPrevious=!0)},CreateVoiceGlyphs:function(v){for(var $i38=0,$t38=v.Beats,$l38=$t38.length,b=$t38[$i38];$l38>$i38;$i38++,b=$t38[$i38]){var container=new AlphaTab.Rendering.Glyphs.BeatContainerGlyph(b,this.GetOrCreateVoiceContainer(v));container.PreNotes=new AlphaTab.Rendering.Glyphs.BeatGlyphBase,container.OnNotes=new AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase,this.AddBeatGlyph(container);for(var $i39=0,$t39=this._bands,$l39=$t39.length,effectBand=$t39[$i39];$l39>$i39;$i39++,effectBand=$t39[$i39])effectBand.CreateGlyph(b)}},Paint:function(cx,cy,canvas){this.PaintBackground(cx,cy,canvas),canvas.set_Color(this.get_Resources().MainGlyphColor);for(var $i40=0,$t40=this._bands,$l40=$t40.length,effectBand=$t40[$i40];$l40>$i40;$i40++,effectBand=$t40[$i40])effectBand.Paint(cx+this.X,cy+this.Y,canvas)}},$Inherit(AlphaTab.Rendering.EffectBarRenderer,AlphaTab.Rendering.BarRendererBase),AlphaTab.Rendering.EffectBarRendererFactory=function(staffId,infos){this._infos=null,this._staffId=null,AlphaTab.Rendering.BarRendererFactory.call(this),this._infos=infos,this._staffId=staffId,this.IsInAccolade=!1},AlphaTab.Rendering.EffectBarRendererFactory.prototype={get_StaffId:function(){return this._staffId},Create:function(renderer,bar){return new AlphaTab.Rendering.EffectBarRenderer(renderer,bar,this._infos)}},$Inherit(AlphaTab.Rendering.EffectBarRendererFactory,AlphaTab.Rendering.BarRendererFactory),AlphaTab.Rendering.Effects=AlphaTab.Rendering.Effects||{},AlphaTab.Rendering.Effects.BeatVibratoEffectInfo=function(){},AlphaTab.Rendering.Effects.BeatVibratoEffectInfo.prototype={get_EffectId:function(){return"beat-vibrato"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},ShouldCreateGlyph:function(beat){return beat.Vibrato!=AlphaTab.Model.VibratoType.None},CreateNewGlyph:function(renderer){return new AlphaTab.Rendering.Glyphs.VibratoGlyph(0,5*renderer.get_Scale(),1.4)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.ChordsEffectInfo=function(){},AlphaTab.Rendering.Effects.ChordsEffectInfo.prototype={get_EffectId:function(){return"chords"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return beat.get_HasChord()},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,beat.get_Chord().Name,renderer.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(){return!1}},AlphaTab.Rendering.Effects.CrescendoEffectInfo=function(){},AlphaTab.Rendering.Effects.CrescendoEffectInfo.prototype={get_EffectId:function(){return"crescendo"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},ShouldCreateGlyph:function(beat){return beat.Crescendo!=AlphaTab.Model.CrescendoType.None},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.CrescendoGlyph(0,0,beat.Crescendo)},CanExpand:function(from,to){return from.Crescendo==to.Crescendo}},AlphaTab.Rendering.Glyphs.EffectGlyph=function(x,y){this.Beat=null,this.NextGlyph=null,this.PreviousGlyph=null,this.Height=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y)},$Inherit(AlphaTab.Rendering.Glyphs.EffectGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Effects.DummyEffectGlyph=function(x,y,s){this._s=null,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y),this._s=s},AlphaTab.Rendering.Effects.DummyEffectGlyph.prototype={DoLayout:function(){this.Width=20*this.get_Scale()},Paint:function(cx,cy,canvas){var res=this.Renderer.get_Resources();canvas.set_Color(res.MainGlyphColor),canvas.StrokeRect(cx+this.X,cy+this.Y,this.Width,20*this.get_Scale()),canvas.set_Font(res.TablatureFont),canvas.FillText(this._s,cx+this.X,cy+this.Y)}},$Inherit(AlphaTab.Rendering.Effects.DummyEffectGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Effects.DynamicsEffectInfo=function(){},AlphaTab.Rendering.Effects.DynamicsEffectInfo.prototype={get_EffectId:function(){return"dynamics"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return 0==beat.Voice.Index&&(0==beat.Index&&0==beat.Voice.Bar.Index||null!=beat.PreviousBeat&&beat.Dynamic!=beat.PreviousBeat.Dynamic)},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.DynamicsGlyph(0,0,beat.Dynamic)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.FadeInEffectInfo=function(){},AlphaTab.Rendering.Effects.FadeInEffectInfo.prototype={get_EffectId:function(){return"fade-in"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return beat.FadeIn},CreateNewGlyph:function(){return new AlphaTab.Rendering.Glyphs.FadeInGlyph(0,0)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.NoteEffectInfoBase=function(){this.LastCreateInfo=null},AlphaTab.Rendering.Effects.NoteEffectInfoBase.prototype={ShouldCreateGlyph:function(beat){this.LastCreateInfo=[];for(var i=0,j=beat.Notes.length;j>i;i++){var n=beat.Notes[i];this.ShouldCreateGlyphForNote(n)&&this.LastCreateInfo.push(n)}return this.LastCreateInfo.length>0},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.HarmonicsEffectInfo=function(){this._beat=null,this._beatType=AlphaTab.Model.HarmonicType.None,AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.HarmonicsEffectInfo.prototype={get_EffectId:function(){return"harmonics"},ShouldCreateGlyphForNote:function(note){return note.get_IsHarmonic()?((note.Beat!=this._beat||note.HarmonicType>this._beatType)&&(this._beat=note.Beat,this._beatType=note.HarmonicType),!0):!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},CreateNewGlyph:function(renderer){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,AlphaTab.Rendering.Effects.HarmonicsEffectInfo.HarmonicToString(this._beatType),renderer.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)}},AlphaTab.Rendering.Effects.HarmonicsEffectInfo.HarmonicToString=function(type){switch(type){case AlphaTab.Model.HarmonicType.Natural:return"N.H.";case AlphaTab.Model.HarmonicType.Artificial:return"A.H.";case AlphaTab.Model.HarmonicType.Pinch:return"P.H.";case AlphaTab.Model.HarmonicType.Tap:return"T.H.";case AlphaTab.Model.HarmonicType.Semi:return"S.H.";case AlphaTab.Model.HarmonicType.Feedback:return"Fdbk."}return""},$Inherit(AlphaTab.Rendering.Effects.HarmonicsEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.LetRingEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.LetRingEffectInfo.prototype={get_EffectId:function(){return"let-ring"},get_CanShareBand:function(){return!1},ShouldCreateGlyphForNote:function(note){return note.IsLetRing},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},CreateNewGlyph:function(){return new AlphaTab.Rendering.Glyphs.LineRangedGlyph("LetRing")}},$Inherit(AlphaTab.Rendering.Effects.LetRingEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.MarkerEffectInfo=function(){},AlphaTab.Rendering.Effects.MarkerEffectInfo.prototype={get_EffectId:function(){return"marker"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat},ShouldCreateGlyph:function(beat){return 0==beat.Voice.Bar.Staff.Index&&0==beat.Voice.Index&&0==beat.Index&&beat.Voice.Bar.get_MasterBar().get_IsSectionStart()},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,beat.Voice.Bar.get_MasterBar().Section.Text,renderer.get_Resources().MarkerFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.NoteVibratoEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.NoteVibratoEffectInfo.prototype={get_EffectId:function(){return"note-vibrato"},ShouldCreateGlyphForNote:function(note){return note.Vibrato!=AlphaTab.Model.VibratoType.None||note.IsTieDestination&&note.TieOrigin.Vibrato!=AlphaTab.Model.VibratoType.None},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},CreateNewGlyph:function(renderer){return new AlphaTab.Rendering.Glyphs.VibratoGlyph(0,5*renderer.get_Scale(),1.2)}},$Inherit(AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.CapoEffectInfo=function(){},AlphaTab.Rendering.Effects.CapoEffectInfo.prototype={get_EffectId:function(){return"capo"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return 0==beat.Index&&0==beat.Voice.Bar.Index&&0!=beat.Voice.Bar.Staff.Track.Capo},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Capo. fret "+beat.Voice.Bar.Staff.Track.Capo,renderer.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(){return!1}},AlphaTab.Rendering.Effects.PalmMuteEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.PalmMuteEffectInfo.prototype={get_EffectId:function(){return"palm-mute"},ShouldCreateGlyphForNote:function(note){return note.IsPalmMute},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},CreateNewGlyph:function(){return new AlphaTab.Rendering.Glyphs.LineRangedGlyph("P.M.")}},$Inherit(AlphaTab.Rendering.Effects.PalmMuteEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.PickStrokeEffectInfo=function(){},AlphaTab.Rendering.Effects.PickStrokeEffectInfo.prototype={get_EffectId:function(){return"pick-stroke"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return beat.PickStroke!=AlphaTab.Model.PickStrokeType.None},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.PickStrokeGlyph(0,0,beat.PickStroke)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.TapEffectInfo=function(){},AlphaTab.Rendering.Effects.TapEffectInfo.prototype={get_EffectId:function(){return"tap"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return beat.Slap||beat.Pop||beat.Tap},CreateNewGlyph:function(renderer,beat){var res=renderer.get_Resources();return beat.Slap?new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"S",res.EffectFont,AlphaTab.Platform.Model.TextAlign.Left):beat.Pop?new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"P",res.EffectFont,AlphaTab.Platform.Model.TextAlign.Left):new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"T",res.EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.TempoEffectInfo=function(){},AlphaTab.Rendering.Effects.TempoEffectInfo.prototype={get_EffectId:function(){return"tempo"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat},ShouldCreateGlyph:function(beat){return 0==beat.Voice.Bar.Staff.Index&&0==beat.Voice.Index&&0==beat.Index&&(null!=beat.Voice.Bar.get_MasterBar().TempoAutomation||0==beat.Voice.Bar.Index)},CreateNewGlyph:function(renderer,beat){var tempo;return tempo=null!=beat.Voice.Bar.get_MasterBar().TempoAutomation?0|beat.Voice.Bar.get_MasterBar().TempoAutomation.Value:beat.Voice.Bar.Staff.Track.Score.Tempo,new AlphaTab.Rendering.Glyphs.TempoGlyph(0,0,tempo)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.TextEffectInfo=function(){},AlphaTab.Rendering.Effects.TextEffectInfo.prototype={get_EffectId:function(){return"text"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(beat){return!AlphaTab.Platform.Std.IsNullOrWhiteSpace(beat.Text)},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,beat.Text,renderer.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.TrillEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.TrillEffectInfo.prototype={get_EffectId:function(){return"trill"},ShouldCreateGlyphForNote:function(note){return note.get_IsTrill()},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},CreateNewGlyph:function(){return new AlphaTab.Rendering.Glyphs.TrillGlyph(0,0)}},$Inherit(AlphaTab.Rendering.Effects.TrillEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo=function(){},AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo.prototype={get_EffectId:function(){return"alternate-feel"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.FullBar},ShouldCreateGlyph:function(beat){return 0==beat.Index&&0!=beat.Voice.Bar.get_MasterBar().AlternateEndings},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph(0,0,beat.Voice.Bar.get_MasterBar().AlternateEndings)},CanExpand:function(){return!0}},AlphaTab.Rendering.Effects.TripletFeelEffectInfo=function(){},AlphaTab.Rendering.Effects.TripletFeelEffectInfo.prototype={get_EffectId:function(){return"triplet-feel"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat},ShouldCreateGlyph:function(beat){return 0==beat.Index&&(0==beat.Voice.Bar.get_MasterBar().Index&&beat.Voice.Bar.get_MasterBar().TripletFeel!=AlphaTab.Model.TripletFeel.NoTripletFeel||beat.Voice.Bar.get_MasterBar().Index>0&&beat.Voice.Bar.get_MasterBar().TripletFeel!=beat.Voice.Bar.get_MasterBar().PreviousMasterBar.TripletFeel)},CreateNewGlyph:function(renderer,beat){return new AlphaTab.Rendering.Glyphs.TripletFeelGlyph(beat.Voice.Bar.get_MasterBar().TripletFeel)},CanExpand:function(){return!0}},AlphaTab.Rendering.Glyphs.MusicFontGlyph=function(x,y,glyphScale,symbol){this.GlyphScale=0,this._symbol=AlphaTab.Rendering.Glyphs.MusicFontSymbol.None,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y),this.GlyphScale=glyphScale,this._symbol=symbol},AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype={Paint:function(cx,cy,canvas){canvas.FillMusicFontSymbol(cx+this.X,cy+this.Y,this.GlyphScale*this.get_Scale(),this._symbol)}},$Inherit(AlphaTab.Rendering.Glyphs.MusicFontGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.AccentuationGlyph=function(x,y,accentuation){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,1,AlphaTab.Rendering.Glyphs.AccentuationGlyph.GetSymbol(accentuation))},AlphaTab.Rendering.Glyphs.AccentuationGlyph.prototype={DoLayout:function(){this.Width=9*this.get_Scale()}},AlphaTab.Rendering.Glyphs.AccentuationGlyph.GetSymbol=function(accentuation){switch(accentuation){case AlphaTab.Model.AccentuationType.None:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None;case AlphaTab.Model.AccentuationType.Normal:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Accentuation;case AlphaTab.Model.AccentuationType.Heavy:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.HeavyAccentuation;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.AccentuationGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.GlyphGroup=function(x,y){this.Glyphs=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y)},AlphaTab.Rendering.Glyphs.GlyphGroup.prototype={get_IsEmpty:function(){return null==this.Glyphs||0==this.Glyphs.length},DoLayout:function(){if(null==this.Glyphs||0==this.Glyphs.length)return void(this.Width=0);for(var w=0,i=0,j=this.Glyphs.length;j>i;i++){var g=this.Glyphs[i];g.Renderer=this.Renderer,g.DoLayout(),w=Math.max(w,g.Width)}this.Width=w},AddGlyph:function(g){null==this.Glyphs&&(this.Glyphs=[]),this.Glyphs.push(g)},Paint:function(cx,cy,canvas){var glyphs=this.Glyphs;if(null!=glyphs&&0!=glyphs.length)for(var $i41=0,$l41=glyphs.length,g=glyphs[$i41];$l41>$i41;$i41++,g=glyphs[$i41])g.Paint(cx+this.X,cy+this.Y,canvas)}},$Inherit(AlphaTab.Rendering.Glyphs.GlyphGroup,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph=function(){AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,0,0)},AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph.prototype={DoLayout:function(){if(null==this.Glyphs)return void(this.Width=0);this.Glyphs.sort($CreateAnonymousDelegate(this,function(a,b){return a.Y-b.Y}));var columns=[];columns.push(-3e3);for(var accidentalSize=21*this.get_Scale(),i=0,j=this.Glyphs.length;j>i;i++){var g=this.Glyphs[i];g.Renderer=this.Renderer,g.DoLayout();for(var gColumn=0;columns[gColumn]>g.Y;)gColumn++,gColumn==columns.length&&columns.push(-3e3);g.X=gColumn,columns[gColumn]=g.Y+accidentalSize}var columnWidth=8*this.get_Scale(),padding=2*this.get_Scale();this.Width=0==this.Glyphs.length?0:padding+columnWidth*columns.length;for(var i=0,j=this.Glyphs.length;j>i;i++){var g=this.Glyphs[i];g.X=padding+(this.Width-(g.X+1)*columnWidth)}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph.NonReserved=-3e3}),$Inherit(AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph=function(x,y,alternateEndings){this._endings=null,this._endingsString=null,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y),this._endings=[];for(var i=0;8>i;i++)0!=(alternateEndings&1<<i)&&this._endings.push(i)},AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Renderer.get_Resources().WordsFont.Size+(3*this.get_Scale()+2);for(var endingsStrings=new String,i=0,j=this._endings.length;j>i;i++)endingsStrings+=this._endings[i]+1,endingsStrings+=". ";this._endingsString=endingsStrings},Paint:function(cx,cy,canvas){if(AlphaTab.Rendering.Glyphs.Glyph.prototype.Paint.call(this,cx,cy,canvas),this._endings.length>0){var res=this.Renderer.get_Resources();canvas.set_Font(res.WordsFont),canvas.MoveTo(cx+this.X,cy+this.Y+this.Height),canvas.LineTo(cx+this.X,cy+this.Y),canvas.LineTo(cx+this.X+this.Width,cy+this.Y),canvas.Stroke(),canvas.FillText(this._endingsString,cx+this.X+3*this.get_Scale(),cy+this.Y*this.get_Scale())}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph.Padding=3}),$Inherit(AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.BarNumberGlyph=function(x,y,number){this._number=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),this._number=number},AlphaTab.Rendering.Glyphs.BarNumberGlyph.prototype={DoLayout:function(){this.Renderer.ScoreRenderer.Canvas.set_Font(this.Renderer.get_Resources().BarNumberFont),this.Width=this.Renderer.ScoreRenderer.Canvas.MeasureText(this._number.toString())+5*this.get_Scale()},Paint:function(cx,cy,canvas){if(this.Renderer.Staff.IsFirstInAccolade){var res=this.Renderer.get_Resources();canvas.set_Color(res.BarNumberColor),canvas.set_Font(res.BarNumberFont),canvas.FillText(this._number.toString(),cx+this.X,cy+this.Y),canvas.set_Color(res.MainGlyphColor)}}},$Inherit(AlphaTab.Rendering.Glyphs.BarNumberGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.BarSeperatorGlyph=function(x,y){AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y)},AlphaTab.Rendering.Glyphs.BarSeperatorGlyph.prototype={DoLayout:function(){this.Width=8*this.get_Scale()},Paint:function(cx,cy,canvas){var blockWidth=4*this.get_Scale(),top=cy+this.Y+this.Renderer.TopPadding,bottom=cy+this.Y+this.Renderer.Height-this.Renderer.BottomPadding,left=cx+this.X|0,h=bottom-top;this.Renderer.get_IsLast()?(canvas.FillRect(left,top,this.get_Scale(),h),canvas.FillRect(left+this.Width-blockWidth,top,blockWidth,h)):(canvas.FillRect(left+this.Width,top,this.get_Scale(),h),this.Renderer.Bar.get_MasterBar().IsDoubleBar&&canvas.FillRect(left+this.Width-5*this.get_Scale(),top,this.get_Scale(),h))}},$Inherit(AlphaTab.Rendering.Glyphs.BarSeperatorGlyph,AlphaTab.Rendering.Glyphs.Glyph),
AlphaTab.Rendering.Glyphs.BeamGlyph=function(x,y,duration,direction,isGrace){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.BeamGlyph.GetSymbol(duration,direction,isGrace))},AlphaTab.Rendering.Glyphs.BeamGlyph.prototype={DoLayout:function(){this.Width=0}},AlphaTab.Rendering.Glyphs.BeamGlyph.GetSymbol=function(duration,direction){if(direction==AlphaTab.Rendering.Utils.BeamDirection.Up)switch(duration){case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpEighth;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpSixteenth;case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpThirtySecond;case AlphaTab.Model.Duration.SixtyFourth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpSixtyFourth;case AlphaTab.Model.Duration.OneHundredTwentyEighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpOneHundredTwentyEighth;case AlphaTab.Model.Duration.TwoHundredFiftySixth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpTwoHundredFiftySixth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpEighth}else switch(duration){case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownEighth;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownSixteenth;case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownThirtySecond;case AlphaTab.Model.Duration.SixtyFourth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownSixtyFourth;case AlphaTab.Model.Duration.OneHundredTwentyEighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownOneHundredTwentyEighth;case AlphaTab.Model.Duration.TwoHundredFiftySixth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownOneHundredTwentyEighth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownEighth}},$Inherit(AlphaTab.Rendering.Glyphs.BeamGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.BeatContainerGlyph=function(beat,voiceContainer){this.VoiceContainer=null,this.Beat=null,this.PreNotes=null,this.OnNotes=null,this.Ties=null,this.MinWidth=0,this.OnTimeX=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this.Beat=beat,this.Ties=[],this.VoiceContainer=voiceContainer},AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype={RegisterLayoutingInfo:function(layoutings){var preBeatStretch=this.PreNotes.Width+this.OnNotes.Width/2;layoutings.AddBeatSpring(this.Beat,this.MinWidth,preBeatStretch),layoutings.SetPreBeatSize(this.Beat,this.PreNotes.Width),layoutings.SetOnBeatSize(this.Beat,this.OnNotes.Width)},ApplyLayoutingInfo:function(info){this.PreNotes.Width=info.GetPreBeatSize(this.Beat),this.OnNotes.Width=info.GetOnBeatSize(this.Beat),this.OnNotes.X=this.PreNotes.X+this.PreNotes.Width,this.OnTimeX=this.OnNotes.X+this.OnNotes.Width/2,this.OnNotes.UpdateBeamingHelper()},DoLayout:function(){this.PreNotes.X=0,this.PreNotes.Renderer=this.Renderer,this.PreNotes.Container=this,this.PreNotes.DoLayout(),this.OnNotes.X=this.PreNotes.X+this.PreNotes.Width,this.OnNotes.Renderer=this.Renderer,this.OnNotes.Container=this,this.OnNotes.DoLayout();for(var i=this.Beat.Notes.length-1;i>=0;)this.CreateTies(this.Beat.Notes[i--]);if(this.MinWidth=this.PreNotes.Width+this.OnNotes.Width,!this.Beat.get_IsRest())if(1==this.OnNotes.BeamingHelper.Beats.length)this.Beat.Duration>=AlphaTab.Model.Duration.Eighth&&(this.MinWidth+=20*this.get_Scale());else switch(this.Beat.Duration){case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:this.MinWidth+=10*this.get_Scale()}this.Width=this.MinWidth,this.OnTimeX=this.OnNotes.X+this.OnNotes.Width/2},ScaleToWidth:function(beatWidth){this.OnNotes.UpdateBeamingHelper(),this.Width=beatWidth},CreateTies:function(){},Paint:function(cx,cy,canvas){if(!this.Beat.Voice.IsEmpty){var isEmptyGlyph=this.PreNotes.get_IsEmpty()&&this.OnNotes.get_IsEmpty()&&0==this.Ties.length;if(!isEmptyGlyph){canvas.BeginGroup("b"+this.Beat.Id);{canvas.get_Color()}this.PreNotes.Paint(cx+this.X,cy+this.Y,canvas),this.OnNotes.Paint(cx+this.X,cy+this.Y,canvas);for(var staffX=cx-this.VoiceContainer.X-this.Renderer.X,staffY=cy-this.VoiceContainer.Y-this.Renderer.Y,i=0,j=this.Ties.length;j>i;i++){var t=this.Ties[i];t.Renderer=this.Renderer,t.Paint(staffX,staffY,canvas)}canvas.EndGroup()}}}},$Inherit(AlphaTab.Rendering.Glyphs.BeatContainerGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.BeatGlyphBase=function(){this.Container=null,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,0,0)},AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype={DoLayout:function(){var w=0;if(null!=this.Glyphs)for(var i=0,j=this.Glyphs.length;j>i;i++){var g=this.Glyphs[i];g.X=w,g.Renderer=this.Renderer,g.DoLayout(),w+=g.Width}this.Width=w},NoteLoop:function(action){for(var i=this.Container.Beat.Notes.length-1;i>=0;i--)action(this.Container.Beat.Notes[i])}},$Inherit(AlphaTab.Rendering.Glyphs.BeatGlyphBase,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase=function(){this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.BeatGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase.prototype={UpdateBeamingHelper:function(){}},$Inherit(AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase,AlphaTab.Rendering.Glyphs.BeatGlyphBase),AlphaTab.Rendering.Glyphs.BendGlyph=function(n,bendValueHeight){this._note=null,this._bendValueHeight=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._note=n,this._bendValueHeight=bendValueHeight},AlphaTab.Rendering.Glyphs.BendGlyph.prototype={Paint:function(cx,cy,canvas){for(var dX=this.Width/60,maxValue=0,i=0,j=this._note.BendPoints.length;j>i;i++)this._note.BendPoints[i].Value>maxValue&&(maxValue=this._note.BendPoints[i].Value);cx+=this.X,cy+=this.Y,canvas.BeginPath();for(var i=0,j=this._note.BendPoints.length-1;j>i;i++){var firstPt=this._note.BendPoints[i],secondPt=this._note.BendPoints[i+1];0!=i||0==firstPt.Value||this._note.IsTieDestination||this.PaintBend(new AlphaTab.Model.BendPoint(0,0),firstPt,cx,cy,dX,canvas),(firstPt.Value!=secondPt.Value||i!=this._note.BendPoints.length-2)&&this.PaintBend(firstPt,secondPt,cx,cy,dX,canvas)}},PaintBend:function(firstPt,secondPt,cx,cy,dX,canvas){var r=this.Renderer,res=this.Renderer.get_Resources(),overflowOffset=r.get_LineOffset()/2,x1=cx+dX*firstPt.Offset,y1=cy-this._bendValueHeight*firstPt.Value;y1+=0==firstPt.Value?r.GetNoteY(this._note):overflowOffset;var x2=cx+dX*secondPt.Offset,y2=cy-this._bendValueHeight*secondPt.Value;y2+=0==secondPt.Value?r.GetNoteY(this._note):overflowOffset;var arrowOffset=0,arrowSize=6*this.get_Scale();if(secondPt.Value>firstPt.Value?(canvas.BeginPath(),canvas.MoveTo(x2,y2),canvas.LineTo(x2-.5*arrowSize,y2+arrowSize),canvas.LineTo(x2+.5*arrowSize,y2+arrowSize),canvas.ClosePath(),canvas.Fill(),arrowOffset=arrowSize):secondPt.Value!=firstPt.Value&&(canvas.BeginPath(),canvas.MoveTo(x2,y2),canvas.LineTo(x2-.5*arrowSize,y2-arrowSize),canvas.LineTo(x2+.5*arrowSize,y2-arrowSize),canvas.ClosePath(),canvas.Fill(),arrowOffset=-arrowSize),canvas.Stroke(),firstPt.Value==secondPt.Value?(canvas.MoveTo(x1,y1),canvas.LineTo(x2,y2),canvas.Stroke()):x2>x1?(canvas.MoveTo(x1,y1),canvas.BezierCurveTo(x2,y1,x2,y2+arrowOffset,x2,y2+arrowOffset),canvas.Stroke()):(canvas.MoveTo(x1,y1),canvas.LineTo(x2,y2),canvas.Stroke()),0!=secondPt.Value){var dV=secondPt.Value,up=secondPt.Value>firstPt.Value;dV=Math.abs(dV);var s="";if(4==dV&&up)s="full",dV-=4;else if(dV>=4||-4>=dV){var steps=dV/4|0;s+=steps,dV-=4*steps}if(dV>0&&(s+=AlphaTab.Rendering.Glyphs.BendGlyph.GetFractionSign(dV)),""!=s){up||(s="-"+s),canvas.set_Font(res.TablatureFont);var size=canvas.MeasureText(s),y=up?y2-res.TablatureFont.Size-2*this.get_Scale():y2+2*this.get_Scale(),x=x2-size/2;canvas.FillText(s,x,y)}}}},AlphaTab.Rendering.Glyphs.BendGlyph.GetFractionSign=function(steps){switch(steps){case 1:return"";case 2:return"";case 3:return"";default:return steps+"/ 4"}},$Inherit(AlphaTab.Rendering.Glyphs.BendGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHarmonic),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.CircleGlyph=function(x,y,size){this._size=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),this._size=size},AlphaTab.Rendering.Glyphs.CircleGlyph.prototype={DoLayout:function(){this.Width=this._size+3*this.get_Scale()},Paint:function(cx,cy,canvas){canvas.FillCircle(cx+this.X,cy+this.Y,this._size)}},$Inherit(AlphaTab.Rendering.Glyphs.CircleGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ClefGlyph=function(x,y,clef,clefOttavia){this._clef=AlphaTab.Model.Clef.Neutral,this._clefOttavia=AlphaTab.Model.ClefOttavia._15ma,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,1,AlphaTab.Rendering.Glyphs.ClefGlyph.GetSymbol(clef)),this._clef=clef,this._clefOttavia=clefOttavia},AlphaTab.Rendering.Glyphs.ClefGlyph.prototype={DoLayout:function(){switch(this._clef){case AlphaTab.Model.Clef.Neutral:this.Width=15*this.get_Scale();break;case AlphaTab.Model.Clef.C3:case AlphaTab.Model.Clef.C4:case AlphaTab.Model.Clef.F4:case AlphaTab.Model.Clef.G2:this.Width=28*this.get_Scale()}},Paint:function(cx,cy,canvas){AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype.Paint.call(this,cx,cy,canvas);var numberGlyph,top=!1;switch(this._clefOttavia){case AlphaTab.Model.ClefOttavia._15ma:numberGlyph=new AlphaTab.Rendering.Glyphs.NumberGlyph(this.Width/2,0,15,.5),top=!0;break;case AlphaTab.Model.ClefOttavia._8va:numberGlyph=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,0,8,.5),top=!0;break;case AlphaTab.Model.ClefOttavia._8vb:numberGlyph=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,0,8,.5);break;case AlphaTab.Model.ClefOttavia._15mb:numberGlyph=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,0,15,.5);break;default:return}var offset;switch(this._clef){case AlphaTab.Model.Clef.Neutral:offset=top?-25:10;break;case AlphaTab.Model.Clef.C3:offset=top?-30:20;break;case AlphaTab.Model.Clef.C4:offset=top?-30:20;break;case AlphaTab.Model.Clef.F4:offset=top?-25:20;break;case AlphaTab.Model.Clef.G2:offset=top?-50:25;break;default:return}numberGlyph.Renderer=this.Renderer,numberGlyph.DoLayout();var x=(this.Width-numberGlyph.Width)/2;numberGlyph.Paint(cx+this.X+x,cy+this.Y+offset*this.get_Scale(),canvas)}},AlphaTab.Rendering.Glyphs.ClefGlyph.GetSymbol=function(clef){switch(clef){case AlphaTab.Model.Clef.Neutral:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefNeutral;case AlphaTab.Model.Clef.C3:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefC;case AlphaTab.Model.Clef.C4:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefC;case AlphaTab.Model.Clef.F4:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefF;case AlphaTab.Model.Clef.G2:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefG;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.ClefGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.GroupedEffectGlyph=function(endPosition){this._endPosition=AlphaTab.Rendering.BeatXPosition.PreNotes,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,0,0),this._endPosition=endPosition},AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.prototype={get_IsLinkedWithPrevious:function(){return null!=this.PreviousGlyph&&this.PreviousGlyph.Renderer.Staff.StaveGroup==this.Renderer.Staff.StaveGroup},get_IsLinkedWithNext:function(){return null!=this.NextGlyph&&this.NextGlyph.Renderer.IsFinalized&&this.NextGlyph.Renderer.Staff.StaveGroup==this.Renderer.Staff.StaveGroup},Paint:function(cx,cy,canvas){if(!this.get_IsLinkedWithPrevious()){if(!this.get_IsLinkedWithNext())return void this.PaintNonGrouped(cx,cy,canvas);for(var lastLinkedGlyph=this.NextGlyph;lastLinkedGlyph.get_IsLinkedWithNext();)lastLinkedGlyph=lastLinkedGlyph.NextGlyph;var cxRenderer=cx-this.Renderer.X,endRenderer=lastLinkedGlyph.Renderer,endBeatX=endRenderer.GetBeatX(lastLinkedGlyph.Beat,this._endPosition),endX=cxRenderer+endRenderer.X+endBeatX;this.PaintGrouped(cx,cy,endX,canvas)}},PaintNonGrouped:function(cx,cy,canvas){var endBeatX=this.Renderer.GetBeatX(this.Beat,AlphaTab.Rendering.BeatXPosition.EndBeat),endX=cx+endBeatX;this.PaintGrouped(cx,cy,endX,canvas)}},$Inherit(AlphaTab.Rendering.Glyphs.GroupedEffectGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.CrescendoGlyph=function(x,y,crescendo){this._crescendo=AlphaTab.Model.CrescendoType.None,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.call(this,AlphaTab.Rendering.BeatXPosition.EndBeat),this._crescendo=crescendo,this.X=x,this.Y=y},AlphaTab.Rendering.Glyphs.CrescendoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=17*this.get_Scale()},PaintGrouped:function(cx,cy,endX,canvas){var startX=cx+this.X,height=this.Height*this.get_Scale();canvas.BeginPath(),this._crescendo==AlphaTab.Model.CrescendoType.Crescendo?(canvas.MoveTo(endX,cy+this.Y),canvas.LineTo(startX,cy+this.Y+height/2),canvas.LineTo(endX,cy+this.Y+height)):(canvas.MoveTo(cx+this.X,cy+this.Y),canvas.LineTo(endX,cy+this.Y+height/2),canvas.LineTo(cx+this.X,cy+this.Y+height)),canvas.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.CrescendoGlyph,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph),AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteDead),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHarmonic),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DigitGlyph=function(x,y,digit,scale){this._digit=0,this._scale=0,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,scale,AlphaTab.Rendering.Glyphs.DigitGlyph.GetSymbol(digit)),this._digit=digit,this._scale=scale},AlphaTab.Rendering.Glyphs.DigitGlyph.prototype={DoLayout:function(){this.Y+=7*this.get_Scale(),this.Width=this.GetDigitWidth(this._digit)*this.get_Scale()*this._scale},GetDigitWidth:function(digit){switch(digit){case 0:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:return 14;case 1:return 10;default:return 0}}},AlphaTab.Rendering.Glyphs.DigitGlyph.GetSymbol=function(digit){switch(digit){case 0:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num0;case 1:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num1;case 2:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num2;case 3:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num3;case 4:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num4;case 5:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num5;case 6:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num6;case 7:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num7;case 8:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num8;case 9:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num9;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.DigitGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DrumSticksGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteSideStick),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.DrumSticksGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.DrumSticksGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DynamicsGlyph=function(x,y,dynamics){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,.6,AlphaTab.Rendering.Glyphs.DynamicsGlyph.GetSymbol(dynamics))},AlphaTab.Rendering.Glyphs.DynamicsGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=17*this.get_Scale(),this.Y+=this.Height/2}},AlphaTab.Rendering.Glyphs.DynamicsGlyph.GetSymbol=function(dynamics){switch(dynamics){case AlphaTab.Model.DynamicValue.PPP:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicPPP;case AlphaTab.Model.DynamicValue.PP:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicPP;case AlphaTab.Model.DynamicValue.P:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicP;case AlphaTab.Model.DynamicValue.MP:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicMP;case AlphaTab.Model.DynamicValue.MF:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicMF;case AlphaTab.Model.DynamicValue.F:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicF;case AlphaTab.Model.DynamicValue.FF:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicFFF;case AlphaTab.Model.DynamicValue.FFF:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicFFF;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.DynamicsGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.FadeInGlyph=function(x,y){AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y)},AlphaTab.Rendering.Glyphs.FadeInGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=17*this.get_Scale()},Paint:function(cx,cy,canvas){var size=6*this.get_Scale(),width=Math.max(this.Width,14*this.get_Scale()),offset=this.Height/2;canvas.BeginPath(),canvas.MoveTo(cx+this.X,cy+this.Y+offset),canvas.QuadraticCurveTo(cx+this.X+width/2,cy+this.Y+offset,cx+this.X+width,cy+this.Y+offset-size),canvas.MoveTo(cx+this.X,cy+this.Y+offset),canvas.QuadraticCurveTo(cx+this.X+width/2,cy+this.Y+offset,cx+this.X+width,cy+this.Y+offset+size),canvas.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.FadeInGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.FlatGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.AccidentalFlat),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.FlatGlyph.prototype={DoLayout:function(){this.Width=8*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.FlatGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.HiHatGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHiHat),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.HiHatGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.HiHatGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup=function(){AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,0,0),this.Glyphs=[]},AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup.prototype={AddGlyph:function(g){g.X=0==this.Glyphs.length?0:this.Glyphs[this.Glyphs.length-1].X+this.Glyphs[this.Glyphs.length-1].Width,g.Renderer=this.Renderer,g.DoLayout(),this.Width=g.X+g.Width,AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.AddGlyph.call(this,g)}},$Inherit(AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.LineRangedGlyph=function(label){this._label=null,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.call(this,AlphaTab.Rendering.BeatXPosition.PostNotes),this._label=label},AlphaTab.Rendering.Glyphs.LineRangedGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Renderer.get_Resources().EffectFont.Size},PaintNonGrouped:function(cx,cy,canvas){var res=this.Renderer.get_Resources();canvas.set_Font(res.EffectFont),canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left),canvas.FillText(this._label,cx+this.X,cy+this.Y)},PaintGrouped:function(cx,cy,endX,canvas){this.PaintNonGrouped(cx,cy,canvas);var lineSpacing=3*this.get_Scale(),textWidth=canvas.MeasureText(this._label),startX=cx+this.X+textWidth+lineSpacing,lineY=cy+this.Y+8*this.get_Scale(),lineSize=8*this.get_Scale();if(endX>startX){for(var lineX=startX;endX>lineX;)canvas.BeginPath(),canvas.MoveTo(lineX,0|lineY),canvas.LineTo(Math.min(lineX+lineSize,endX),0|lineY),lineX+=lineSize+lineSpacing,canvas.Stroke();canvas.BeginPath(),canvas.MoveTo(endX,lineY-6*this.get_Scale()|0),canvas.LineTo(endX,lineY+6*this.get_Scale()|0),canvas.Stroke()}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineSpacing=3,AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineTopPadding=8,AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineTopOffset=6,AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineSize=8}),$Inherit(AlphaTab.Rendering.Glyphs.LineRangedGlyph,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph),AlphaTab.Rendering.Glyphs.MusicFontSymbol={None:-1,ClefG:57424,ClefC:57436,ClefF:57442,ClefNeutral:57449,ClefTab:57453,ClefTabSmall:57454,RestQuadrupleWhole:58593,RestDoubleWhole:58594,RestWhole:58595,RestHalf:58596,RestQuarter:58597,RestEighth:58598,RestSixteenth:58599,RestThirtySecond:58600,RestSixtyFourth:58601,RestOneHundredTwentyEighth:58602,RestTwoHundredFiftySixth:58603,GraceUp:57815,GraceDown:57816,Trill:58726,Num0:57472,Num1:57473,Num2:57474,Num3:57475,Num4:57476,Num5:57477,Num6:57478,Num7:57479,Num8:57480,Num9:57481,TimeSignatureCommon:57482,TimeSignatureCutCommon:57483,NoteQuadrupleWhole:57505,NoteDoubleWhole:57504,NoteWhole:57506,NoteHalf:57507,NoteQuarter:57508,NoteDead:57514,NoteHarmonic:57564,NoteRideCymbal:57566,NoteHiHat:57523,NoteSideStick:57513,NoteHiHatHalf:57591,NoteChineseCymbal:57593,FooterUpEighth:57920,FooterDownEighth:57921,FooterUpSixteenth:57922,FooterDownSixteenth:57923,FooterUpThirtySecond:57924,FooterDownThirtySecond:57925,FooterUpSixtyFourth:57926,FooterDownSixtyFourth:57927,FooterUpOneHundredTwentyEighth:57928,FooterDownOneHundredTwentyEighth:57929,FooterUpTwoHundredFiftySixth:57930,FooterDownTwoHundredFiftySixth:57931,DynamicPPP:58666,DynamicPP:58667,DynamicP:58656,DynamicMP:58668,DynamicMF:58669,DynamicF:58658,DynamicFF:58671,DynamicFFF:58672,Accentuation:58528,HeavyAccentuation:58540,WaveHorizontal:60068,PickStrokeDown:58896,PickStrokeUp:58898,TremoloPickingThirtySecond:57890,TremoloPickingSixteenth:57889,TremoloPickingEighth:57888,Tempo:57813,NoteEighth:57815,AccidentalFlat:57952,AccidentalNatural:57953,AccidentalSharp:57954},AlphaTab.Rendering.Glyphs.NaturalizeGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.AccidentalNatural),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.NaturalizeGlyph.prototype={DoLayout:function(){this.Width=8*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.NaturalizeGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.NoteHeadGlyph=function(x,y,duration,isGrace){this._isGrace=!1,this._duration=AlphaTab.Model.Duration.QuadrupleWhole,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.NoteHeadGlyph.GetSymbol(duration)),this._isGrace=isGrace,this._duration=duration},AlphaTab.Rendering.Glyphs.NoteHeadGlyph.prototype={DoLayout:function(){switch(this._duration){case AlphaTab.Model.Duration.QuadrupleWhole:this.Width=14*(this._isGrace?.75:1)*this.get_Scale();break;case AlphaTab.Model.Duration.DoubleWhole:this.Width=14*(this._isGrace?.75:1)*this.get_Scale();break;case AlphaTab.Model.Duration.Whole:this.Width=14*(this._isGrace?.75:1)*this.get_Scale();break;default:this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.NoteHeadGlyph.GraceScale=.75,AlphaTab.Rendering.Glyphs.NoteHeadGlyph.NoteHeadHeight=9}),AlphaTab.Rendering.Glyphs.NoteHeadGlyph.GetSymbol=function(duration){switch(duration){case AlphaTab.Model.Duration.QuadrupleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteQuadrupleWhole;case AlphaTab.Model.Duration.DoubleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteDoubleWhole;case AlphaTab.Model.Duration.Whole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteWhole;case AlphaTab.Model.Duration.Half:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHalf;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteQuarter}},$Inherit(AlphaTab.Rendering.Glyphs.NoteHeadGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.NoteNumberGlyph=function(x,y,n){this._noteString=null,this._noteStringWidth=0,this._trillNoteString=null,this._trillNoteStringWidth=0,this.IsEmpty=!1,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),n.IsTieDestination?this._noteString=0==n.Beat.Index||n.get_HasBend()?"("+n.TieOrigin.Fret+")":"":(this._noteString=n.IsDead?"x":n.Fret.toString(),n.IsGhost&&(this._noteString="("+this._noteString+")")),this._trillNoteString=n.get_IsTrill()?"("+n.get_TrillFret()+")":""},AlphaTab.Rendering.Glyphs.NoteNumberGlyph.prototype={DoLayout:function(){this.IsEmpty=!(null!=this._noteString&&0!=this._noteString.length||null!=this._trillNoteString&&0!=this._trillNoteString.length),this.IsEmpty||(this.Renderer.ScoreRenderer.Canvas.set_Font(this.Renderer.get_Resources().TablatureFont),this._noteStringWidth=this.Renderer.ScoreRenderer.Canvas.MeasureText(this._noteString),this._trillNoteStringWidth=this.Renderer.ScoreRenderer.Canvas.MeasureText(this._trillNoteString),this.Width=this._noteStringWidth+this._trillNoteStringWidth)},Paint:function(cx,cy,canvas){if(!this.IsEmpty){var textWidth=this._noteStringWidth+this._trillNoteStringWidth,x=cx+this.X+(this.Width-textWidth)/2;canvas.FillText(this._noteString,x,cy+this.Y),canvas.FillText(this._trillNoteString,x+this._noteStringWidth,cy+this.Y)}}},$Inherit(AlphaTab.Rendering.Glyphs.NoteNumberGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.NumberGlyph=function(x,y,number,scale){this._number=0,this._scale=0,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,x,y),this._number=number,this._scale=scale},AlphaTab.Rendering.Glyphs.NumberGlyph.prototype={DoLayout:function(){for(var i=this._number;i>0;){var num=i%10,gl=new AlphaTab.Rendering.Glyphs.DigitGlyph(0,0,num,this._scale);this.AddGlyph(gl),i=i/10|0}this.Glyphs.reverse();for(var cx=0,j=0,k=this.Glyphs.length;k>j;j++){var g=this.Glyphs[j];g.X=cx,g.Y=0,g.Renderer=this.Renderer,g.DoLayout(),cx+=g.Width}this.Width=cx}},$Inherit(AlphaTab.Rendering.Glyphs.NumberGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.PickStrokeGlyph=function(x,y,pickStroke){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,.75,AlphaTab.Rendering.Glyphs.PickStrokeGlyph.GetSymbol(pickStroke))},AlphaTab.Rendering.Glyphs.PickStrokeGlyph.prototype={DoLayout:function(){this.Width=9*this.get_Scale(),this.Height=10*this.get_Scale()},Paint:function(cx,cy,canvas){AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype.Paint.call(this,cx,cy+this.Height,canvas)}},AlphaTab.Rendering.Glyphs.PickStrokeGlyph.GetSymbol=function(pickStroke){switch(pickStroke){case AlphaTab.Model.PickStrokeType.Up:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.PickStrokeUp;case AlphaTab.Model.PickStrokeType.Down:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.PickStrokeDown;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.PickStrokeGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.RepeatCloseGlyph=function(x,y){AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y)},AlphaTab.Rendering.Glyphs.RepeatCloseGlyph.prototype={DoLayout:function(){this.Width=11*this.get_Scale()},Paint:function(cx,cy,canvas){var blockWidth=4*this.get_Scale(),top=cy+this.Y+this.Renderer.TopPadding,bottom=cy+this.Y+this.Renderer.Height-this.Renderer.BottomPadding,left=cx+this.X,h=bottom-top,circleSize=1.5*this.get_Scale(),middle=(top+bottom)/2;canvas.FillCircle(left,middle-3*circleSize,circleSize),canvas.FillCircle(left,middle+3*circleSize,circleSize),left+=4*this.get_Scale(),canvas.BeginPath(),canvas.MoveTo(left,top),canvas.LineTo(left,bottom),canvas.Stroke(),left+=3*this.get_Scale()+.5,canvas.FillRect(left,top,blockWidth,h)}},$Inherit(AlphaTab.Rendering.Glyphs.RepeatCloseGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.RepeatCountGlyph=function(x,y,count){this._count=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),this._count=count},AlphaTab.Rendering.Glyphs.RepeatCountGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(cx,cy,canvas){var res=this.Renderer.get_Resources(),oldAlign=canvas.get_TextAlign();canvas.set_Font(res.BarNumberFont),canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Right);var s="x"+this._count,w=canvas.MeasureText(s)/1.5;canvas.FillText(s,cx+this.X-w,cy+this.Y),canvas.set_TextAlign(oldAlign)}},$Inherit(AlphaTab.Rendering.Glyphs.RepeatCountGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.RepeatOpenGlyph=function(x,y,circleSize,dotOffset){this._dotOffset=0,this._circleSize=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),this._dotOffset=dotOffset,this._circleSize=circleSize},AlphaTab.Rendering.Glyphs.RepeatOpenGlyph.prototype={DoLayout:function(){this.Width=13*this.get_Scale()},Paint:function(cx,cy,canvas){var blockWidth=4*this.get_Scale(),top=cy+this.Y+this.Renderer.TopPadding,bottom=cy+this.Y+this.Renderer.Height-this.Renderer.BottomPadding,left=cx+this.X+.5,h=bottom-top;canvas.FillRect(left,top,blockWidth,h),left+=2*blockWidth-.5,canvas.BeginPath(),canvas.MoveTo(left,top),canvas.LineTo(left,bottom),canvas.Stroke(),left+=3*this.get_Scale();var circleSize=this._circleSize*this.get_Scale(),middle=(top+bottom)/2;canvas.FillCircle(left,middle-circleSize*this._dotOffset,circleSize),canvas.FillCircle(left,middle+circleSize*this._dotOffset,circleSize)}},$Inherit(AlphaTab.Rendering.Glyphs.RepeatOpenGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TieGlyph=function(startBeat,endBeat,forEnd){this.StartBeat=null,this.EndBeat=null,this.YOffset=0,this._forEnd=!1,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this.StartBeat=startBeat,this.EndBeat=endBeat,this._forEnd=forEnd},AlphaTab.Rendering.Glyphs.TieGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(cx,cy,canvas){if(null!=this.EndBeat){var startNoteRenderer=this.Renderer.ScoreRenderer.Layout.GetRendererForBar(this.Renderer.Staff.get_StaveId(),this.StartBeat.Voice.Bar),endNoteRenderer=this.Renderer.ScoreRenderer.Layout.GetRendererForBar(this.Renderer.Staff.get_StaveId(),this.EndBeat.Voice.Bar),startX=0,endX=0,startY=0,endY=0,shouldDraw=!1,direction=this.GetBeamDirection(this.StartBeat,startNoteRenderer);this._forEnd?startNoteRenderer.Staff!=endNoteRenderer.Staff&&(startX=cx+endNoteRenderer.X,endX=cx+endNoteRenderer.X+this.GetEndX(endNoteRenderer),startY=cy+endNoteRenderer.Y+this.GetEndY(endNoteRenderer,direction)+this.YOffset,endY=startY,shouldDraw=!0):(startNoteRenderer!=endNoteRenderer?(startX=cx+startNoteRenderer.X+this.GetStartX(startNoteRenderer),startY=cy+startNoteRenderer.Y+this.GetStartY(startNoteRenderer,direction)+this.YOffset,null==endNoteRenderer||startNoteRenderer.Staff!=endNoteRenderer.Staff?(endX=cx+startNoteRenderer.X+startNoteRenderer.Width,endY=startY):(endX=cx+endNoteRenderer.X+this.GetEndX(endNoteRenderer),
endY=cy+endNoteRenderer.Y+this.GetEndY(endNoteRenderer,direction)+this.YOffset)):(startX=cx+startNoteRenderer.X+this.GetStartX(startNoteRenderer),endX=cx+endNoteRenderer.X+this.GetEndX(endNoteRenderer),startY=cy+startNoteRenderer.Y+this.GetStartY(startNoteRenderer,direction)+this.YOffset,endY=cy+endNoteRenderer.Y+this.GetEndY(endNoteRenderer,direction)+this.YOffset),shouldDraw=!0),shouldDraw&&(AlphaTab.Rendering.Glyphs.TieGlyph.PaintTie(canvas,this.get_Scale(),startX,startY,endX,endY,direction==AlphaTab.Rendering.Utils.BeamDirection.Down),canvas.Fill())}},GetBeamDirection:function(){return AlphaTab.Rendering.Utils.BeamDirection.Down},GetStartY:function(){return 0},GetEndY:function(){return 0},GetStartX:function(){return 0},GetEndX:function(){return 0}},AlphaTab.Rendering.Glyphs.TieGlyph.PaintTie=function(canvas,scale,x1,y1,x2,y2,down){if(x1!=x2||y1!=y2){if(x1>x2){var t=x1;x1=x2,x2=t,t=y1,y1=y2,y2=t}var offset=22*scale,size=4*scale,normalVectorX=y2-y1,normalVectorY=x2-x1,length=Math.sqrt(normalVectorX*normalVectorX+normalVectorY*normalVectorY);down?normalVectorX*=-1:normalVectorY*=-1,normalVectorX/=length,normalVectorY/=length;var centerX=(x2+x1)/2,centerY=(y2+y1)/2,cp1X=centerX+offset*normalVectorX,cp1Y=centerY+offset*normalVectorY,cp2X=centerX+(offset-size)*normalVectorX,cp2Y=centerY+(offset-size)*normalVectorY;canvas.BeginPath(),canvas.MoveTo(x1,y1),canvas.QuadraticCurveTo(cp1X,cp1Y,x2,y2),canvas.QuadraticCurveTo(cp2X,cp2Y,x1,y1),canvas.ClosePath()}},$Inherit(AlphaTab.Rendering.Glyphs.TieGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph=function(startBeat,endBeat,forEnd){AlphaTab.Rendering.Glyphs.TieGlyph.call(this,startBeat,endBeat,forEnd)},AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.TieGlyph.prototype.DoLayout.call(this),this.YOffset=4.5},GetBeamDirection:function(beat,noteRenderer){if(beat.get_IsRest())return AlphaTab.Rendering.Utils.BeamDirection.Up;switch(noteRenderer.GetBeatDirection(beat)){case AlphaTab.Rendering.Utils.BeamDirection.Up:return AlphaTab.Rendering.Utils.BeamDirection.Down;case AlphaTab.Rendering.Utils.BeamDirection.Down:default:return AlphaTab.Rendering.Utils.BeamDirection.Up}},GetStartY:function(noteRenderer,direction){if(this.StartBeat.get_IsRest())return noteRenderer.GetScoreY(9,0);switch(direction){case AlphaTab.Rendering.Utils.BeamDirection.Up:return noteRenderer.GetNoteY(this.StartBeat.get_MinNote());default:return noteRenderer.GetNoteY(this.StartBeat.get_MaxNote())}},GetEndY:function(noteRenderer,direction){if(this.EndBeat.get_IsRest())switch(direction){case AlphaTab.Rendering.Utils.BeamDirection.Up:return noteRenderer.GetScoreY(9,0);default:return noteRenderer.GetScoreY(0,0)}switch(direction){case AlphaTab.Rendering.Utils.BeamDirection.Up:return noteRenderer.GetNoteY(this.EndBeat.get_MinNote());default:return noteRenderer.GetNoteY(this.EndBeat.get_MaxNote())}},GetStartX:function(noteRenderer){return this.StartBeat.get_IsRest()?noteRenderer.GetBeatX(this.StartBeat,AlphaTab.Rendering.BeatXPosition.PreNotes):noteRenderer.GetNoteX(this.StartBeat.get_MinNote(),!0)},GetEndX:function(noteRenderer){return this.EndBeat.get_IsRest()?noteRenderer.GetBeatX(this.EndBeat,AlphaTab.Rendering.BeatXPosition.PreNotes):noteRenderer.GetNoteX(this.EndBeat.get_MinNote(),!1)}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph,AlphaTab.Rendering.Glyphs.TieGlyph),AlphaTab.Rendering.Glyphs.ScoreRestGlyph=function(x,y,duration){this._duration=AlphaTab.Model.Duration.QuadrupleWhole,this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,1,AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSymbol(duration)),this._duration=duration},AlphaTab.Rendering.Glyphs.ScoreRestGlyph.prototype={DoLayout:function(){switch(this._duration){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.DoubleWhole:case AlphaTab.Model.Duration.Whole:case AlphaTab.Model.Duration.Half:case AlphaTab.Model.Duration.Quarter:case AlphaTab.Model.Duration.Eighth:case AlphaTab.Model.Duration.Sixteenth:this.Width=9*this.get_Scale();break;case AlphaTab.Model.Duration.ThirtySecond:this.Width=12*this.get_Scale();break;case AlphaTab.Model.Duration.SixtyFourth:this.Width=14*this.get_Scale();break;case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:this.Width=20*this.get_Scale()}},UpdateBeamingHelper:function(cx){null!=this.BeamingHelper&&this.BeamingHelper.RegisterBeatLineX("score",this.Beat,cx+this.X+this.Width/2,cx+this.X+this.Width/2)}},AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSymbol=function(duration){switch(duration){case AlphaTab.Model.Duration.QuadrupleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestQuadrupleWhole;case AlphaTab.Model.Duration.DoubleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestDoubleWhole;case AlphaTab.Model.Duration.Whole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestWhole;case AlphaTab.Model.Duration.Half:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestHalf;case AlphaTab.Model.Duration.Quarter:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestQuarter;case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestEighth;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestSixteenth;case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestThirtySecond;case AlphaTab.Model.Duration.SixtyFourth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestSixtyFourth;case AlphaTab.Model.Duration.OneHundredTwentyEighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestOneHundredTwentyEighth;case AlphaTab.Model.Duration.TwoHundredFiftySixth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestTwoHundredFiftySixth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreRestGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.RideCymbalGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteRideCymbal),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.RideCymbalGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.RideCymbalGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.ScoreBeatContainerGlyph=function(beat,voiceContainer){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.call(this,beat,voiceContainer)},AlphaTab.Rendering.ScoreBeatContainerGlyph.prototype={DoLayout:function(){if(AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.DoLayout.call(this),this.Beat.IsLegatoOrigin){if(null==this.Beat.PreviousBeat||!this.Beat.PreviousBeat.IsLegatoOrigin){for(var destination=this.Beat.NextBeat;null!=destination.NextBeat&&destination.NextBeat.get_IsLegatoDestination();)destination=destination.NextBeat;this.Ties.push(new AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph(this.Beat,destination,!1))}}else if(this.Beat.get_IsLegatoDestination()&&!this.Beat.IsLegatoOrigin){for(var origin=this.Beat.PreviousBeat;null!=origin.PreviousBeat&&origin.PreviousBeat.IsLegatoOrigin;)origin=origin.PreviousBeat;this.Ties.push(new AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph(origin,this.Beat,!0))}},CreateTies:function(n){if(n.IsTieOrigin){var tie=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(n,n.TieDestination,!1);this.Ties.push(tie)}if(n.IsTieDestination){var tie=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(n.TieOrigin,n,!0);this.Ties.push(tie)}else if(n.IsHammerPullOrigin){if(null==n.HammerPullOrigin){for(var destination=n.HammerPullDestination;null!=destination.HammerPullDestination;)destination=destination.HammerPullDestination;var tie=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(n,destination,!1);this.Ties.push(tie)}}else if(n.get_IsHammerPullDestination()){if(null==n.HammerPullDestination){for(var origin=n.HammerPullOrigin;null!=origin.HammerPullOrigin;)origin=origin.HammerPullOrigin;var tie=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(origin,n,!0);this.Ties.push(tie)}}else if(n.SlideType==AlphaTab.Model.SlideType.Legato){var tie=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(n,n.SlideTarget,!1);this.Ties.push(tie)}if(n.SlideType!=AlphaTab.Model.SlideType.None){var l=new AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph(n.SlideType,n,this);this.Ties.push(l)}}},$Inherit(AlphaTab.Rendering.ScoreBeatContainerGlyph,AlphaTab.Rendering.Glyphs.BeatContainerGlyph),AlphaTab.Rendering.Glyphs.ScoreBeatGlyph=function(){this.NoteHeads=null,this.RestGlyph=null,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.prototype={UpdateBeamingHelper:function(){null!=this.NoteHeads?this.NoteHeads.UpdateBeamingHelper(this.Container.X+this.X):null!=this.RestGlyph&&this.RestGlyph.UpdateBeamingHelper(this.Container.X+this.X)},DoLayout:function(){var sr=this.Renderer;if(!this.Container.Beat.IsEmpty)if(this.Container.Beat.get_IsRest()){var dotLine=0,line=0,offset=0;switch(this.Container.Beat.Duration){case AlphaTab.Model.Duration.QuadrupleWhole:line=6,dotLine=5;break;case AlphaTab.Model.Duration.DoubleWhole:line=6,dotLine=5;break;case AlphaTab.Model.Duration.Whole:line=4,dotLine=5;break;case AlphaTab.Model.Duration.Half:line=6,dotLine=5;break;case AlphaTab.Model.Duration.Quarter:line=6,offset=-2,dotLine=5;break;case AlphaTab.Model.Duration.Eighth:line=6,dotLine=5;break;case AlphaTab.Model.Duration.Sixteenth:line=6,dotLine=5;break;case AlphaTab.Model.Duration.ThirtySecond:line=6,dotLine=3;break;case AlphaTab.Model.Duration.SixtyFourth:line=6,dotLine=3;break;case AlphaTab.Model.Duration.OneHundredTwentyEighth:line=6,dotLine=3;break;case AlphaTab.Model.Duration.TwoHundredFiftySixth:line=6,dotLine=3}var y=sr.GetScoreY(line,offset);if(this.RestGlyph=new AlphaTab.Rendering.Glyphs.ScoreRestGlyph(0,y,this.Container.Beat.Duration),this.RestGlyph.Beat=this.Container.Beat,this.RestGlyph.BeamingHelper=this.BeamingHelper,this.AddGlyph(this.RestGlyph),this.Container.Beat.Dots>0){this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()));for(var i=0;i<this.Container.Beat.Dots;i++){var group=new AlphaTab.Rendering.Glyphs.GlyphGroup(0,0);this.CreateBeatDot(dotLine,group),this.AddGlyph(group)}}}else{this.NoteHeads=new AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph,this.NoteHeads.Beat=this.Container.Beat,this.NoteHeads.BeamingHelper=this.BeamingHelper;for(var $i42=0,$t42=this.Container.Beat.Notes,$l42=$t42.length,note=$t42[$i42];$l42>$i42;$i42++,note=$t42[$i42])this.CreateNoteGlyph(note);if(this.AddGlyph(this.NoteHeads),this.Container.Beat.Dots>0){this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()));for(var i=0;i<this.Container.Beat.Dots;i++){for(var group=new AlphaTab.Rendering.Glyphs.GlyphGroup(0,0),$i43=0,$t43=this.Container.Beat.Notes,$l43=$t43.length,note=$t43[$i43];$l43>$i43;$i43++,note=$t43[$i43])this.CreateBeatDot(sr.GetNoteLine(note),group);this.AddGlyph(group)}}}AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype.DoLayout.call(this)},CreateBeatDot:function(line,group){var sr=this.Renderer;group.AddGlyph(new AlphaTab.Rendering.Glyphs.CircleGlyph(0,sr.GetScoreY(line,0),1.5*this.get_Scale()))},CreateNoteHeadGlyph:function(n){var isGrace=this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None;if(n.Beat.Voice.Bar.Staff.Track.IsPercussion){var value=n.get_RealValue();return 30>=value||value>=67||AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys.hasOwnProperty(value)?new AlphaTab.Rendering.Glyphs.NoteHeadGlyph(0,0,AlphaTab.Model.Duration.Quarter,isGrace):AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys.hasOwnProperty(value)?new AlphaTab.Rendering.Glyphs.DrumSticksGlyph(0,0,isGrace):46==value?new AlphaTab.Rendering.Glyphs.HiHatGlyph(0,0,isGrace):49==value||57==value?new AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph(0,0,isGrace):52==value?new AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph(0,0,isGrace):51==value||53==value||59==value?new AlphaTab.Rendering.Glyphs.RideCymbalGlyph(0,0,isGrace):new AlphaTab.Rendering.Glyphs.NoteHeadGlyph(0,0,AlphaTab.Model.Duration.Quarter,isGrace)}return n.IsDead?new AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph(0,0,isGrace):n.HarmonicType==AlphaTab.Model.HarmonicType.None?new AlphaTab.Rendering.Glyphs.NoteHeadGlyph(0,0,n.Beat.Duration,isGrace):new AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph(0,0,isGrace)},CreateNoteGlyph:function(n){var sr=this.Renderer,noteHeadGlyph=this.CreateNoteHeadGlyph(n),line=sr.GetNoteLine(n);noteHeadGlyph.Y=sr.GetScoreY(line,0),this.NoteHeads.AddNoteGlyph(noteHeadGlyph,n,line),n.IsStaccato&&!this.NoteHeads.BeatEffects.hasOwnProperty("Staccato")&&(this.NoteHeads.BeatEffects.Staccato=new AlphaTab.Rendering.Glyphs.CircleGlyph(0,0,1.5)),n.Accentuated!=AlphaTab.Model.AccentuationType.Normal||this.NoteHeads.BeatEffects.hasOwnProperty("Accent")||(this.NoteHeads.BeatEffects.Accent=new AlphaTab.Rendering.Glyphs.AccentuationGlyph(0,0,AlphaTab.Model.AccentuationType.Normal)),n.Accentuated!=AlphaTab.Model.AccentuationType.Heavy||this.NoteHeads.BeatEffects.hasOwnProperty("HAccent")||(this.NoteHeads.BeatEffects.HAccent=new AlphaTab.Rendering.Glyphs.AccentuationGlyph(0,0,AlphaTab.Model.AccentuationType.Heavy))}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys=null,AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys=null,AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys={};for(var normalKeyNotes=new Int32Array([32,34,35,36,38,39,40,41,43,45,47,48,50,55,56,58,60,61]),i=0;i<normalKeyNotes.length;i++)AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys[normalKeyNotes[i]]=!0;AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys={};for(var xKeyNotes=new Int32Array([31,33,37,42,44,54,62,63,64,65,66]),i=0;i<xKeyNotes.length;i++)AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys[xKeyNotes[i]]=!0}),$Inherit(AlphaTab.Rendering.Glyphs.ScoreBeatGlyph,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase),AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph=function(){AlphaTab.Rendering.Glyphs.BeatGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph.prototype={DoLayout:function(){if(this.Container.Beat.BrushType!=AlphaTab.Model.BrushType.None&&(this.AddGlyph(new AlphaTab.Rendering.Glyphs.ScoreBrushGlyph(this.Container.Beat)),this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,4*this.get_Scale()))),!this.Container.Beat.get_IsRest()){for(var accidentals=new AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph,$i44=0,$t44=this.Container.Beat.Notes,$l44=$t44.length,note=$t44[$i44];$l44>$i44;$i44++,note=$t44[$i44])this.CreateAccidentalGlyph(note,accidentals);accidentals.get_IsEmpty()||(this.AddGlyph(accidentals),this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,4*(this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None?.75:1)*this.get_Scale())))}AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype.DoLayout.call(this)},CreateAccidentalGlyph:function(n,accidentals){var sr=this.Renderer,accidental=sr.AccidentalHelper.ApplyAccidental(n),noteLine=sr.GetNoteLine(n),isGrace=this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None;switch(accidental){case AlphaTab.Model.AccidentalType.Sharp:accidentals.AddGlyph(new AlphaTab.Rendering.Glyphs.SharpGlyph(0,sr.GetScoreY(noteLine,0),isGrace));break;case AlphaTab.Model.AccidentalType.Flat:accidentals.AddGlyph(new AlphaTab.Rendering.Glyphs.FlatGlyph(0,sr.GetScoreY(noteLine,0),isGrace));break;case AlphaTab.Model.AccidentalType.Natural:accidentals.AddGlyph(new AlphaTab.Rendering.Glyphs.NaturalizeGlyph(0,sr.GetScoreY(noteLine,0),isGrace))}}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph,AlphaTab.Rendering.Glyphs.BeatGlyphBase),AlphaTab.Rendering.Glyphs.ScoreBrushGlyph=function(beat){this._beat=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._beat=beat},AlphaTab.Rendering.Glyphs.ScoreBrushGlyph.prototype={DoLayout:function(){this.Width=10*this.get_Scale()},Paint:function(cx,cy,canvas){var scoreBarRenderer=this.Renderer,lineSize=scoreBarRenderer.get_LineOffset(),startY=cy+this.Y+(scoreBarRenderer.GetNoteY(this._beat.get_MaxNote())-lineSize/2),endY=cy+this.Y+scoreBarRenderer.GetNoteY(this._beat.get_MinNote())+lineSize,arrowX=cx+this.X+this.Width/2,arrowSize=8*this.get_Scale();this._beat.BrushType!=AlphaTab.Model.BrushType.None&&(this._beat.BrushType==AlphaTab.Model.BrushType.ArpeggioUp?(canvas.BeginPath(),canvas.MoveTo(arrowX,endY),canvas.LineTo(arrowX+arrowSize/2,endY-arrowSize),canvas.LineTo(arrowX-arrowSize/2,endY-arrowSize),canvas.ClosePath(),canvas.Fill()):this._beat.BrushType==AlphaTab.Model.BrushType.ArpeggioDown&&(canvas.BeginPath(),canvas.MoveTo(arrowX,startY),canvas.LineTo(arrowX+arrowSize/2,startY+arrowSize),canvas.LineTo(arrowX-arrowSize/2,startY+arrowSize),canvas.ClosePath(),canvas.Fill()))}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreBrushGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreNoteGlyphInfo=function(glyph,line){this.Glyph=null,this.Line=0,this.Glyph=glyph,this.Line=line},AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph=function(){this._infos=null,this._noteLookup=null,this._tremoloPicking=null,this._noteHeadPadding=0,this.MinNote=null,this.MaxNote=null,this.SpacingChanged=null,this.UpLineX=0,this.DownLineX=0,this.BeatEffects=null,this.Beat=null,this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._infos=[],this.BeatEffects={},this._noteLookup={}},AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph.prototype={get_Direction:function(){return this.BeamingHelper.Direction},GetNoteX:function(note,onEnd){if(this._noteLookup.hasOwnProperty(note.String)){var n=this._noteLookup[note.String],pos=this.X+n.X;return onEnd&&(pos+=n.Width),pos}return 0},GetNoteY:function(note){return this._noteLookup.hasOwnProperty(note.String)?this.Y+this._noteLookup[note.String].Y:0},AddNoteGlyph:function(noteGlyph,note,noteLine){var info=new AlphaTab.Rendering.Glyphs.ScoreNoteGlyphInfo(noteGlyph,noteLine);this._infos.push(info),this._noteLookup[note.String]=noteGlyph,(null==this.MinNote||this.MinNote.Line>info.Line)&&(this.MinNote=info),(null==this.MaxNote||this.MaxNote.Line<info.Line)&&(this.MaxNote=info)},UpdateBeamingHelper:function(cx){null!=this.BeamingHelper&&this.BeamingHelper.RegisterBeatLineX("score",this.Beat,cx+this.X+this.UpLineX,cx+this.X+this.DownLineX)},get_HasTopOverflow:function(){return null!=this.MinNote&&this.MinNote.Line<0},get_HasBottomOverflow:function(){return null!=this.MaxNote&&this.MaxNote.Line>8},DoLayout:function(){this._infos.sort($CreateAnonymousDelegate(this,function(a,b){return a.Line-b.Line}));for(var displacedX=0,lastDisplaced=!1,lastLine=0,anyDisplaced=!1,direction=this.get_Direction(),w=0,i=0,j=this._infos.length;j>i;i++){var g=this._infos[i].Glyph;g.Renderer=this.Renderer,g.DoLayout();var displace=!1;0==i?displacedX=g.Width+0:Math.abs(lastLine-this._infos[i].Line)<=1?lastDisplaced?lastDisplaced=!1:(displace=!0,g.X=displacedX-this.get_Scale(),anyDisplaced=!0,lastDisplaced=!0):lastDisplaced=!1,g.X=direction==AlphaTab.Rendering.Utils.BeamDirection.Down?displace?0:displacedX:displace?displacedX:0,lastLine=this._infos[i].Line,w=Math.max(w,g.X+g.Width)}anyDisplaced?(this._noteHeadPadding=0,this.UpLineX=displacedX,this.DownLineX=displacedX):(this._noteHeadPadding=direction==AlphaTab.Rendering.Utils.BeamDirection.Down?-displacedX:0,w+=this._noteHeadPadding,this.UpLineX=w,this.DownLineX=0);for(var effectKey in this.BeatEffects){var effect=this.BeatEffects[effectKey];effect.Renderer=this.Renderer,effect.DoLayout()}if(this.Beat.get_IsTremolo()){var offset,baseNote=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?this.MinNote:this.MaxNote,tremoloX=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?displacedX:0,speed=this.Beat.TremoloSpeed;switch(speed){case AlphaTab.Model.Duration.ThirtySecond:offset=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?-15:15;break;case AlphaTab.Model.Duration.Sixteenth:offset=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?-12:15;break;case AlphaTab.Model.Duration.Eighth:offset=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?-10:10;break;default:offset=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?-10:15}this._tremoloPicking=new AlphaTab.Rendering.Glyphs.TremoloPickingGlyph(tremoloX,baseNote.Glyph.Y+offset*this.get_Scale(),this.Beat.TremoloSpeed),this._tremoloPicking.Renderer=this.Renderer,this._tremoloPicking.DoLayout()}this.Width=w+0},Paint:function(cx,cy,canvas){cx+=this.X,cy+=this.Y;var scoreRenderer=this.Renderer,effectY=this.BeamingHelper.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?scoreRenderer.GetScoreY(this.MaxNote.Line,13.5):scoreRenderer.GetScoreY(this.MinNote.Line,-9),effectSpacing=this.BeamingHelper.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?7*this.get_Scale():-7*this.get_Scale();for(var effectKey in this.BeatEffects){var g=this.BeatEffects[effectKey];g.Y=effectY,g.X=this.Width/2,g.Paint(cx,cy,canvas),effectY+=effectSpacing}var linePadding=3*this.get_Scale(),lineWidth=this.Width+2*linePadding;if(this.get_HasTopOverflow()){var color=canvas.get_Color();canvas.set_Color(this.Renderer.ScoreRenderer.RenderingResources.StaveLineColor);for(var l=-1;l>=this.MinNote.Line;){var lY=cy+scoreRenderer.GetScoreY(l,0);canvas.FillRect(cx-linePadding,lY,lineWidth,this.get_Scale()),l-=2}canvas.set_Color(color)}if(this.get_HasBottomOverflow()){var color=canvas.get_Color();canvas.set_Color(this.Renderer.ScoreRenderer.RenderingResources.StaveLineColor);for(var l=12;l<=this.MaxNote.Line;){var lY=cy+scoreRenderer.GetScoreY(l,0);canvas.FillRect(cx-linePadding,lY,lineWidth,this.get_Scale()),l+=2}canvas.set_Color(color)}null!=this._tremoloPicking&&this._tremoloPicking.Paint(cx,cy,canvas);for(var infos=this._infos,x=cx+this._noteHeadPadding,$i45=0,$l45=infos.length,g=infos[$i45];$l45>$i45;$i45++,g=infos[$i45])g.Glyph.Renderer=this.Renderer,g.Glyph.Paint(x,cy,canvas)}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph=function(type,startNote,parent){this._startNote=null,this._type=AlphaTab.Model.SlideType.None,this._parent=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._type=type,this._startNote=startNote,this._parent=parent},AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(cx,cy,canvas){var r=this.Renderer;cx+=r.X,cy+=r.Y;var startX,startY,endX,endY,sizeX=12*this.get_Scale(),offsetX=1*this.get_Scale();switch(this._type){case AlphaTab.Model.SlideType.Shift:case AlphaTab.Model.SlideType.Legato:startX=cx+r.GetNoteX(this._startNote,!0)+offsetX,startY=cy+r.GetNoteY(this._startNote)+4.5,null!=this._startNote.SlideTarget?(endX=cx+r.GetNoteX(this._startNote.SlideTarget,!1)-offsetX,endY=cy+r.GetNoteY(this._startNote.SlideTarget)+4.5):(endX=cx+this._parent.X,endY=startY);break;case AlphaTab.Model.SlideType.IntoFromBelow:endX=cx+r.GetNoteX(this._startNote,!1)-offsetX,endY=cy+r.GetNoteY(this._startNote)+4.5,startX=endX-sizeX,startY=cy+r.GetNoteY(this._startNote)+9;break;case AlphaTab.Model.SlideType.IntoFromAbove:endX=cx+r.GetNoteX(this._startNote,!1)-offsetX,endY=cy+r.GetNoteY(this._startNote)+4.5,startX=endX-sizeX,startY=cy+r.GetNoteY(this._startNote);break;case AlphaTab.Model.SlideType.OutUp:startX=cx+r.GetNoteX(this._startNote,!0)+offsetX,startY=cy+r.GetNoteY(this._startNote)+4.5,endX=startX+sizeX,endY=cy+r.GetNoteY(this._startNote);break;case AlphaTab.Model.SlideType.OutDown:startX=cx+r.GetNoteX(this._startNote,!0)+offsetX,startY=cy+r.GetNoteY(this._startNote)+4.5,endX=startX+sizeX,endY=cy+r.GetNoteY(this._startNote)+9;break;default:return}canvas.BeginPath(),canvas.MoveTo(startX,startY),canvas.LineTo(endX,endY),canvas.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreTieGlyph=function(startNote,endNote,forEnd){this._startNote=null,this._endNote=null,AlphaTab.Rendering.Glyphs.TieGlyph.call(this,null==startNote?null:startNote.Beat,null==endNote?null:endNote.Beat,forEnd),this._startNote=startNote,this._endNote=endNote},AlphaTab.Rendering.Glyphs.ScoreTieGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.TieGlyph.prototype.DoLayout.call(this),this.YOffset=4.5},GetBeamDirection:function(beat,noteRenderer){switch(noteRenderer.GetBeatDirection(beat)){case AlphaTab.Rendering.Utils.BeamDirection.Up:return AlphaTab.Rendering.Utils.BeamDirection.Down;case AlphaTab.Rendering.Utils.BeamDirection.Down:default:return AlphaTab.Rendering.Utils.BeamDirection.Up}},GetStartY:function(noteRenderer){return noteRenderer.GetNoteY(this._startNote)},GetEndY:function(noteRenderer){return noteRenderer.GetNoteY(this._endNote)},GetStartX:function(noteRenderer){return noteRenderer.GetNoteX(this._startNote,!0)},GetEndX:function(noteRenderer){return noteRenderer.GetNoteX(this._endNote,!1)}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreTieGlyph,AlphaTab.Rendering.Glyphs.TieGlyph),AlphaTab.Rendering.Glyphs.SharpGlyph=function(x,y,isGrace){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,isGrace?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.AccidentalSharp),this._isGrace=isGrace},AlphaTab.Rendering.Glyphs.SharpGlyph.prototype={DoLayout:function(){this.Width=8*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.SharpGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.SpacingGlyph=function(x,y,width){AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),this.Width=width},$Inherit(AlphaTab.Rendering.Glyphs.SpacingGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph=function(beat,voiceContainer){this._bendGlyphs=null,AlphaTab.Rendering.Glyphs.BeatContainerGlyph.call(this,beat,voiceContainer)},AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.DoLayout.call(this),this._bendGlyphs=[];for(var i=0;i<this.Beat.Notes.length;i++){var n=this.Beat.Notes[i];if(n.get_HasBend()){var bendValueHeight=6,bendHeight=n.MaxBendPoint.Value*bendValueHeight;this.Renderer.RegisterOverflowTop(bendHeight);var bend=new AlphaTab.Rendering.Glyphs.BendGlyph(n,bendValueHeight);bend.X=this.OnNotes.X+this.OnNotes.Width,bend.Renderer=this.Renderer,this._bendGlyphs.push(bend)}}},ScaleToWidth:function(beatWidth){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.ScaleToWidth.call(this,beatWidth);for(var i=0;i<this._bendGlyphs.length;i++){var g=this._bendGlyphs[i];g.Width=beatWidth-g.X}},CreateTies:function(n){if(n.IsHammerPullOrigin){if(null==n.HammerPullOrigin){for(var destination=n.HammerPullDestination;null!=destination.HammerPullDestination;)destination=destination.HammerPullDestination;var tie=new AlphaTab.Rendering.Glyphs.TabTieGlyph(n,destination,!1,!1);this.Ties.push(tie)}}else if(n.get_IsHammerPullDestination()){if(null==n.HammerPullDestination){for(var origin=n.HammerPullOrigin;null!=origin.HammerPullOrigin;)origin=origin.HammerPullOrigin;var tie=new AlphaTab.Rendering.Glyphs.TabTieGlyph(origin,n,!1,!0);this.Ties.push(tie)}}else if(n.SlideType==AlphaTab.Model.SlideType.Legato){var tie=new AlphaTab.Rendering.Glyphs.TabTieGlyph(n,n.SlideTarget,!0,!1);this.Ties.push(tie)}if(n.SlideType!=AlphaTab.Model.SlideType.None){var l=new AlphaTab.Rendering.Glyphs.TabSlideLineGlyph(n.SlideType,n,this);this.Ties.push(l)}},Paint:function(cx,cy,canvas){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.Paint.call(this,cx,cy,canvas);for(var i=0;i<this._bendGlyphs.length;i++){var g=this._bendGlyphs[i];g.Paint(cx+this.X,cy+this.Y,canvas)}}},$Inherit(AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph,AlphaTab.Rendering.Glyphs.BeatContainerGlyph),AlphaTab.Rendering.Glyphs.TabBeatGlyph=function(){this.NoteNumbers=null,this.RestGlyph=null,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.TabBeatGlyph.prototype={DoLayout:function(){if(this.Container.Beat.get_IsRest())this.RestGlyph=new AlphaTab.Rendering.Glyphs.TabRestGlyph,this.RestGlyph.Beat=this.Container.Beat,this.RestGlyph.BeamingHelper=this.BeamingHelper,this.AddGlyph(this.RestGlyph);else{this.NoteNumbers=new AlphaTab.Rendering.Glyphs.TabNoteChordGlyph(0,0,this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None),this.NoteNumbers.Beat=this.Container.Beat,this.NoteNumbers.BeamingHelper=this.BeamingHelper;for(var $i46=0,$t46=this.Container.Beat.Notes,$l46=$t46.length,note=$t46[$i46];$l46>$i46;$i46++,note=$t46[$i46])this.CreateNoteGlyph(note);if(this.AddGlyph(this.NoteNumbers),this.Container.Beat.get_HasWhammyBar()&&!this.NoteNumbers.BeatEffects.hasOwnProperty("Whammy")){this.NoteNumbers.BeatEffects.Whammy=new AlphaTab.Rendering.Glyphs.WhammyBarGlyph(this.Container.Beat,this.Container);var whammyValueHeight=60*this.get_Scale()/24,whammyHeight=this.Container.Beat.MaxWhammyPoint.Value*whammyValueHeight;this.Renderer.RegisterOverflowTop(whammyHeight)}if(this.Container.Beat.get_IsTremolo()&&!this.NoteNumbers.BeatEffects.hasOwnProperty("Tremolo")){var offset=0,speed=this.Container.Beat.TremoloSpeed;switch(speed){case AlphaTab.Model.Duration.ThirtySecond:offset=10;break;case AlphaTab.Model.Duration.Sixteenth:offset=5;break;case AlphaTab.Model.Duration.Eighth:offset=0}this.NoteNumbers.BeatEffects.Tremolo=new AlphaTab.Rendering.Glyphs.TremoloPickingGlyph(5*this.get_Scale(),offset*this.get_Scale(),this.Container.Beat.TremoloSpeed)}}if(null!=this.Glyphs){for(var w=0,i=0,j=this.Glyphs.length;j>i;i++){var g=this.Glyphs[i];g.X=w,g.Renderer=this.Renderer,g.DoLayout(),w+=g.Width}this.Width=w}},UpdateBeamingHelper:function(){this.Container.Beat.get_IsRest()?this.RestGlyph.UpdateBeamingHelper(this.Container.X+this.X):this.NoteNumbers.UpdateBeamingHelper(this.Container.X+this.X)},CreateNoteGlyph:function(n){var tr=this.Renderer,noteNumberGlyph=new AlphaTab.Rendering.Glyphs.NoteNumberGlyph(0,0,n),l=n.Beat.Voice.Bar.Staff.Track.Tuning.length-n.String+1;noteNumberGlyph.Y=tr.GetTabY(l,-2),noteNumberGlyph.Renderer=this.Renderer,noteNumberGlyph.DoLayout(),this.NoteNumbers.AddNoteGlyph(noteNumberGlyph,n)}},$Inherit(AlphaTab.Rendering.Glyphs.TabBeatGlyph,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase),AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph=function(){AlphaTab.Rendering.Glyphs.BeatGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph.prototype={DoLayout:function(){this.Container.Beat.BrushType!=AlphaTab.Model.BrushType.None&&(this.AddGlyph(new AlphaTab.Rendering.Glyphs.TabBrushGlyph(this.Container.Beat)),this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,4*this.get_Scale()))),AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype.DoLayout.call(this)}},$Inherit(AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph,AlphaTab.Rendering.Glyphs.BeatGlyphBase),AlphaTab.Rendering.Glyphs.TabBrushGlyph=function(beat){this._beat=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._beat=beat},AlphaTab.Rendering.Glyphs.TabBrushGlyph.prototype={DoLayout:function(){this.Width=10*this.get_Scale()},Paint:function(cx,cy,canvas){var tabBarRenderer=this.Renderer,res=this.Renderer.get_Resources(),startY=cy+this.X+(tabBarRenderer.GetNoteY(this._beat.get_MaxNote())-res.TablatureFont.Size/2),endY=cy+this.Y+tabBarRenderer.GetNoteY(this._beat.get_MinNote())+res.TablatureFont.Size/2,arrowX=cx+this.X+this.Width/2|0,arrowSize=8*this.get_Scale();this._beat.BrushType!=AlphaTab.Model.BrushType.None&&((this._beat.BrushType==AlphaTab.Model.BrushType.BrushUp||this._beat.BrushType==AlphaTab.Model.BrushType.BrushDown)&&(canvas.BeginPath(),canvas.MoveTo(arrowX,startY),canvas.LineTo(arrowX,endY),canvas.Stroke()),this._beat.BrushType==AlphaTab.Model.BrushType.BrushUp||this._beat.BrushType==AlphaTab.Model.BrushType.ArpeggioUp?(canvas.BeginPath(),canvas.MoveTo(arrowX,endY),canvas.LineTo(arrowX+arrowSize/2,endY-arrowSize),canvas.LineTo(arrowX-arrowSize/2,endY-arrowSize),canvas.ClosePath(),canvas.Fill()):(canvas.BeginPath(),canvas.MoveTo(arrowX,startY),canvas.LineTo(arrowX+arrowSize/2,startY+arrowSize),canvas.LineTo(arrowX-arrowSize/2,startY+arrowSize),
canvas.ClosePath(),canvas.Fill()))}},$Inherit(AlphaTab.Rendering.Glyphs.TabBrushGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabClefGlyph=function(x,y){AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y)},AlphaTab.Rendering.Glyphs.TabClefGlyph.prototype={DoLayout:function(){this.Width=28*this.get_Scale()},Paint:function(cx,cy,canvas){var strings=this.Renderer.Bar.Staff.Track.Tuning.length,correction=strings*this.get_Scale()*.5,symbol=4>=strings?AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefTabSmall:AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefTab,scale=4>=strings?strings/4.5:strings/6.5;canvas.FillMusicFontSymbol(cx+this.X+5*this.get_Scale(),cy+this.Y-correction,scale*this.get_Scale(),symbol)}},$Inherit(AlphaTab.Rendering.Glyphs.TabClefGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabNoteChordGlyph=function(x,y,isGrace){this._notes=null,this._isGrace=!1,this.Beat=null,this.BeamingHelper=null,this.MinStringNote=null,this.BeatEffects=null,this.NotesPerString=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,x,y),this._isGrace=isGrace,this._notes=[],this.BeatEffects={},this.NotesPerString={}},AlphaTab.Rendering.Glyphs.TabNoteChordGlyph.prototype={GetNoteX:function(note,onEnd){if(this.NotesPerString.hasOwnProperty(note.String)){var n=this.NotesPerString[note.String],pos=this.X+n.X;return onEnd&&(pos+=n.Width),pos}return 0},GetNoteY:function(note){return this.NotesPerString.hasOwnProperty(note.String)?this.Y+this.NotesPerString[note.String].Y:0},DoLayout:function(){for(var w=0,i=0,j=this._notes.length;j>i;i++){var g=this._notes[i];g.Renderer=this.Renderer,g.DoLayout(),g.Width>w&&(w=g.Width)}var tabHeight=this.Renderer.get_Resources().TablatureFont.Size,effectY=this.GetNoteY(this.MinStringNote)+tabHeight/2,effectSpacing=7*this.get_Scale();for(var beatEffectKey in this.BeatEffects){var g=this.BeatEffects[beatEffectKey];g.Y+=effectY,g.X+=this.Width/2,g.Renderer=this.Renderer,effectY+=effectSpacing,g.DoLayout()}this.Width=w},AddNoteGlyph:function(noteGlyph,note){this._notes.push(noteGlyph),this.NotesPerString[note.String]=noteGlyph,(null==this.MinStringNote||note.String<this.MinStringNote.String)&&(this.MinStringNote=note)},Paint:function(cx,cy,canvas){cx+=this.X,cy+=this.Y;var res=this.Renderer.get_Resources(),oldBaseLine=canvas.get_TextBaseline();canvas.set_TextBaseline(AlphaTab.Platform.Model.TextBaseline.Middle),canvas.set_Font(this._isGrace?res.GraceFont:res.TablatureFont);for(var notes=this._notes,w=this.Width,$i47=0,$l47=notes.length,g=notes[$i47];$l47>$i47;$i47++,g=notes[$i47])g.Renderer=this.Renderer,g.Width=w,g.Paint(cx,cy,canvas);canvas.set_TextBaseline(oldBaseLine);for(var beatEffectKey in this.BeatEffects){var g=this.BeatEffects[beatEffectKey];g.Paint(cx,cy,canvas)}},UpdateBeamingHelper:function(cx){null!=this.BeamingHelper&&this.BeamingHelper.IsPositionFrom("tab",this.Beat)&&this.BeamingHelper.RegisterBeatLineX("tab",this.Beat,cx+this.X+this.Width,cx+this.X)}},$Inherit(AlphaTab.Rendering.Glyphs.TabNoteChordGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabRestGlyph=function(){this.Beat=null,this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.SpacingGlyph.call(this,0,0,0)},AlphaTab.Rendering.Glyphs.TabRestGlyph.prototype={DoLayout:function(){this.Width=10*this.get_Scale()},UpdateBeamingHelper:function(cx){null!=this.BeamingHelper&&this.BeamingHelper.IsPositionFrom("tab",this.Beat)&&this.BeamingHelper.RegisterBeatLineX("tab",this.Beat,cx+this.X+this.Width,cx+this.X)}},$Inherit(AlphaTab.Rendering.Glyphs.TabRestGlyph,AlphaTab.Rendering.Glyphs.SpacingGlyph),AlphaTab.Rendering.Glyphs.TabSlideLineGlyph=function(type,startNote,parent){this._startNote=null,this._type=AlphaTab.Model.SlideType.None,this._parent=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._type=type,this._startNote=startNote,this._parent=parent},AlphaTab.Rendering.Glyphs.TabSlideLineGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(cx,cy,canvas){var r=this.Renderer;cx+=r.X,cy+=r.Y;var startX,startY,endX,endY,sizeX=12*this.get_Scale(),sizeY=3*this.get_Scale();switch(this._type){case AlphaTab.Model.SlideType.Shift:case AlphaTab.Model.SlideType.Legato:var startOffsetY,endOffsetY;null==this._startNote.SlideTarget?(startOffsetY=0,endOffsetY=0):this._startNote.SlideTarget.Fret>this._startNote.Fret?(startOffsetY=sizeY,endOffsetY=-1*sizeY):(startOffsetY=-1*sizeY,endOffsetY=sizeY),startX=cx+r.GetNoteX(this._startNote,!0),startY=cy+r.GetNoteY(this._startNote)+startOffsetY,null!=this._startNote.SlideTarget?(endX=cx+r.GetNoteX(this._startNote.SlideTarget,!1),endY=cy+r.GetNoteY(this._startNote.SlideTarget)+endOffsetY):(endX=cx+this._parent.X,endY=startY);break;case AlphaTab.Model.SlideType.IntoFromBelow:endX=cx+r.GetNoteX(this._startNote,!1),endY=cy+r.GetNoteY(this._startNote),startX=endX-sizeX,startY=cy+r.GetNoteY(this._startNote)+sizeY;break;case AlphaTab.Model.SlideType.IntoFromAbove:endX=cx+r.GetNoteX(this._startNote,!1),endY=cy+r.GetNoteY(this._startNote),startX=endX-sizeX,startY=cy+r.GetNoteY(this._startNote)-sizeY;break;case AlphaTab.Model.SlideType.OutUp:startX=cx+r.GetNoteX(this._startNote,!0),startY=cy+r.GetNoteY(this._startNote),endX=startX+sizeX,endY=cy+r.GetNoteY(this._startNote)-sizeY;break;case AlphaTab.Model.SlideType.OutDown:startX=cx+r.GetNoteX(this._startNote,!0),startY=cy+r.GetNoteY(this._startNote),endX=startX+sizeX,endY=cy+r.GetNoteY(this._startNote)+sizeY;break;default:return}canvas.BeginPath(),canvas.MoveTo(startX,startY),canvas.LineTo(endX,endY),canvas.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.TabSlideLineGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabTieGlyph=function(startNote,endNote,forSlide,forEnd){this._startNote=null,this._endNote=null,this._forSlide=!1,AlphaTab.Rendering.Glyphs.TieGlyph.call(this,startNote.Beat,endNote.Beat,forEnd),this._startNote=startNote,this._endNote=endNote,this._forSlide=forSlide},AlphaTab.Rendering.Glyphs.TabTieGlyph.prototype={get_Offset:function(){return this._forSlide?5*this.get_Scale():0},GetBeamDirection:function(){return this._startNote.String>3?AlphaTab.Rendering.Utils.BeamDirection.Down:AlphaTab.Rendering.Utils.BeamDirection.Up},GetStartY:function(noteRenderer){return noteRenderer.GetNoteY(this._startNote)-this.get_Offset()},GetEndY:function(noteRenderer){return noteRenderer.GetNoteY(this._endNote)-this.get_Offset()},GetStartX:function(noteRenderer){return noteRenderer.GetNoteX(this._startNote,!0)},GetEndX:function(noteRenderer){return noteRenderer.GetNoteX(this._endNote,!1)}},$Inherit(AlphaTab.Rendering.Glyphs.TabTieGlyph,AlphaTab.Rendering.Glyphs.TieGlyph),AlphaTab.Rendering.Glyphs.TempoGlyph=function(x,y,tempo){this._tempo=0,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y),this._tempo=tempo},AlphaTab.Rendering.Glyphs.TempoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=25*this.get_Scale()},Paint:function(cx,cy,canvas){var res=this.Renderer.get_Resources();canvas.set_Font(res.MarkerFont),canvas.FillMusicFontSymbol(cx+this.X,cy+this.Y+.8*this.Height,.75,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo),canvas.FillText("= "+this._tempo,cx+this.X+this.Height/2,cy+this.Y+canvas.get_Font().Size/2)}},$Inherit(AlphaTab.Rendering.Glyphs.TempoGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TextGlyph=function(x,y,text,font,textAlign){this._text=null,this.Font=null,this.TextAlign=AlphaTab.Platform.Model.TextAlign.Left,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y),this._text=text,this.Font=font,this.TextAlign=textAlign},AlphaTab.Rendering.Glyphs.TextGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Font.Size},Paint:function(cx,cy,canvas){canvas.set_Font(this.Font);var old=canvas.get_TextAlign();canvas.set_TextAlign(this.TextAlign),canvas.FillText(this._text,cx+this.X,cy+this.Y),canvas.set_TextAlign(old)}},$Inherit(AlphaTab.Rendering.Glyphs.TextGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TimeSignatureGlyph=function(x,y,numerator,denominator,isCommon){this._numerator=0,this._denominator=0,this._isCommon=!1,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,x,y),this._numerator=numerator,this._denominator=denominator,this._isCommon=isCommon},AlphaTab.Rendering.Glyphs.TimeSignatureGlyph.prototype={DoLayout:function(){var renderer=this.Renderer;if(this._isCommon&&2==this._numerator&&2==this._denominator){var common=new AlphaTab.Rendering.Glyphs.MusicFontGlyph(0,renderer.GetScoreY(4,0),1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.TimeSignatureCutCommon);common.Width=14*this.get_Scale(),this.AddGlyph(common),AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.DoLayout.call(this)}else if(this._isCommon&&4==this._numerator&&4==this._denominator){var common=new AlphaTab.Rendering.Glyphs.MusicFontGlyph(0,renderer.GetScoreY(4,0),1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.TimeSignatureCommon);common.Width=14*this.get_Scale(),this.AddGlyph(common),AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.DoLayout.call(this)}else{var numerator=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,2*this.get_Scale(),this._numerator,1),denominator=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,20*this.get_Scale(),this._denominator,1);this.AddGlyph(numerator),this.AddGlyph(denominator),AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.DoLayout.call(this);for(var i=0,j=this.Glyphs.length;j>i;i++){var g=this.Glyphs[i];g.X=(this.Width-g.Width)/2}}}},$Inherit(AlphaTab.Rendering.Glyphs.TimeSignatureGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.TremoloPickingGlyph=function(x,y,duration){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,x,y,1,AlphaTab.Rendering.Glyphs.TremoloPickingGlyph.GetSymbol(duration))},AlphaTab.Rendering.Glyphs.TremoloPickingGlyph.prototype={DoLayout:function(){this.Width=12*this.get_Scale()}},AlphaTab.Rendering.Glyphs.TremoloPickingGlyph.GetSymbol=function(duration){switch(duration){case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.TremoloPickingThirtySecond;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.TremoloPickingSixteenth;case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.TremoloPickingEighth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.TremoloPickingGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.TrillGlyph=function(x,y){AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,x,y)},AlphaTab.Rendering.Glyphs.TrillGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=20*this.get_Scale()},Paint:function(cx,cy,canvas){var res=this.Renderer.get_Resources();canvas.set_Font(res.MarkerFont);var textw=canvas.MeasureText("tr");canvas.FillText("tr",cx+this.X,cy+this.Y+canvas.get_Font().Size/2);for(var startX=textw+3*this.get_Scale(),endX=this.Width-startX,waveScale=1.2,step=11*this.get_Scale()*waveScale,loops=Math.max(1,(endX-startX)/step),loopX=startX,loopY=cy+this.Y+this.Height,i=0;loops>i;i++)canvas.FillMusicFontSymbol(cx+this.X+loopX,loopY,waveScale,AlphaTab.Rendering.Glyphs.MusicFontSymbol.WaveHorizontal),loopX+=step}},$Inherit(AlphaTab.Rendering.Glyphs.TrillGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TripletFeelGlyph=function(tripletFeel){this._tripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,0,0),this._tripletFeel=tripletFeel},AlphaTab.Rendering.Glyphs.TripletFeelGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=25*this.get_Scale()},Paint:function(cx,cy,canvas){cx+=this.X,cy+=this.Y;var noteY=cy+.75*this.Height;canvas.set_Font(this.Renderer.get_Resources().EffectFont),canvas.FillText("(",cx,cy+.3*this.Height);var leftNoteX=cx+10*this.get_Scale(),rightNoteX=cx+40*this.get_Scale();switch(this._tripletFeel){case AlphaTab.Model.TripletFeel.NoTripletFeel:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(rightNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]);break;case AlphaTab.Model.TripletFeel.Triplet8th:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),canvas.FillMusicFontSymbol(rightNoteX,noteY,.4,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo),canvas.FillMusicFontSymbol(rightNoteX+12*this.get_Scale(),noteY,.4,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteEighth),this.RenderTriplet(rightNoteX,cy,canvas);break;case AlphaTab.Model.TripletFeel.Triplet16th:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(rightNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight]),this.RenderTriplet(rightNoteX,cy,canvas);break;case AlphaTab.Model.TripletFeel.Dotted8th:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(rightNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight]),canvas.FillCircle(rightNoteX+9*this.get_Scale(),noteY,this.get_Scale());break;case AlphaTab.Model.TripletFeel.Dotted16th:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(rightNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight]),canvas.FillCircle(rightNoteX+9*this.get_Scale(),noteY,this.get_Scale());break;case AlphaTab.Model.TripletFeel.Scottish8th:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(rightNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialLeft]),canvas.FillCircle(rightNoteX+12*this.get_Scale()+8*this.get_Scale(),noteY,this.get_Scale());break;case AlphaTab.Model.TripletFeel.Scottish16th:this.RenderBarNote(leftNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(rightNoteX,noteY,.4,canvas,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialLeft]),canvas.FillCircle(rightNoteX+12*this.get_Scale()+8*this.get_Scale(),noteY,this.get_Scale())}canvas.FillText("=",cx+30*this.get_Scale(),cy+5*this.get_Scale()),canvas.FillText(")",cx+65*this.get_Scale(),cy+.3*this.Height)},RenderBarNote:function(cx,noteY,noteScale,canvas,bars){canvas.FillMusicFontSymbol(cx,noteY,noteScale,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo);for(var partialBarWidth=6*this.get_Scale(),i=0;i<bars.length;i++)switch(bars[i]){case AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full:canvas.FillRect(cx+4*this.get_Scale(),noteY-12*this.get_Scale()+3*this.get_Scale()*i,12*this.get_Scale(),2*this.get_Scale());break;case AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialLeft:canvas.FillRect(cx+4*this.get_Scale(),noteY-12*this.get_Scale()+3*this.get_Scale()*i,partialBarWidth,2*this.get_Scale());break;case AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight:canvas.FillRect(cx+4*this.get_Scale()+partialBarWidth,noteY-12*this.get_Scale()+3*this.get_Scale()*i,partialBarWidth,2*this.get_Scale())}canvas.FillMusicFontSymbol(cx+12*this.get_Scale(),noteY,noteScale,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo)},RenderTriplet:function(cx,cy,canvas){cy+=2*this.get_Scale();var font=this.Renderer.get_Resources().EffectFont;canvas.set_Font(new AlphaTab.Platform.Model.Font(font.Family,.8*font.Size,font.Style));var rightX=cx+12*this.get_Scale()+3*this.get_Scale();canvas.BeginPath(),canvas.MoveTo(cx,cy+3*this.get_Scale()),canvas.LineTo(cx,cy),canvas.LineTo(cx+5*this.get_Scale(),cy),canvas.MoveTo(rightX+5*this.get_Scale(),cy+3*this.get_Scale()),canvas.LineTo(rightX+5*this.get_Scale(),cy),canvas.LineTo(rightX,cy),canvas.Stroke(),canvas.FillText("3",cx+7*this.get_Scale(),cy-10*this.get_Scale()),canvas.set_Font(font)}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.TripletFeelGlyph.NoteScale=.4,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.NoteHeight=12,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.NoteSeparation=12,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarHeight=2,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarSeparation=3}),$Inherit(AlphaTab.Rendering.Glyphs.TripletFeelGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TuningGlyph=function(x,y,scale,resources,tuning){this._scale=0,this._resources=null,this.Height=0,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,x,y),this._scale=scale,this._resources=resources,this.CreateGlyphs(tuning)},AlphaTab.Rendering.Glyphs.TuningGlyph.prototype={CreateGlyphs:function(tuning){if(this.AddGlyph(new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,tuning.Name,this._resources.EffectFont,AlphaTab.Platform.Model.TextAlign.Left)),this.Height+=15*this._scale,!tuning.IsStandard){for(var stringsPerColumn=0|Math.ceil(tuning.Tunings.length/2),currentX=0,currentY=this.Height,i=0,j=tuning.Tunings.length;j>i;i++){var str="("+(i+1)+") = "+AlphaTab.Model.Tuning.GetTextForTuning(tuning.Tunings[i],!1);this.AddGlyph(new AlphaTab.Rendering.Glyphs.TextGlyph(currentX,currentY,str,this._resources.EffectFont,AlphaTab.Platform.Model.TextAlign.Left)),currentY+=this.Height,i==stringsPerColumn-1&&(currentY=this.Height,currentX+=43*this._scale)}this.Height+=15*stringsPerColumn*this._scale}}},$Inherit(AlphaTab.Rendering.Glyphs.TuningGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.VibratoGlyph=function(x,y,scale){this._scale=0,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.call(this,AlphaTab.Rendering.BeatXPosition.EndBeat),this._scale=scale,this.X=x,this.Y=y},AlphaTab.Rendering.Glyphs.VibratoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=10*this.get_Scale()*this._scale},PaintGrouped:function(cx,cy,endX,canvas){for(var startX=cx+this.X,width=endX-startX,step=9*this.get_Scale()*this._scale,loops=0|Math.max(1,width/step),h=this.Height,loopX=0,i=0;loops>i;i++)canvas.FillMusicFontSymbol(cx+this.X+loopX,cy+this.Y+h,this._scale,AlphaTab.Rendering.Glyphs.MusicFontSymbol.WaveHorizontal),loopX+=step}},$Inherit(AlphaTab.Rendering.Glyphs.VibratoGlyph,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph),AlphaTab.Rendering.Glyphs.VoiceContainerGlyph=function(x,y,voice){this.BeatGlyphs=null,this.Voice=null,this.MinWidth=0,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,x,y),this.Voice=voice,this.BeatGlyphs=[]},AlphaTab.Rendering.Glyphs.VoiceContainerGlyph.prototype={ScaleToWidth:function(width){var force=this.Renderer.LayoutingInfo.SpaceToForce(width);this.ScaleToForce(force)},ScaleToForce:function(force){this.Width=this.Renderer.LayoutingInfo.CalculateVoiceWidth(force);for(var positions=this.Renderer.LayoutingInfo.BuildOnTimePositions(force),beatGlyphs=this.BeatGlyphs,i=0,j=beatGlyphs.length;j>i;i++){var currentBeatGlyph=beatGlyphs[i],time=currentBeatGlyph.Beat.get_AbsoluteStart();if(currentBeatGlyph.X=positions[time]-currentBeatGlyph.OnTimeX,i>0){var beatWidth=currentBeatGlyph.X-beatGlyphs[i-1].X;beatGlyphs[i-1].ScaleToWidth(beatWidth)}if(i==j-1){var beatWidth=this.Width-beatGlyphs[beatGlyphs.length-1].X;currentBeatGlyph.ScaleToWidth(beatWidth)}}},RegisterLayoutingInfo:function(info){info.UpdateVoiceSize(this.Width);for(var beatGlyphs=this.BeatGlyphs,$i48=0,$l48=beatGlyphs.length,b=beatGlyphs[$i48];$l48>$i48;$i48++,b=beatGlyphs[$i48])b.RegisterLayoutingInfo(info)},ApplyLayoutingInfo:function(info){for(var beatGlyphs=this.BeatGlyphs,$i49=0,$l49=beatGlyphs.length,b=beatGlyphs[$i49];$l49>$i49;$i49++,b=beatGlyphs[$i49])b.ApplyLayoutingInfo(info);this.ScaleToForce(Math.max(this.Renderer.get_Settings().StretchForce,info.MinStretchForce))},AddGlyph:function(g){g.X=0==this.BeatGlyphs.length?0:this.BeatGlyphs[this.BeatGlyphs.length-1].X+this.BeatGlyphs[this.BeatGlyphs.length-1].Width,g.Renderer=this.Renderer,g.DoLayout(),this.BeatGlyphs.push(g),this.Width=g.X+g.Width},DoLayout:function(){this.MinWidth=this.Width},Paint:function(cx,cy,canvas){canvas.set_Color(0==this.Voice.Index?this.Renderer.ScoreRenderer.RenderingResources.MainGlyphColor:this.Renderer.ScoreRenderer.RenderingResources.SecondaryGlyphColor);for(var i=0,j=this.BeatGlyphs.length;j>i;i++)this.BeatGlyphs[i].Paint(cx+this.X,cy+this.Y,canvas)}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.VoiceContainerGlyph.KeySizeBeat="Beat"}),$Inherit(AlphaTab.Rendering.Glyphs.VoiceContainerGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.WhammyBarGlyph=function(beat,parent){this._beat=null,this._parent=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._beat=beat,this._parent=parent},AlphaTab.Rendering.Glyphs.WhammyBarGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this);var minY=0,maxY=0,sizeY=60*this.get_Scale();if(this._beat.WhammyBarPoints.length>=2)for(var dy=sizeY/24,i=0,j=this._beat.WhammyBarPoints.length;j>i;i++){var pt=this._beat.WhammyBarPoints[i],ptY=0-dy*pt.Value;ptY>maxY&&(maxY=ptY),minY>ptY&&(minY=ptY)}var tabBarRenderer=this.Renderer,track=this.Renderer.Bar.Staff.Track,tabTop=tabBarRenderer.GetTabY(0,-2),tabBottom=tabBarRenderer.GetTabY(track.Tuning.length,-2),absMinY=minY+tabTop,absMaxY=maxY-tabBottom;0>absMinY&&tabBarRenderer.RegisterOverflowTop(Math.abs(absMinY)),absMaxY>0&&tabBarRenderer.RegisterOverflowBottom(Math.abs(absMaxY))},Paint:function(cx,cy,canvas){var tabBarRenderer=this.Renderer,res=this.Renderer.get_Resources(),startX=cx+this.X+this._parent.OnNotes.Width/2,endX=null==this._beat.NextBeat||this._beat.Voice!=this._beat.NextBeat.Voice?cx+this.X+this._parent.Width:cx+tabBarRenderer.GetBeatX(this._beat.NextBeat,AlphaTab.Rendering.BeatXPosition.PreNotes),startY=cy,sizeY=60*this.get_Scale(),old=canvas.get_TextAlign();if(canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center),this._beat.WhammyBarPoints.length>=2){var dx=(endX-startX)/60,dy=sizeY/24;canvas.BeginPath();for(var i=0,j=this._beat.WhammyBarPoints.length-1;j>i;i++){var pt1=this._beat.WhammyBarPoints[i],pt2=this._beat.WhammyBarPoints[i+1];if(pt1.Value!=pt2.Value||i!=this._beat.WhammyBarPoints.length-2){var pt1X=startX+dx*pt1.Offset,pt1Y=startY-dy*pt1.Value,pt2X=startX+dx*pt2.Offset,pt2Y=startY-dy*pt2.Value;if(canvas.MoveTo(pt1X,pt1Y),canvas.LineTo(pt2X,pt2Y),0!=pt2.Value){var dv=pt2.Value,s="";if(dv>=4||-4>=dv){var steps=dv/4|0;s+=steps,dv-=4*steps}if(dv>0&&(s+=AlphaTab.Rendering.Glyphs.BendGlyph.GetFractionSign(dv)),""!=s){canvas.set_Font(res.GraceFont);var sy=pt2Y;pt1Y>pt2Y?sy-=canvas.get_Font().Size:sy+=3*this.get_Scale();var sx=pt2X;canvas.FillText(s,sx,sy)}}}}canvas.Stroke()}canvas.set_TextAlign(old)}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.WhammyBarGlyph.WhammyMaxOffset=60}),$Inherit(AlphaTab.Rendering.Glyphs.WhammyBarGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.RenderFinishedEventArgs=function(){this.Width=0,this.Height=0,this.TotalWidth=0,this.TotalHeight=0,this.FirstMasterBarIndex=0,this.LastMasterBarIndex=0,this.RenderResult=null},AlphaTab.Rendering.Layout=AlphaTab.Rendering.Layout||{},AlphaTab.Rendering.Layout.HeaderFooterElements={None:0,Title:1,SubTitle:2,Artist:4,Album:8,Words:16,Music:32,WordsAndMusic:64,Copyright:128,PageNumber:256,All:511},AlphaTab.Rendering.Layout.HorizontalScreenLayoutPartialInfo=function(){this.Width=0,this.MasterBars=null,this.MasterBars=[]},AlphaTab.Rendering.Layout.ScoreLayout=function(renderer){this._barRendererLookup=null,this.ScoreInfoGlyphs=null,this.TuningGlyph=null,this.Renderer=null,this.Width=0,this.Height=0,this.Renderer=renderer,this._barRendererLookup={}},AlphaTab.Rendering.Layout.ScoreLayout.prototype={LayoutAndRender:function(){this.CreateScoreInfoGlyphs(),this.DoLayoutAndRender()},CreateScoreInfoGlyphs:function(){AlphaTab.Util.Logger.Info("ScoreLayout","Creating score info glyphs");var flags=this.Renderer.Settings.Layout.Get("hideInfo",!1)?AlphaTab.Rendering.Layout.HeaderFooterElements.None:AlphaTab.Rendering.Layout.HeaderFooterElements.All,score=this.Renderer.Score,res=this.Renderer.RenderingResources;if(this.ScoreInfoGlyphs={},null!=score.Title&&0!=score.Title.length&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.Title)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Title]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,score.Title,res.TitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=score.SubTitle&&0!=score.SubTitle.length&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.SubTitle)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.SubTitle]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,score.SubTitle,res.SubTitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=score.Artist&&0!=score.Artist.length&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.Artist)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Artist]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,score.Artist,res.SubTitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=score.Album&&0!=score.Album.length&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.Album)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Album]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,score.Album,res.SubTitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=score.Music&&0!=score.Music.length&&score.Music==score.Words&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.WordsAndMusic)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None?this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.WordsAndMusic]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Music and Words by "+score.Words,res.WordsFont,AlphaTab.Platform.Model.TextAlign.Center):(null!=score.Music&&0!=score.Music.length&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.Music)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Music]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Music by "+score.Music,res.WordsFont,AlphaTab.Platform.Model.TextAlign.Right)),null!=score.Words&&0!=score.Words.length&&(flags&AlphaTab.Rendering.Layout.HeaderFooterElements.Words)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Words]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Words by "+score.Music,res.WordsFont,AlphaTab.Platform.Model.TextAlign.Left))),1==this.Renderer.Tracks.length&&!this.Renderer.Tracks[0].IsPercussion){var tuning=AlphaTab.Model.Tuning.FindTuning(this.Renderer.Tracks[0].Tuning);null!=tuning&&(this.TuningGlyph=new AlphaTab.Rendering.Glyphs.TuningGlyph(0,0,this.get_Scale(),this.Renderer.RenderingResources,tuning))}},get_Scale:function(){return this.Renderer.Settings.Scale},CreateEmptyStaveGroup:function(){var group=new AlphaTab.Rendering.Staves.StaveGroup;group.Layout=this;for(var profile=AlphaTab.Environment.StaveProfiles.hasOwnProperty(this.Renderer.Settings.Staves.Id)?AlphaTab.Environment.StaveProfiles[this.Renderer.Settings.Staves.Id]:AlphaTab.Environment.StaveProfiles["default"],isFirstTrack=!0,trackIndex=0;trackIndex<this.Renderer.Tracks.length;trackIndex++){for(var track=this.Renderer.Tracks[trackIndex],staveIndex=0;staveIndex<track.Staves.length;staveIndex++)for(var renderStaveIndex=0;renderStaveIndex<profile.length;renderStaveIndex++){var factory=profile[renderStaveIndex],staff=track.Staves[staveIndex];factory.CanCreate(track,staff)&&group.AddStaff(track,new AlphaTab.Rendering.Staves.Staff(trackIndex,staff,factory,this.Renderer.Settings.Staves.AdditionalSettings))}isFirstTrack=!1}return group},RegisterBarRenderer:function(key,renderer){this._barRendererLookup.hasOwnProperty(key)||(this._barRendererLookup[key]={}),this._barRendererLookup[key][renderer.Bar.Id]=renderer},UnregisterBarRenderer:function(key,renderer){if(this._barRendererLookup.hasOwnProperty(key)){var lookup=this._barRendererLookup[key];delete lookup[renderer.Bar.Id]}},GetRendererForBar:function(key,bar){var barRendererId=bar.Id;return this._barRendererLookup.hasOwnProperty(key)&&this._barRendererLookup[key].hasOwnProperty(barRendererId)?this._barRendererLookup[key][barRendererId]:null},RenderAnnotation:function(){var msg="Rendered using alphaTab (http://www.alphaTab.net)",canvas=this.Renderer.Canvas,resources=this.Renderer.RenderingResources,height=2*resources.CopyrightFont.Size;this.Height+=height;var x=this.Width/2;canvas.BeginRender(this.Width,height),canvas.set_Color(resources.MainGlyphColor),canvas.set_Font(resources.CopyrightFont),canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center),canvas.FillText(msg,x,resources.CopyrightFont.Size);var result=canvas.EndRender();this.Renderer.OnPartialRenderFinished(function(){var $v3=new AlphaTab.Rendering.RenderFinishedEventArgs;return $v3.Width=this.Width,$v3.Height=height,$v3.RenderResult=result,$v3.TotalWidth=this.Width,$v3.TotalHeight=this.Height,$v3.FirstMasterBarIndex=-1,$v3.LastMasterBarIndex=-1,$v3}.call(this))}},AlphaTab.Rendering.Layout.HorizontalScreenLayout=function(renderer){this._group=null,AlphaTab.Rendering.Layout.ScoreLayout.call(this,renderer)},AlphaTab.Rendering.Layout.HorizontalScreenLayout.prototype={get_Name:function(){return"HorizontalScreen"},get_SupportsResize:function(){return!1},Resize:function(){},DoLayoutAndRender:function(){var score=this.Renderer.Score,canvas=this.Renderer.Canvas,startIndex=this.Renderer.Settings.Layout.Get("start",1);startIndex--,startIndex=Math.min(score.MasterBars.length-1,Math.max(0,startIndex));var currentBarIndex=startIndex,endBarIndex=this.Renderer.Settings.Layout.Get("count",score.MasterBars.length);0>endBarIndex&&(endBarIndex=score.MasterBars.length),endBarIndex=startIndex+endBarIndex-1,endBarIndex=Math.min(score.MasterBars.length-1,Math.max(0,endBarIndex)),this._group=this.CreateEmptyStaveGroup(),this._group.IsLast=!0,this._group.X=AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[0],this._group.Y=AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[1];for(var countPerPartial=this.Renderer.Settings.Layout.Get("countPerPartial",10),partials=[],currentPartial=new AlphaTab.Rendering.Layout.HorizontalScreenLayoutPartialInfo;endBarIndex>=currentBarIndex;){var result=this._group.AddBars(this.Renderer.Tracks,currentBarIndex);if(0==currentPartial.MasterBars.length&&result.IsLinkedToPrevious&&partials.length>0){var previousPartial=partials[partials.length-1];previousPartial.MasterBars.push(score.MasterBars[currentBarIndex]),previousPartial.Width+=result.Width}else currentPartial.MasterBars.push(score.MasterBars[currentBarIndex]),currentPartial.Width+=result.Width,currentPartial.MasterBars.length>=countPerPartial&&(0==partials.length&&(currentPartial.Width+=this._group.X+this._group.AccoladeSpacing),partials.push(currentPartial),AlphaTab.Util.Logger.Info(this.get_Name(),"Finished partial from bar "+currentPartial.MasterBars[0].Index+" to "+currentPartial.MasterBars[currentPartial.MasterBars.length-1].Index),currentPartial=new AlphaTab.Rendering.Layout.HorizontalScreenLayoutPartialInfo);currentBarIndex++}currentPartial.MasterBars.length>0&&(0==partials.length&&(currentPartial.Width+=this._group.X+this._group.AccoladeSpacing),
partials.push(currentPartial),AlphaTab.Util.Logger.Info(this.get_Name(),"Finished partial from bar "+currentPartial.MasterBars[0].Index+" to "+currentPartial.MasterBars[currentPartial.MasterBars.length-1].Index)),this._group.FinalizeGroup(),this.Height=this._group.Y+this._group.get_Height()+AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[3],this.Width=this._group.X+this._group.Width+AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[2],currentBarIndex=0;for(var i=0;i<partials.length;i++){var partial=partials[i];canvas.BeginRender(partial.Width,this.Height),canvas.set_Color(this.Renderer.RenderingResources.MainGlyphColor),canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left);var renderX=this._group.GetBarX(partial.MasterBars[0].Index)+this._group.AccoladeSpacing;0==i&&(renderX-=this._group.X+this._group.AccoladeSpacing),AlphaTab.Util.Logger.Info(this.get_Name(),"Rendering partial from bar "+partial.MasterBars[0].Index+" to "+partial.MasterBars[partial.MasterBars.length-1].Index),this._group.PaintPartial(-renderX,this._group.Y,this.Renderer.Canvas,currentBarIndex,partial.MasterBars.length);var result=canvas.EndRender();this.Renderer.OnPartialRenderFinished(function(){var $v4=new AlphaTab.Rendering.RenderFinishedEventArgs;return $v4.TotalWidth=this.Width,$v4.TotalHeight=this.Height,$v4.Width=partial.Width,$v4.Height=this.Height,$v4.RenderResult=result,$v4.FirstMasterBarIndex=partial.MasterBars[0].Index,$v4.LastMasterBarIndex=partial.MasterBars[partial.MasterBars.length-1].Index,$v4}.call(this)),currentBarIndex+=partial.MasterBars.length}}},$StaticConstructor(function(){AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding=new Float32Array([20,20,20,20]),AlphaTab.Rendering.Layout.HorizontalScreenLayout.GroupSpacing=20}),$Inherit(AlphaTab.Rendering.Layout.HorizontalScreenLayout,AlphaTab.Rendering.Layout.ScoreLayout),AlphaTab.Rendering.Layout.PageViewLayout=function(renderer){this._groups=null,this._allMasterBarRenderers=null,this._barsFromPreviousGroup=null,AlphaTab.Rendering.Layout.ScoreLayout.call(this,renderer)},AlphaTab.Rendering.Layout.PageViewLayout.prototype={get_Name:function(){return"PageView"},DoLayoutAndRender:function(){var x=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[0],y=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[1];this.Width=this.Renderer.Settings.Width,this._allMasterBarRenderers=[],y=this.LayoutAndRenderScoreInfo(x,y,-1),y=this.LayoutAndRenderScore(x,y),this.Height=y+AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[3]},get_SupportsResize:function(){return!0},Resize:function(){var x=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[0],y=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[1];this.Width=this.Renderer.Settings.Width;var oldHeight=this.Height;y=this.LayoutAndRenderScoreInfo(x,y,oldHeight),y=this.ResizeAndRenderScore(x,y,oldHeight),this.Height=y+AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[3]},LayoutAndRenderScoreInfo:function(x,y,totalHeight){AlphaTab.Util.Logger.Info(this.get_Name(),"Layouting score info");for(var scale=this.get_Scale(),res=this.Renderer.RenderingResources,centeredGlyphs=[AlphaTab.Rendering.Layout.HeaderFooterElements.Title,AlphaTab.Rendering.Layout.HeaderFooterElements.SubTitle,AlphaTab.Rendering.Layout.HeaderFooterElements.Artist,AlphaTab.Rendering.Layout.HeaderFooterElements.Album,AlphaTab.Rendering.Layout.HeaderFooterElements.WordsAndMusic],i=0;i<centeredGlyphs.length;i++)if(this.ScoreInfoGlyphs.hasOwnProperty(centeredGlyphs[i])){var glyph=this.ScoreInfoGlyphs[centeredGlyphs[i]];glyph.X=this.Width/2,glyph.Y=y,glyph.TextAlign=AlphaTab.Platform.Model.TextAlign.Center,y+=glyph.Font.Size}var musicOrWords=!1,musicOrWordsHeight=0;if(this.ScoreInfoGlyphs.hasOwnProperty(AlphaTab.Rendering.Layout.HeaderFooterElements.Music)){var glyph=this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Music];glyph.X=this.Width-AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[2],glyph.Y=y,glyph.TextAlign=AlphaTab.Platform.Model.TextAlign.Right,musicOrWords=!0,musicOrWordsHeight=glyph.Font.Size}if(this.ScoreInfoGlyphs.hasOwnProperty(AlphaTab.Rendering.Layout.HeaderFooterElements.Words)){var glyph=this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Words];glyph.X=x,glyph.Y=y,glyph.TextAlign=AlphaTab.Platform.Model.TextAlign.Left,musicOrWords=!0,musicOrWordsHeight=glyph.Font.Size}musicOrWords&&(y+=musicOrWordsHeight),null!=this.TuningGlyph&&(y+=20*scale,this.TuningGlyph.X=x,this.TuningGlyph.Y=y,y+=this.TuningGlyph.Height),y+=20*scale;var canvas=this.Renderer.Canvas;canvas.BeginRender(this.Width,y),canvas.set_Color(res.ScoreInfoColor),canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center);for(var key in this.ScoreInfoGlyphs)this.ScoreInfoGlyphs[key].Paint(0,0,canvas);null!=this.TuningGlyph&&this.TuningGlyph.Paint(0,0,canvas);var result=canvas.EndRender();return this.Renderer.OnPartialRenderFinished(function(){var $v5=new AlphaTab.Rendering.RenderFinishedEventArgs;return $v5.Width=this.Width,$v5.Height=y,$v5.RenderResult=result,$v5.TotalWidth=this.Width,$v5.TotalHeight=0>totalHeight?y:totalHeight,$v5.FirstMasterBarIndex=-1,$v5.LastMasterBarIndex=-1,$v5}.call(this)),y},ResizeAndRenderScore:function(x,y,oldHeight){var canvas=this.Renderer.Canvas;if(-1!=this.Renderer.Settings.Layout.Get("barsPerRow",-1))for(var i=0;i<this._groups.length;i++){var group=this._groups[i];this.FitGroup(group),group.FinalizeGroup(),y+=this.PaintGroup(group,oldHeight,canvas)}else{this._groups=[];var currentIndex=0,maxWidth=this.get_MaxWidth(),group=this.CreateEmptyStaveGroup();for(group.Index=this._groups.length,group.X=x,group.Y=y;currentIndex<this._allMasterBarRenderers.length;){var renderers=this._allMasterBarRenderers[currentIndex];group.Width+renderers.Width<=maxWidth||0==group.MasterBarsRenderers.length?(group.AddMasterBarRenderers(this.Renderer.Tracks,renderers),currentIndex++):(group.IsFull=!0,group.IsLast=!1,this._groups.push(group),this.FitGroup(group),group.FinalizeGroup(),y+=this.PaintGroup(group,oldHeight,canvas),group=this.CreateEmptyStaveGroup(),group.Index=this._groups.length,group.X=x,group.Y=y)}this.FitGroup(group),group.FinalizeGroup(),y+=this.PaintGroup(group,oldHeight,canvas)}return y},LayoutAndRenderScore:function(x,y){var score=this.Renderer.Score,canvas=this.Renderer.Canvas,startIndex=this.Renderer.Settings.Layout.Get("start",1);startIndex--,startIndex=Math.min(score.MasterBars.length-1,Math.max(0,startIndex));var currentBarIndex=startIndex,endBarIndex=this.Renderer.Settings.Layout.Get("count",score.MasterBars.length);for(0>endBarIndex&&(endBarIndex=score.MasterBars.length),endBarIndex=startIndex+endBarIndex-1,endBarIndex=Math.min(score.MasterBars.length-1,Math.max(0,endBarIndex)),this._groups=[];endBarIndex>=currentBarIndex;){var group=this.CreateStaveGroup(currentBarIndex,endBarIndex);this._groups.push(group),group.X=x,group.Y=y,currentBarIndex=group.get_LastBarIndex()+1,this.FitGroup(group),group.FinalizeGroup(),AlphaTab.Util.Logger.Info(this.get_Name(),"Rendering partial from bar "+group.get_FirstBarIndex()+" to "+group.get_LastBarIndex()),y+=this.PaintGroup(group,y,canvas)}return y},PaintGroup:function(group,totalHeight,canvas){var height=group.get_Height()+20*this.get_Scale();canvas.BeginRender(this.Width,height),this.Renderer.Canvas.set_Color(this.Renderer.RenderingResources.MainGlyphColor),this.Renderer.Canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left),group.Paint(0,-group.Y,canvas),totalHeight+=height;var result=canvas.EndRender(),args=new AlphaTab.Rendering.RenderFinishedEventArgs;return args.TotalWidth=this.Width,args.TotalHeight=totalHeight,args.Width=this.Width,args.Height=height,args.RenderResult=result,args.FirstMasterBarIndex=group.get_FirstBarIndex(),args.LastMasterBarIndex=group.get_LastBarIndex(),this.Renderer.OnPartialRenderFinished(args),height},FitGroup:function(group){(group.IsFull||group.Width>this.get_MaxWidth())&&group.ScaleToWidth(this.get_MaxWidth()),this.Width=Math.max(this.Width,group.Width)},CreateStaveGroup:function(currentBarIndex,endIndex){var group=this.CreateEmptyStaveGroup();group.Index=this._groups.length;for(var barsPerRow=this.Renderer.Settings.Layout.Get("barsPerRow",-1),maxWidth=this.get_MaxWidth(),end=endIndex+1,i=currentBarIndex;end>i;i++){var renderers;null!=this._barsFromPreviousGroup&&this._barsFromPreviousGroup.MasterBar.Index==i?renderers=group.AddMasterBarRenderers(this.Renderer.Tracks,this._barsFromPreviousGroup):(renderers=group.AddBars(this.Renderer.Tracks,i),this._allMasterBarRenderers.push(renderers)),this._barsFromPreviousGroup=null;var groupIsFull=!1;if(-1==barsPerRow&&group.Width>=maxWidth&&0!=group.MasterBarsRenderers.length?groupIsFull=!0:group.MasterBarsRenderers.length==barsPerRow+1&&(groupIsFull=!0),groupIsFull)return group.RevertLastBar(),group.IsFull=!0,group.IsLast=!1,this._barsFromPreviousGroup=renderers,group;group.X=0}return group.IsLast=endIndex==group.get_LastBarIndex(),group},get_MaxWidth:function(){return this.Renderer.Settings.Width-AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[0]-AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[2]}},$StaticConstructor(function(){AlphaTab.Rendering.Layout.PageViewLayout.PagePadding=new Float32Array([40,40,40,40]),AlphaTab.Rendering.Layout.PageViewLayout.GroupSpacing=20}),$Inherit(AlphaTab.Rendering.Layout.PageViewLayout,AlphaTab.Rendering.Layout.ScoreLayout),AlphaTab.Rendering.RenderingResources=function(scale){this.CopyrightFont=null,this.TitleFont=null,this.SubTitleFont=null,this.WordsFont=null,this.EffectFont=null,this.TablatureFont=null,this.GraceFont=null,this.StaveLineColor=null,this.BarSeperatorColor=null,this.BarNumberFont=null,this.BarNumberColor=null,this.MarkerFont=null,this.TabClefFont=null,this.MainGlyphColor=null,this.SecondaryGlyphColor=null,this.Scale=0,this.ScoreInfoColor=null,this.Init(scale)},AlphaTab.Rendering.RenderingResources.prototype={Init:function(scale){this.Scale=scale;var sansFont="Arial",serifFont="Georgia";this.EffectFont=new AlphaTab.Platform.Model.Font(serifFont,12*scale,AlphaTab.Platform.Model.FontStyle.Italic),this.CopyrightFont=new AlphaTab.Platform.Model.Font(sansFont,12*scale,AlphaTab.Platform.Model.FontStyle.Bold),this.TitleFont=new AlphaTab.Platform.Model.Font(serifFont,32*scale,AlphaTab.Platform.Model.FontStyle.Plain),this.SubTitleFont=new AlphaTab.Platform.Model.Font(serifFont,20*scale,AlphaTab.Platform.Model.FontStyle.Plain),this.WordsFont=new AlphaTab.Platform.Model.Font(serifFont,15*scale,AlphaTab.Platform.Model.FontStyle.Plain),this.TablatureFont=new AlphaTab.Platform.Model.Font(sansFont,13*scale,AlphaTab.Platform.Model.FontStyle.Plain),this.GraceFont=new AlphaTab.Platform.Model.Font(sansFont,11*scale,AlphaTab.Platform.Model.FontStyle.Plain),this.StaveLineColor=new AlphaTab.Platform.Model.Color(0,0,0,255),this.BarSeperatorColor=new AlphaTab.Platform.Model.Color(34,34,17,255),this.BarNumberFont=new AlphaTab.Platform.Model.Font(sansFont,11*scale,AlphaTab.Platform.Model.FontStyle.Plain),this.BarNumberColor=new AlphaTab.Platform.Model.Color(200,0,0,255),this.MarkerFont=new AlphaTab.Platform.Model.Font(serifFont,14*scale,AlphaTab.Platform.Model.FontStyle.Bold),this.TabClefFont=new AlphaTab.Platform.Model.Font(sansFont,18*scale,AlphaTab.Platform.Model.FontStyle.Bold),this.ScoreInfoColor=new AlphaTab.Platform.Model.Color(0,0,0,255),this.MainGlyphColor=new AlphaTab.Platform.Model.Color(0,0,0,255),this.SecondaryGlyphColor=new AlphaTab.Platform.Model.Color(0,0,0,100)}},AlphaTab.Rendering.ScoreBarRenderer=function(renderer,bar){this._startSpacing=!1,this.AccidentalHelper=null,AlphaTab.Rendering.BarRendererBase.call(this,renderer,bar),this.AccidentalHelper=new AlphaTab.Rendering.Utils.AccidentalHelper},AlphaTab.Rendering.ScoreBarRenderer.prototype={GetBeatDirection:function(beat){var g=this.GetOnNotesGlyphForBeat(beat);return null!=g?g.NoteHeads.get_Direction():AlphaTab.Rendering.Utils.BeamDirection.Up},GetNoteX:function(note,onEnd){var g=this.GetOnNotesGlyphForBeat(note.Beat);if(null!=g){var x=g.Container.VoiceContainer.X+g.Container.X+g.X;return onEnd&&(x+=g.Width),x}return 0},GetNoteY:function(note){var beat=this.GetOnNotesGlyphForBeat(note.Beat);return null!=beat?beat.NoteHeads.GetNoteY(note):0},get_LineOffset:function(){return 9*this.get_Scale()},UpdateSizes:function(){var res=this.get_Resources(),glyphOverflow=res.TablatureFont.Size/2+.2*res.TablatureFont.Size;this.TopPadding=glyphOverflow,this.BottomPadding=glyphOverflow,this.Height=4*this.get_LineOffset()+this.TopPadding+this.BottomPadding,AlphaTab.Rendering.BarRendererBase.prototype.UpdateSizes.call(this)},DoLayout:function(){AlphaTab.Rendering.BarRendererBase.prototype.DoLayout.call(this);for(var top=this.GetScoreY(0,0),bottom=this.GetScoreY(8,0),i=0,j=this.Helpers.BeamHelpers.length;j>i;i++)for(var v=this.Helpers.BeamHelpers[i],k=0,l=v.length;l>k;k++){var h=v[k],maxNoteY=this.GetScoreY(this.GetNoteLine(h.MaxNote),0);h.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up&&(maxNoteY-=this.GetStemSize(h),maxNoteY-=h.FingeringCount*this.get_Resources().GraceFont.Size,h.HasTuplet&&(maxNoteY-=2*this.get_Resources().EffectFont.Size)),h.HasTuplet&&(maxNoteY-=1.5*this.get_Resources().EffectFont.Size),top>maxNoteY&&this.RegisterOverflowTop(Math.abs(maxNoteY));var minNoteY=this.GetScoreY(this.GetNoteLine(h.MinNote),0);h.Direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&(minNoteY+=this.GetStemSize(h),minNoteY+=h.FingeringCount*this.get_Resources().GraceFont.Size),minNoteY>bottom&&this.RegisterOverflowBottom(Math.abs(minNoteY)-bottom)}},Paint:function(cx,cy,canvas){AlphaTab.Rendering.BarRendererBase.prototype.Paint.call(this,cx,cy,canvas),this.PaintBeams(cx,cy,canvas),this.PaintTuplets(cx,cy,canvas)},PaintTuplets:function(cx,cy,canvas){for(var i=0,j=this.Helpers.TupletHelpers.length;j>i;i++)for(var v=this.Helpers.TupletHelpers[i],k=0,l=v.length;l>k;k++){var h=v[k];this.PaintTupletHelper(cx+this.get_BeatGlyphsStart(),cy,canvas,h)}},PaintBeams:function(cx,cy,canvas){for(var i=0,j=this.Helpers.BeamHelpers.length;j>i;i++)for(var v=this.Helpers.BeamHelpers[i],k=0,l=v.length;l>k;k++){var h=v[k];this.PaintBeamHelper(cx+this.get_BeatGlyphsStart(),cy,canvas,h)}},PaintBeamHelper:function(cx,cy,canvas,h){canvas.set_Color(0==h.Voice.Index?this.get_Resources().MainGlyphColor:this.get_Resources().SecondaryGlyphColor),1==h.Beats.length?this.PaintFooter(cx,cy,canvas,h):this.PaintBar(cx,cy,canvas,h)},PaintTupletHelper:function(cx,cy,canvas,h){var res=this.get_Resources(),oldAlign=canvas.get_TextAlign();if(canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center),1!=h.Beats.length&&h.get_IsFull()){var firstBeat=h.Beats[0],lastBeat=h.Beats[h.Beats.length-1],firstBeamingHelper=this.Helpers.BeamHelperLookup[h.VoiceIndex][firstBeat.Index],lastBeamingHelper=this.Helpers.BeamHelperLookup[h.VoiceIndex][lastBeat.Index];if(null!=firstBeamingHelper&&null!=lastBeamingHelper){var direction=firstBeamingHelper.Direction,startX=firstBeamingHelper.GetBeatLineX(firstBeat)+this.get_Scale(),endX=lastBeamingHelper.GetBeatLineX(lastBeat)+this.get_Scale();canvas.set_Font(res.EffectFont);var s=h.Tuplet.toString(),sw=canvas.MeasureText(s),sp=3*this.get_Scale(),middleX=(startX+endX)/2,offset1X=middleX-sw/2-sp,offset2X=middleX+sw/2+sp,startY=this.CalculateBeamYWithDirection(firstBeamingHelper,startX,firstBeamingHelper.Direction),endY=this.CalculateBeamYWithDirection(lastBeamingHelper,endX,firstBeamingHelper.Direction),k=(endY-startY)/(endX-startX),d=startY-k*startX,offset1Y=k*offset1X+d,middleY=k*middleX+d,offset2Y=k*offset2X+d,offset=10*this.get_Scale(),size=5*this.get_Scale();direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&(offset*=-1,size*=-1),canvas.BeginPath(),canvas.MoveTo(cx+this.X+startX,cy+this.Y+startY-offset|0),canvas.LineTo(cx+this.X+startX,cy+this.Y+startY-offset-size|0),canvas.LineTo(cx+this.X+offset1X,cy+this.Y+offset1Y-offset-size|0),canvas.Stroke(),canvas.BeginPath(),canvas.MoveTo(cx+this.X+offset2X,cy+this.Y+offset2Y-offset-size|0),canvas.LineTo(cx+this.X+endX,cy+this.Y+endY-offset-size|0),canvas.LineTo(cx+this.X+endX,cy+this.Y+endY-offset|0),canvas.Stroke(),canvas.FillText(s,cx+this.X+middleX,cy+this.Y+middleY-offset-size-res.EffectFont.Size)}}else for(var i=0,j=h.Beats.length;j>i;i++){var beat=h.Beats[i],beamingHelper=this.Helpers.BeamHelperLookup[h.VoiceIndex][beat.Index];if(null!=beamingHelper){var direction=beamingHelper.Direction,tupletX=beamingHelper.GetBeatLineX(beat)+this.get_Scale(),tupletY=cy+this.Y+this.CalculateBeamY(beamingHelper,tupletX),offset=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?1.8*res.EffectFont.Size:-3*this.get_Scale();canvas.set_Font(res.EffectFont),canvas.FillText(h.Tuplet.toString(),cx+this.X+tupletX,tupletY-offset)}}canvas.set_TextAlign(oldAlign)},GetStemSize:function(helper){return 1==helper.Beats.length?this.GetFooterStemSize(helper.ShortestDuration):this.GetBarStemSize(helper.ShortestDuration)},GetBarStemSize:function(duration){var size;switch(duration){case AlphaTab.Model.Duration.QuadrupleWhole:size=6;break;case AlphaTab.Model.Duration.Half:size=6;break;case AlphaTab.Model.Duration.Quarter:size=6;break;case AlphaTab.Model.Duration.Eighth:size=6;break;case AlphaTab.Model.Duration.Sixteenth:size=6;break;case AlphaTab.Model.Duration.ThirtySecond:size=7;break;case AlphaTab.Model.Duration.SixtyFourth:size=7;break;case AlphaTab.Model.Duration.OneHundredTwentyEighth:size=9;break;case AlphaTab.Model.Duration.TwoHundredFiftySixth:size=10;break;default:size=0}return this.GetScoreY(size,0)},GetFooterStemSize:function(duration){var size;switch(duration){case AlphaTab.Model.Duration.QuadrupleWhole:size=6;break;case AlphaTab.Model.Duration.Half:size=6;break;case AlphaTab.Model.Duration.Quarter:size=6;break;case AlphaTab.Model.Duration.Eighth:size=6;break;case AlphaTab.Model.Duration.Sixteenth:size=6;break;case AlphaTab.Model.Duration.ThirtySecond:size=6;break;case AlphaTab.Model.Duration.SixtyFourth:size=6;break;case AlphaTab.Model.Duration.OneHundredTwentyEighth:size=6;break;case AlphaTab.Model.Duration.TwoHundredFiftySixth:size=6;break;default:size=0}return this.GetScoreY(size,0)},GetYPositionForNote:function(note){return this.GetScoreY(this.GetNoteLine(note),0)},CalculateBeamY:function(h,x){var stemSize=this.GetStemSize(h);return h.CalculateBeamY(stemSize,this.get_Scale(),x,this.get_Scale(),this)},CalculateBeamYWithDirection:function(h,x,direction){var stemSize=this.GetStemSize(h);return h.CalculateBeamYWithDirection(stemSize,this.get_Scale(),x,this.get_Scale(),this,direction)},PaintBar:function(cx,cy,canvas,h){for(var i=0,j=h.Beats.length;j>i;i++){var beat=h.Beats[i],isGrace=beat.GraceType!=AlphaTab.Model.GraceType.None,scaleMod=isGrace?.75:1,beatLineX=h.GetBeatLineX(beat)+this.get_Scale(),direction=h.Direction,y1=cy+this.Y;y1+=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?this.GetScoreY(this.GetNoteLine(beat.get_MinNote()),0):this.GetScoreY(this.GetNoteLine(beat.get_MaxNote()),0);var y2=cy+this.Y;y2+=scaleMod*this.CalculateBeamY(h,beatLineX),canvas.set_LineWidth(1.5*this.get_Scale()),canvas.BeginPath(),canvas.MoveTo(cx+this.X+beatLineX,y1),canvas.LineTo(cx+this.X+beatLineX,y2),canvas.Stroke(),canvas.set_LineWidth(this.get_Scale());var fingeringY=y2;direction==AlphaTab.Rendering.Utils.BeamDirection.Down?fingeringY+=2*canvas.get_Font().Size:0!=i&&(fingeringY-=1.5*canvas.get_Font().Size),this.PaintFingering(canvas,beat,cx+this.X+beatLineX,direction,fingeringY);var brokenBarOffset=6*this.get_Scale()*scaleMod,barSpacing=7*this.get_Scale()*scaleMod,barSize=4*this.get_Scale()*scaleMod,barCount=AlphaTab.Model.ModelUtils.GetIndex(beat.Duration)-2,barStart=cy+this.Y;direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&(barSpacing=-barSpacing,barSize=-barSize);for(var barIndex=0;barCount>barIndex;barIndex++){var barStartX,barEndX,barStartY,barEndY,barY=barStart+barIndex*barSpacing;if(i<h.Beats.length-1){if(AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(beat,h.Beats[i+1],barIndex))barStartX=beatLineX,barEndX=h.GetBeatLineX(h.Beats[i+1])+this.get_Scale();else{if(0!=i&&AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(h.Beats[i-1],beat,barIndex))continue;barStartX=beatLineX,barEndX=barStartX+brokenBarOffset}barStartY=barY+this.CalculateBeamY(h,barStartX)*scaleMod,barEndY=barY+this.CalculateBeamY(h,barEndX)*scaleMod,AlphaTab.Rendering.ScoreBarRenderer.PaintSingleBar(canvas,cx+this.X+barStartX,barStartY,cx+this.X+barEndX,barEndY,barSize)}else i>0&&!AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(beat,h.Beats[i-1],barIndex)&&(barStartX=beatLineX-brokenBarOffset,barEndX=beatLineX,barStartY=barY+this.CalculateBeamY(h,barStartX)*scaleMod,barEndY=barY+this.CalculateBeamY(h,barEndX)*scaleMod,AlphaTab.Rendering.ScoreBarRenderer.PaintSingleBar(canvas,cx+this.X+barStartX,barStartY,cx+this.X+barEndX,barEndY,barSize))}}},PaintFooter:function(cx,cy,canvas,h){var beamY,fingeringY,beat=h.Beats[0],isGrace=beat.GraceType!=AlphaTab.Model.GraceType.None,scaleMod=isGrace?.75:1,stemSize=this.GetFooterStemSize(h.ShortestDuration),beatLineX=h.GetBeatLineX(beat)+this.get_Scale(),direction=h.Direction,topY=this.GetScoreY(this.GetNoteLine(beat.get_MaxNote()),0),bottomY=this.GetScoreY(this.GetNoteLine(beat.get_MinNote()),0);if(direction==AlphaTab.Rendering.Utils.BeamDirection.Down?(bottomY+=stemSize*scaleMod,beamY=bottomY,fingeringY=cy+this.Y+bottomY):(topY-=stemSize*scaleMod,beamY=topY,fingeringY=cy+this.Y+topY),this.PaintFingering(canvas,beat,cx+this.X+beatLineX,direction,fingeringY),beat.Duration!=AlphaTab.Model.Duration.Whole&&beat.Duration!=AlphaTab.Model.Duration.DoubleWhole){if(canvas.set_LineWidth(1.5*this.get_Scale()),canvas.BeginPath(),canvas.MoveTo(cx+this.X+beatLineX,cy+this.Y+topY),canvas.LineTo(cx+this.X+beatLineX,cy+this.Y+bottomY),canvas.Stroke(),canvas.set_LineWidth(this.get_Scale()),isGrace){var graceSizeY=15*this.get_Scale(),graceSizeX=12*this.get_Scale();canvas.BeginPath(),direction==AlphaTab.Rendering.Utils.BeamDirection.Down?(canvas.MoveTo(cx+this.X+beatLineX-graceSizeX/2,cy+this.Y+bottomY-graceSizeY),canvas.LineTo(cx+this.X+beatLineX+graceSizeX/2,cy+this.Y+bottomY)):(canvas.MoveTo(cx+this.X+beatLineX-graceSizeX/2,cy+this.Y+topY+graceSizeY),canvas.LineTo(cx+this.X+beatLineX+graceSizeX/2,cy+this.Y+topY)),canvas.Stroke()}if(beat.Duration>AlphaTab.Model.Duration.Quarter){var glyph=new AlphaTab.Rendering.Glyphs.BeamGlyph(beatLineX-this.get_Scale()/2,beamY,beat.Duration,direction,isGrace);glyph.Renderer=this,glyph.DoLayout(),glyph.Paint(cx+this.X,cy+this.Y,canvas)}}},PaintFingering:function(canvas,beat,beatLineX,direction,topY){direction==AlphaTab.Rendering.Utils.BeamDirection.Up?beatLineX-=10*this.get_Scale():beatLineX+=3*this.get_Scale();var noteList=beat.Notes.slice();noteList.sort($CreateAnonymousDelegate(this,function(a,b){return b.get_RealValue()-a.get_RealValue()}));for(var n=0;n<noteList.length;n++){var note=noteList[n],text=null;note.LeftHandFinger!=AlphaTab.Model.Fingers.Unknown?text=this.FingerToString(beat,note.LeftHandFinger,!0):note.RightHandFinger!=AlphaTab.Model.Fingers.Unknown&&(text=this.FingerToString(beat,note.RightHandFinger,!1)),null!=text&&(canvas.FillText(text,beatLineX,topY),topY-=0|canvas.get_Font().Size)}},FingerToString:function(beat,finger,leftHand){if(this.get_Settings().ForcePianoFingering||AlphaTab.Audio.GeneralMidi.IsPiano(beat.Voice.Bar.Staff.Track.PlaybackInfo.Program))switch(finger){case AlphaTab.Model.Fingers.Unknown:case AlphaTab.Model.Fingers.NoOrDead:return null;case AlphaTab.Model.Fingers.Thumb:return"1";case AlphaTab.Model.Fingers.IndexFinger:return"2";case AlphaTab.Model.Fingers.MiddleFinger:return"3";case AlphaTab.Model.Fingers.AnnularFinger:return"4";case AlphaTab.Model.Fingers.LittleFinger:return"5";default:return null}else if(leftHand)switch(finger){case AlphaTab.Model.Fingers.Unknown:case AlphaTab.Model.Fingers.NoOrDead:return"0";case AlphaTab.Model.Fingers.Thumb:return"T";case AlphaTab.Model.Fingers.IndexFinger:return"1";case AlphaTab.Model.Fingers.MiddleFinger:return"2";case AlphaTab.Model.Fingers.AnnularFinger:return"3";case AlphaTab.Model.Fingers.LittleFinger:return"4";default:return null}else switch(finger){case AlphaTab.Model.Fingers.Unknown:case AlphaTab.Model.Fingers.NoOrDead:return null;case AlphaTab.Model.Fingers.Thumb:return"p";case AlphaTab.Model.Fingers.IndexFinger:return"i";case AlphaTab.Model.Fingers.MiddleFinger:return"m";case AlphaTab.Model.Fingers.AnnularFinger:return"a";case AlphaTab.Model.Fingers.LittleFinger:return"c";default:return null}},CreatePreBeatGlyphs:function(){if(AlphaTab.Rendering.BarRendererBase.prototype.CreatePreBeatGlyphs.call(this),this.Bar.get_MasterBar().IsRepeatStart&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatOpenGlyph(0,0,1.5,3)),this.get_IsFirstOfLine()||this.Bar.Clef!=this.Bar.PreviousBar.Clef||this.Bar.ClefOttavia!=this.Bar.PreviousBar.ClefOttavia){var offset=0,correction=0;switch(this.Bar.Clef){case AlphaTab.Model.Clef.Neutral:offset=6;break;case AlphaTab.Model.Clef.F4:offset=4,correction=-1;break;case AlphaTab.Model.Clef.C3:offset=6;break;case AlphaTab.Model.Clef.C4:offset=4;break;case AlphaTab.Model.Clef.G2:offset=8}this.CreateStartSpacing(),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.ClefGlyph(0,this.GetScoreY(offset,correction),this.Bar.Clef,this.Bar.ClefOttavia))}(0==this.Index&&0!=this.Bar.get_MasterBar().KeySignature||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().KeySignature!=this.Bar.PreviousBar.get_MasterBar().KeySignature)&&(this.CreateStartSpacing(),this.CreateKeySignatureGlyphs()),(null==this.Bar.PreviousBar||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().TimeSignatureNumerator!=this.Bar.PreviousBar.get_MasterBar().TimeSignatureNumerator||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().TimeSignatureDenominator!=this.Bar.PreviousBar.get_MasterBar().TimeSignatureDenominator)&&(this.CreateStartSpacing(),this.CreateTimeSignatureGlyphs()),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.BarNumberGlyph(0,this.GetScoreY(-.5,0),this.Bar.Index+1)),this.Bar.get_IsEmpty()&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,30*this.get_Scale()))},CreateBeatGlyphs:function(){for(var v=0;v<this.Bar.Voices.length;v++){var voice=this.Bar.Voices[v];this.HasVoiceContainer(voice)&&this.CreateVoiceGlyphs(voice)}},CreatePostBeatGlyphs:function(){AlphaTab.Rendering.BarRendererBase.prototype.CreatePostBeatGlyphs.call(this),this.Bar.get_MasterBar().get_IsRepeatEnd()?(this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCloseGlyph(this.X,0)),this.Bar.get_MasterBar().RepeatCount>2&&this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCountGlyph(0,this.GetScoreY(-1,-3),this.Bar.get_MasterBar().RepeatCount))):null!=this.Bar.NextBar&&this.Bar.NextBar.get_MasterBar().IsRepeatStart||this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.BarSeperatorGlyph(0,0))},CreateStartSpacing:function(){this._startSpacing||(this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,2*this.get_Scale())),this._startSpacing=!0)},CreateKeySignatureGlyphs:function(){var offsetClef=0,currentKey=this.Bar.get_MasterBar().KeySignature,previousKey=null==this.Bar.PreviousBar?0:this.Bar.PreviousBar.get_MasterBar().KeySignature;switch(this.Bar.Clef){case AlphaTab.Model.Clef.Neutral:offsetClef=0;break;case AlphaTab.Model.Clef.G2:offsetClef=1;break;case AlphaTab.Model.Clef.F4:offsetClef=2;break;case AlphaTab.Model.Clef.C3:offsetClef=-1;break;case AlphaTab.Model.Clef.C4:offsetClef=1}var newLines={},newGlyphs=[];if(AlphaTab.Model.ModelUtils.KeySignatureIsSharp(currentKey))for(var i=0;i<Math.abs(currentKey);i++){var step=AlphaTab.Rendering.ScoreBarRenderer.SharpKsSteps[i]+offsetClef;newGlyphs.push(new AlphaTab.Rendering.Glyphs.SharpGlyph(0,this.GetScoreY(step,0),!1)),newLines[step]=!0}else for(var i=0;i<Math.abs(currentKey);i++){var step=AlphaTab.Rendering.ScoreBarRenderer.FlatKsSteps[i]+offsetClef;newGlyphs.push(new AlphaTab.Rendering.Glyphs.FlatGlyph(0,this.GetScoreY(step,0),!1)),newLines[step]=!0}for(var naturalizeSymbols=Math.abs(previousKey),previousKeyPositions=AlphaTab.Model.ModelUtils.KeySignatureIsSharp(previousKey)?AlphaTab.Rendering.ScoreBarRenderer.SharpKsSteps:AlphaTab.Rendering.ScoreBarRenderer.FlatKsSteps,i=0;naturalizeSymbols>i;i++){var step=previousKeyPositions[i]+offsetClef;newLines.hasOwnProperty(step)||this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.NaturalizeGlyph(0,this.GetScoreY(previousKeyPositions[i]+offsetClef,0),!1))}for(var $i50=0,$l50=newGlyphs.length,newGlyph=newGlyphs[$i50];$l50>$i50;$i50++,newGlyph=newGlyphs[$i50])this.AddPreBeatGlyph(newGlyph)},CreateTimeSignatureGlyphs:function(){this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale())),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.TimeSignatureGlyph(0,this.GetScoreY(2,0),this.Bar.get_MasterBar().TimeSignatureNumerator,this.Bar.get_MasterBar().TimeSignatureDenominator,this.Bar.get_MasterBar().TimeSignatureCommon))},CreateVoiceGlyphs:function(v){for(var i=0,j=v.Beats.length;j>i;i++){var b=v.Beats[i],container=new AlphaTab.Rendering.ScoreBeatContainerGlyph(b,this.GetOrCreateVoiceContainer(v));container.PreNotes=new AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph,container.OnNotes=new AlphaTab.Rendering.Glyphs.ScoreBeatGlyph,this.AddBeatGlyph(container)}},GetNoteLine:function(n){return this.AccidentalHelper.GetNoteLine(n)},GetScoreY:function(steps,correction){return this.get_LineOffset()/2*steps+correction*this.get_Scale()},PaintBackground:function(cx,cy,canvas){AlphaTab.Rendering.BarRendererBase.prototype.PaintBackground.call(this,cx,cy,canvas);var res=this.get_Resources();canvas.set_Color(res.StaveLineColor);for(var lineY=cy+this.Y+this.TopPadding,lineOffset=this.get_LineOffset(),i=0;5>i;i++)i>0&&(lineY+=lineOffset),canvas.FillRect(cx+this.X,0|lineY,this.Width,this.get_Scale());canvas.set_Color(res.MainGlyphColor)}},$StaticConstructor(function(){AlphaTab.Rendering.ScoreBarRenderer.StaffId="score",AlphaTab.Rendering.ScoreBarRenderer.SharpKsSteps=new Int32Array([1,4,0,3,6,2,5]),AlphaTab.Rendering.ScoreBarRenderer.FlatKsSteps=new Int32Array([5,2,6,3,7,4,8]),AlphaTab.Rendering.ScoreBarRenderer.LineSpacing=8}),AlphaTab.Rendering.ScoreBarRenderer.PaintSingleBar=function(canvas,x1,y1,x2,y2,size){canvas.BeginPath(),canvas.MoveTo(x1,y1),canvas.LineTo(x2,y2),canvas.LineTo(x2,y2+size),canvas.LineTo(x1,y1+size),canvas.ClosePath(),canvas.Fill()},$Inherit(AlphaTab.Rendering.ScoreBarRenderer,AlphaTab.Rendering.BarRendererBase),AlphaTab.Rendering.ScoreBarRendererFactory=function(){AlphaTab.Rendering.BarRendererFactory.call(this)},AlphaTab.Rendering.ScoreBarRendererFactory.prototype={get_StaffId:function(){return"score"},Create:function(renderer,bar){return new AlphaTab.Rendering.ScoreBarRenderer(renderer,bar)}},$Inherit(AlphaTab.Rendering.ScoreBarRendererFactory,AlphaTab.Rendering.BarRendererFactory),AlphaTab.Rendering.ScoreRenderer=function(settings){this._currentLayoutMode=null,this.PreRender=null,this.PartialRenderFinished=null,this.RenderFinished=null,this.PostRenderFinished=null,this.Canvas=null,this.Score=null,this.Tracks=null,this.Layout=null,this.RenderingResources=null,this.Settings=null,this.BoundsLookup=null,this.Settings=settings,this.RenderingResources=new AlphaTab.Rendering.RenderingResources(1),this.Canvas=null!=settings.Engine&&AlphaTab.Environment.RenderEngines.hasOwnProperty(settings.Engine)?AlphaTab.Environment.RenderEngines[settings.Engine]():AlphaTab.Environment.RenderEngines["default"](),this.RecreateLayout()},AlphaTab.Rendering.ScoreRenderer.prototype={RecreateLayout:function(){return this._currentLayoutMode!=this.Settings.Layout.Mode?(this.Layout=null!=this.Settings.Layout&&AlphaTab.Environment.LayoutEngines.hasOwnProperty(this.Settings.Layout.Mode)?AlphaTab.Environment.LayoutEngines[this.Settings.Layout.Mode](this):AlphaTab.Environment.LayoutEngines["default"](this),this._currentLayoutMode=this.Settings.Layout.Mode,!0):!1},Render:function(track){this.Score=track.Score,this.Tracks=[track],this.Invalidate()},RenderMultiple:function(tracks){this.Score=0==tracks.length?null:tracks[0].Score,
this.Tracks=tracks,AlphaTab.Util.Logger.Info("Rendering","Rendering "+tracks.length+" tracks");for(var i=0;i<tracks.length;i++){var track=tracks[i];AlphaTab.Util.Logger.Info("Rendering","Track "+i+": "+track.Name)}this.Invalidate()},UpdateSettings:function(settings){this.Settings=settings},Invalidate:function(){return 0==this.Settings.Width?void AlphaTab.Util.Logger.Warning("Rendering","AlphaTab skipped rendering because of width=0 (element invisible)"):(this.BoundsLookup=new AlphaTab.Rendering.Utils.BoundsLookup,void(0!=this.Tracks.length&&(this.RenderingResources.Scale!=this.Settings.Scale&&(this.RenderingResources.Init(this.Settings.Scale),this.Canvas.set_LineWidth(this.Settings.Scale)),this.Canvas.set_Resources(this.RenderingResources),this.OnPreRender(),this.RecreateLayout(),this.LayoutAndRender(),AlphaTab.Util.Logger.Info("Rendering","Rendering finished"))))},Resize:function(width){this.RecreateLayout()?(AlphaTab.Util.Logger.Info("Rendering","Starting full rerendering due to layout change"),this.Invalidate()):this.Layout.get_SupportsResize()?(AlphaTab.Util.Logger.Info("Rendering","Starting optimized rerendering for resize"),this.BoundsLookup=new AlphaTab.Rendering.Utils.BoundsLookup,this.OnPreRender(),this.Settings.Width=width,this.Layout.Resize(),this.Layout.RenderAnnotation(),this.OnRenderFinished(),this.OnPostRender()):AlphaTab.Util.Logger.Warning("Rendering","Current layout does not support dynamic resizing, nothing was done"),AlphaTab.Util.Logger.Info("Rendering","Resize finished")},LayoutAndRender:function(){AlphaTab.Util.Logger.Info("Rendering","Rendering at scale "+this.Settings.Scale+" with layout "+this.Layout.get_Name()),this.Layout.LayoutAndRender(),this.Layout.RenderAnnotation(),this.OnRenderFinished(),this.OnPostRender()},add_PreRender:function(value){this.PreRender=$CombineDelegates(this.PreRender,value)},remove_PreRender:function(value){this.PreRender=$RemoveDelegate(this.PreRender,value)},OnPreRender:function(){var result=this.Canvas.OnPreRender(),handler=this.PreRender,args=new AlphaTab.Rendering.RenderFinishedEventArgs;args.TotalWidth=0,args.TotalHeight=0,args.Width=0,args.Height=0,args.RenderResult=result,null!=handler&&handler(args)},add_PartialRenderFinished:function(value){this.PartialRenderFinished=$CombineDelegates(this.PartialRenderFinished,value)},remove_PartialRenderFinished:function(value){this.PartialRenderFinished=$RemoveDelegate(this.PartialRenderFinished,value)},OnPartialRenderFinished:function(e){var handler=this.PartialRenderFinished;null!=handler&&handler(e)},add_RenderFinished:function(value){this.RenderFinished=$CombineDelegates(this.RenderFinished,value)},remove_RenderFinished:function(value){this.RenderFinished=$RemoveDelegate(this.RenderFinished,value)},OnRenderFinished:function(){var result=this.Canvas.OnRenderFinished(),handler=this.RenderFinished;null!=handler&&handler(function(){var $v6=new AlphaTab.Rendering.RenderFinishedEventArgs;return $v6.RenderResult=result,$v6.TotalHeight=this.Layout.Height,$v6.TotalWidth=this.Layout.Width,$v6}.call(this))},add_PostRenderFinished:function(value){this.PostRenderFinished=$CombineDelegates(this.PostRenderFinished,value)},remove_PostRenderFinished:function(value){this.PostRenderFinished=$RemoveDelegate(this.PostRenderFinished,value)},OnPostRender:function(){var handler=this.PostRenderFinished;null!=handler&&handler()}},AlphaTab.Rendering.Staves=AlphaTab.Rendering.Staves||{},AlphaTab.Rendering.Staves.BarLayoutingInfo=function(){this._timeSortedSprings=null,this._xMin=0,this._onTimePositionsForce=0,this._onTimePositions=null,this.Version=0,this.PreBeatSizes=null,this.OnBeatSizes=null,this.PreBeatSize=0,this.PostBeatSize=0,this.VoiceSize=0,this.MinStretchForce=0,this.TotalSpringConstant=0,this.Springs=null,this.SmallestDuration=0,this.PreBeatSizes={},this.OnBeatSizes={},this.VoiceSize=0,this.Springs={},this.Version=0},AlphaTab.Rendering.Staves.BarLayoutingInfo.prototype={UpdateVoiceSize:function(size){size>this.VoiceSize&&(this.VoiceSize=size,this.Version++)},SetPreBeatSize:function(beat,size){(!this.PreBeatSizes.hasOwnProperty(beat.Index)||this.PreBeatSizes[beat.Index]<size)&&(this.PreBeatSizes[beat.Index]=size,this.Version++)},GetPreBeatSize:function(beat){return this.PreBeatSizes.hasOwnProperty(beat.Index)?this.PreBeatSizes[beat.Index]:0},SetOnBeatSize:function(beat,size){(!this.OnBeatSizes.hasOwnProperty(beat.Index)||this.OnBeatSizes[beat.Index]<size)&&(this.OnBeatSizes[beat.Index]=size,this.Version++)},GetOnBeatSize:function(beat){return this.OnBeatSizes.hasOwnProperty(beat.Index)?this.OnBeatSizes[beat.Index]:0},UpdateMinStretchForce:function(force){this.MinStretchForce<force&&(this.MinStretchForce=force,this.Version++)},AddSpring:function(start,duration,springSize,preSpringSize){this.Version++;var spring;return this.Springs.hasOwnProperty(start)?(spring=this.Springs[start],spring.SpringWidth<springSize&&(spring.SpringWidth=springSize),spring.PreSpringWidth<preSpringSize&&(spring.PreSpringWidth=preSpringSize),duration<spring.SmallestDuration&&(spring.SmallestDuration=duration),duration>spring.LongestDuration&&(spring.LongestDuration=duration)):(spring=new AlphaTab.Rendering.Staves.Spring,spring.TimePosition=start,spring.SmallestDuration=duration,spring.LongestDuration=duration,spring.SpringWidth=springSize,spring.PreSpringWidth=preSpringSize,this.Springs[start]=spring),duration<this.SmallestDuration&&(this.SmallestDuration=duration),spring},AddBeatSpring:function(beat,beatSize,preBeatSize){return this.AddSpring(beat.get_AbsoluteStart(),beat.CalculateDuration(),beatSize,preBeatSize)},Finish:function(){this.CalculateSpringConstants(),this.Version++},CalculateSpringConstants:function(){var sortedSprings=this._timeSortedSprings=[];this._xMin=0;var springs=this.Springs;for(var time in springs){var spring=springs[time];sortedSprings.push(spring),spring.SpringWidth<this._xMin&&(this._xMin=spring.SpringWidth)}sortedSprings.sort($CreateAnonymousDelegate(this,function(a,b){return a.TimePosition<b.TimePosition?-1:a.TimePosition>b.TimePosition?1:0}));for(var totalSpringConstant=0,i=0;i<sortedSprings.length;i++){var duration,currentSpring=sortedSprings[i];if(i==sortedSprings.length-1)duration=currentSpring.LongestDuration;else{var nextSpring=sortedSprings[i+1];duration=nextSpring.TimePosition-currentSpring.TimePosition}currentSpring.SpringConstant=this.CalculateSpringConstant(currentSpring,duration),totalSpringConstant+=1/currentSpring.SpringConstant}this.TotalSpringConstant=1/totalSpringConstant;for(var i=0;i<sortedSprings.length;i++){var force=sortedSprings[i].SpringWidth*sortedSprings[i].SpringConstant;this.UpdateMinStretchForce(force)}},CalculateSpringConstant:function(spring,duration){var minDuration=spring.SmallestDuration;0==spring.SmallestDuration&&(minDuration=duration);var phi=1+.6*Math.log2(duration/30);return minDuration/duration*1/(10*phi)},SpaceToForce:function(space){return space*this.TotalSpringConstant},CalculateVoiceWidth:function(force){return this.CalculateWidth(force,this.TotalSpringConstant)},CalculateWidth:function(force,springConstant){return force/springConstant},BuildOnTimePositions:function(force){if(Math.abs(this._onTimePositionsForce-force)<1e-5&&null!=this._onTimePositions)return this._onTimePositions;this._onTimePositionsForce=force;var positions=this._onTimePositions={},sortedSprings=this._timeSortedSprings;if(0==sortedSprings.length)return positions;for(var springX=sortedSprings[0].PreSpringWidth,i=0;i<sortedSprings.length;i++)positions[sortedSprings[i].TimePosition]=springX,springX+=this.CalculateWidth(force,sortedSprings[i].SpringConstant);return positions}},$StaticConstructor(function(){AlphaTab.Rendering.Staves.BarLayoutingInfo.MinDuration=30,AlphaTab.Rendering.Staves.BarLayoutingInfo.MinDurationWidth=10}),AlphaTab.Rendering.Staves.Spring=function(){this.TimePosition=0,this.LongestDuration=0,this.SmallestDuration=0,this.Force=0,this.SpringConstant=0,this.SpringWidth=0,this.PreSpringWidth=0},AlphaTab.Rendering.Staves.MasterBarsRenderers=function(){this.Width=0,this.IsLinkedToPrevious=!1,this.MasterBar=null,this.Renderers=null,this.LayoutingInfo=null,this.Renderers=[]},AlphaTab.Rendering.Staves.Staff=function(trackIndex,staff,factory,settings){this._factory=null,this._settings=null,this.StaveTrackGroup=null,this.StaveGroup=null,this.BarRenderers=null,this.X=0,this.Y=0,this.Height=0,this.Index=0,this.StaffIndex=0,this.TrackIndex=0,this.ModelStaff=null,this.StaveTop=0,this.TopSpacing=0,this.BottomSpacing=0,this.StaveBottom=0,this.IsFirstInAccolade=!1,this.IsLastInAccolade=!1,this.BarRenderers=[],this.TrackIndex=trackIndex,this.ModelStaff=staff,this._factory=factory,this._settings=settings,this.TopSpacing=15,this.BottomSpacing=5,this.StaveTop=0,this.StaveBottom=0},AlphaTab.Rendering.Staves.Staff.prototype={get_StaveId:function(){return this._factory.get_StaffId()},GetSetting:function(key,def){return this._settings.hasOwnProperty(key)?this._settings[key]:def},get_IsInAccolade:function(){return this._factory.IsInAccolade},RegisterStaffTop:function(offset){this.StaveTop=offset},RegisterStaffBottom:function(offset){this.StaveBottom=offset},AddBarRenderer:function(renderer){renderer.Staff=this,renderer.Index=this.BarRenderers.length,renderer.ReLayout(),this.BarRenderers.push(renderer),this.StaveGroup.Layout.RegisterBarRenderer(this.get_StaveId(),renderer)},AddBar:function(bar,layoutingInfo){var renderer;renderer=null==bar?new AlphaTab.Rendering.BarRendererBase(this.StaveGroup.Layout.Renderer,bar):this._factory.Create(this.StaveGroup.Layout.Renderer,bar,this._settings),renderer.Staff=this,renderer.Index=this.BarRenderers.length,renderer.LayoutingInfo=layoutingInfo,renderer.DoLayout(),renderer.RegisterLayoutingInfo(),this.BarRenderers.push(renderer),null!=bar&&this.StaveGroup.Layout.RegisterBarRenderer(this.get_StaveId(),renderer)},RevertLastBar:function(){var lastBar=this.BarRenderers[this.BarRenderers.length-1];this.BarRenderers.splice(this.BarRenderers.length-1,1),this.StaveGroup.Layout.UnregisterBarRenderer(this.get_StaveId(),lastBar)},ScaleToWidth:function(width){for(var difference=width-this.StaveGroup.Width,spacePerBar=difference/this.BarRenderers.length,i=0,j=this.BarRenderers.length;j>i;i++)this.BarRenderers[i].ScaleToWidth(this.BarRenderers[i].Width+spacePerBar)},get_TopOverflow:function(){for(var m=0,i=0,j=this.BarRenderers.length;j>i;i++){var r=this.BarRenderers[i];r.TopOverflow>m&&(m=r.TopOverflow)}return m},get_BottomOverflow:function(){for(var m=0,i=0,j=this.BarRenderers.length;j>i;i++){var r=this.BarRenderers[i];r.BottomOverflow>m&&(m=r.BottomOverflow)}return m},FinalizeStave:function(){var x=0;this.Height=0;for(var topOverflow=this.get_TopOverflow(),bottomOverflow=this.get_BottomOverflow(),i=0;i<this.BarRenderers.length;i++)this.BarRenderers[i].X=x,this.BarRenderers[i].Y=this.TopSpacing+topOverflow,this.Height=Math.max(this.Height,this.BarRenderers[i].Height),this.BarRenderers[i].FinalizeRenderer(),x+=this.BarRenderers[i].Width;this.Height>0&&(this.Height+=this.TopSpacing+topOverflow+bottomOverflow+this.BottomSpacing)},Paint:function(cx,cy,canvas,startIndex,count){if(0!=this.Height&&0!=count)for(var i=startIndex,j=Math.min(startIndex+count,this.BarRenderers.length);j>i;i++)this.BarRenderers[i].Paint(cx+this.X,cy+this.Y,canvas)}},AlphaTab.Rendering.Staves.StaveTrackGroup=function(staveGroup,track){this.Track=null,this.StaveGroup=null,this.Staves=null,this.FirstStaffInAccolade=null,this.LastStaffInAccolade=null,this.StaveGroup=staveGroup,this.Track=track,this.Staves=[]},AlphaTab.Rendering.Staves.StaveGroup=function(){this._allStaves=null,this._firstStaffInAccolade=null,this._lastStaffInAccolade=null,this._accoladeSpacingCalculated=!1,this.X=0,this.Y=0,this.Index=0,this.AccoladeSpacing=0,this.IsFull=!1,this.Width=0,this.IsLast=!1,this.MasterBarsRenderers=null,this.Staves=null,this.Layout=null,this.MasterBarsRenderers=[],this.Staves=[],this._allStaves=[],this.Width=0,this.Index=0,this._accoladeSpacingCalculated=!1,this.AccoladeSpacing=0},AlphaTab.Rendering.Staves.StaveGroup.prototype={get_FirstBarIndex:function(){return this.MasterBarsRenderers[0].MasterBar.Index},get_LastBarIndex:function(){return this.MasterBarsRenderers[this.MasterBarsRenderers.length-1].MasterBar.Index},AddMasterBarRenderers:function(tracks,renderers){if(0==tracks.length)return null;this.MasterBarsRenderers.push(renderers),this.CalculateAccoladeSpacing(tracks),renderers.LayoutingInfo.PreBeatSize=0;for(var src=0,i=0,j=this.Staves.length;j>i;i++)for(var g=this.Staves[i],k=0,l=g.Staves.length;l>k;k++){var s=g.Staves[k],renderer=renderers.Renderers[src++];s.AddBarRenderer(renderer)}return this.UpdateWidth(),renderers},AddBars:function(tracks,barIndex){if(0==tracks.length)return null;var result=new AlphaTab.Rendering.Staves.MasterBarsRenderers;result.LayoutingInfo=new AlphaTab.Rendering.Staves.BarLayoutingInfo,result.MasterBar=tracks[0].Score.MasterBars[barIndex],this.MasterBarsRenderers.push(result),this.CalculateAccoladeSpacing(tracks);for(var barLayoutingInfo=result.LayoutingInfo,$i51=0,$t51=this.Staves,$l51=$t51.length,g=$t51[$i51];$l51>$i51;$i51++,g=$t51[$i51])for(var $i52=0,$t52=g.Staves,$l52=$t52.length,s=$t52[$i52];$l52>$i52;$i52++,s=$t52[$i52]){s.AddBar(g.Track.Staves[s.ModelStaff.Index].Bars[barIndex],barLayoutingInfo);var renderer=s.BarRenderers[s.BarRenderers.length-1];result.Renderers.push(renderer),renderer.IsLinkedToPrevious&&(result.IsLinkedToPrevious=!0)}return barLayoutingInfo.Finish(),result.Width=this.UpdateWidth(),result},RevertLastBar:function(){if(this.MasterBarsRenderers.length>1){this.MasterBarsRenderers.splice(this.MasterBarsRenderers.length-1,1);for(var w=0,i=0,j=this._allStaves.length;j>i;i++){var s=this._allStaves[i];w=Math.max(w,s.BarRenderers[s.BarRenderers.length-1].Width),s.RevertLastBar()}this.Width-=w}},UpdateWidth:function(){for(var realWidth=0,i=0,j=this._allStaves.length;j>i;i++){var s=this._allStaves[i];s.BarRenderers[s.BarRenderers.length-1].ApplyLayoutingInfo(),s.BarRenderers[s.BarRenderers.length-1].Width>realWidth&&(realWidth=s.BarRenderers[s.BarRenderers.length-1].Width)}return this.Width+=realWidth,realWidth},CalculateAccoladeSpacing:function(tracks){if(!this._accoladeSpacingCalculated&&0==this.Index){this._accoladeSpacingCalculated=!0;var canvas=this.Layout.Renderer.Canvas,res=this.Layout.Renderer.RenderingResources.EffectFont;canvas.set_Font(res);for(var i=0;i<tracks.length;i++)this.AccoladeSpacing=Math.max(this.AccoladeSpacing,canvas.MeasureText(tracks[i].ShortName));this.AccoladeSpacing+=20,this.Width+=this.AccoladeSpacing}},GetStaveTrackGroup:function(track){for(var i=0,j=this.Staves.length;j>i;i++){var g=this.Staves[i];if(g.Track==track)return g}return null},AddStaff:function(track,staff){var group=this.GetStaveTrackGroup(track);null==group&&(group=new AlphaTab.Rendering.Staves.StaveTrackGroup(this,track),this.Staves.push(group)),staff.StaveTrackGroup=group,staff.StaveGroup=this,staff.Index=this._allStaves.length,this._allStaves.push(staff),group.Staves.push(staff),staff.get_IsInAccolade()&&(null==this._firstStaffInAccolade&&(this._firstStaffInAccolade=staff,staff.IsFirstInAccolade=!0),null==group.FirstStaffInAccolade&&(group.FirstStaffInAccolade=staff),null==this._lastStaffInAccolade&&(this._lastStaffInAccolade=staff,staff.IsLastInAccolade=!0),null!=this._lastStaffInAccolade&&(this._lastStaffInAccolade.IsLastInAccolade=!1),this._lastStaffInAccolade=staff,this._lastStaffInAccolade.IsLastInAccolade=!0,group.LastStaffInAccolade=staff)},get_Height:function(){return this._allStaves[this._allStaves.length-1].Y+this._allStaves[this._allStaves.length-1].Height},ScaleToWidth:function(width){for(var i=0,j=this._allStaves.length;j>i;i++)this._allStaves[i].ScaleToWidth(width);this.Width=width},Paint:function(cx,cy,canvas){this.PaintPartial(cx+this.X,cy+this.Y,canvas,0,this.MasterBarsRenderers.length)},PaintPartial:function(cx,cy,canvas,startIndex,count){this.BuildBoundingsLookup(cx,cy);for(var i=0,j=this._allStaves.length;j>i;i++)this._allStaves[i].Paint(cx,cy,canvas,startIndex,count);var res=this.Layout.Renderer.RenderingResources;if(this.Staves.length>0&&0==startIndex){if(null!=this._firstStaffInAccolade&&null!=this._lastStaffInAccolade){var firstStart=cy+this._firstStaffInAccolade.Y+this._firstStaffInAccolade.StaveTop+this._firstStaffInAccolade.TopSpacing+this._firstStaffInAccolade.get_TopOverflow(),lastEnd=cy+this._lastStaffInAccolade.Y+this._lastStaffInAccolade.TopSpacing+this._lastStaffInAccolade.get_TopOverflow()+this._lastStaffInAccolade.StaveBottom,acooladeX=cx+this._firstStaffInAccolade.X;canvas.set_Color(res.BarSeperatorColor),canvas.BeginPath(),canvas.MoveTo(acooladeX,firstStart),canvas.LineTo(acooladeX,lastEnd),canvas.Stroke()}canvas.set_Font(res.EffectFont);for(var i=0,j=this.Staves.length;j>i;i++){var g=this.Staves[i];if(null!=g.FirstStaffInAccolade&&null!=g.LastStaffInAccolade){var firstStart=cy+g.FirstStaffInAccolade.Y+g.FirstStaffInAccolade.StaveTop+g.FirstStaffInAccolade.TopSpacing+g.FirstStaffInAccolade.get_TopOverflow(),lastEnd=cy+g.LastStaffInAccolade.Y+g.LastStaffInAccolade.TopSpacing+g.LastStaffInAccolade.get_TopOverflow()+g.LastStaffInAccolade.StaveBottom,acooladeX=cx+g.FirstStaffInAccolade.X,barSize=3*this.Layout.Renderer.Settings.Scale,barOffset=barSize,accoladeStart=firstStart-4*barSize,accoladeEnd=lastEnd+4*barSize;0==this.Index&&canvas.FillText(g.Track.ShortName,cx+10*this.Layout.get_Scale(),firstStart),canvas.FillRect(acooladeX-barOffset-barSize,accoladeStart,barSize,accoladeEnd-accoladeStart);var spikeStartX=acooladeX-barOffset-barSize,spikeEndX=acooladeX+2*barSize;canvas.BeginPath(),canvas.MoveTo(spikeStartX,accoladeStart),canvas.BezierCurveTo(spikeStartX,accoladeStart,spikeStartX,accoladeStart,spikeEndX,accoladeStart-barSize),canvas.BezierCurveTo(acooladeX,accoladeStart+barSize,spikeStartX,accoladeStart+barSize,spikeStartX,accoladeStart+barSize),canvas.ClosePath(),canvas.Fill(),canvas.BeginPath(),canvas.MoveTo(spikeStartX,accoladeEnd),canvas.BezierCurveTo(spikeStartX,accoladeEnd,acooladeX,accoladeEnd,spikeEndX,accoladeEnd+barSize),canvas.BezierCurveTo(acooladeX,accoladeEnd-barSize,spikeStartX,accoladeEnd-barSize,spikeStartX,accoladeEnd-barSize),canvas.ClosePath(),canvas.Fill()}}}},FinalizeGroup:function(){for(var currentY=0,$i53=0,$t53=this._allStaves,$l53=$t53.length,staff=$t53[$i53];$l53>$i53;$i53++,staff=$t53[$i53])staff.X=this.AccoladeSpacing,staff.Y=currentY,staff.FinalizeStave(),currentY+=staff.Height},BuildBoundingsLookup:function(cx,cy){if(!this.Layout.Renderer.BoundsLookup.IsFinished&&null!=this._firstStaffInAccolade&&null!=this._lastStaffInAccolade){var visualTop=cy+this.Y+this._firstStaffInAccolade.Y,visualBottom=cy+this.Y+this._lastStaffInAccolade.Y+this._lastStaffInAccolade.Height,realTop=cy+this.Y+this._allStaves[0].Y,realBottom=cy+this.Y+this._allStaves[this._allStaves.length-1].Y+this._allStaves[this._allStaves.length-1].Height,visualHeight=visualBottom-visualTop,realHeight=realBottom-realTop,x=this.X+this._firstStaffInAccolade.X,staveGroupBounds=new AlphaTab.Rendering.Utils.StaveGroupBounds;staveGroupBounds.VisualBounds={X:cx,Y:cy+this.Y,W:this.Width,H:this.get_Height()},staveGroupBounds.RealBounds={X:cx,Y:cy+this.Y,W:this.Width,H:this.get_Height()},this.Layout.Renderer.BoundsLookup.AddStaveGroup(staveGroupBounds);for(var masterBarBoundsLookup=[],i=0;i<this.Staves.length;i++)for(var j=0,k=this.Staves[i].FirstStaffInAccolade.BarRenderers.length;k>j;j++){var renderer=this.Staves[i].FirstStaffInAccolade.BarRenderers[j];if(0==i){var masterBarBounds=new AlphaTab.Rendering.Utils.MasterBarBounds;masterBarBounds.IsFirstOfLine=renderer.get_IsFirstOfLine(),masterBarBounds.RealBounds={X:x+renderer.X,Y:realTop,W:renderer.Width,H:realHeight},masterBarBounds.VisualBounds={X:x+renderer.X,Y:visualTop,W:renderer.Width,H:visualHeight},this.Layout.Renderer.BoundsLookup.AddMasterBar(masterBarBounds),masterBarBoundsLookup.push(masterBarBounds)}renderer.BuildBoundingsLookup(masterBarBoundsLookup[j],x,cy+this.Y+this._firstStaffInAccolade.Y)}}},GetBarX:function(index){if(null==this._firstStaffInAccolade||0==this.Layout.Renderer.Tracks.length)return 0;var bar=this.Layout.Renderer.Tracks[0].Staves[0].Bars[index],renderer=this.Layout.GetRendererForBar(this._firstStaffInAccolade.get_StaveId(),bar);return renderer.X}},$StaticConstructor(function(){AlphaTab.Rendering.Staves.StaveGroup.AccoladeLabelSpacing=10}),AlphaTab.Rendering.TabBarRenderer=function(renderer,bar){this.RenderRhythm=!1,this.RhythmHeight=0,this.RhythmBeams=!1,AlphaTab.Rendering.BarRendererBase.call(this,renderer,bar),this.RhythmHeight=15*renderer.Layout.get_Scale()},AlphaTab.Rendering.TabBarRenderer.prototype={get_LineOffset:function(){return 11*this.get_Scale()},GetNoteX:function(note,onEnd){var beat=this.GetOnNotesGlyphForBeat(note.Beat);return null!=beat?beat.Container.X+beat.Container.VoiceContainer.X+beat.X+beat.NoteNumbers.GetNoteX(note,onEnd):0},GetNoteY:function(note){var beat=this.GetOnNotesGlyphForBeat(note.Beat);return null!=beat?beat.NoteNumbers.GetNoteY(note):0},UpdateSizes:function(){var res=this.get_Resources(),numberOverflow=res.TablatureFont.Size/2+.2*res.TablatureFont.Size;this.TopPadding=numberOverflow,this.BottomPadding=numberOverflow,this.Height=this.get_LineOffset()*(this.Bar.Staff.Track.Tuning.length-1)+2*numberOverflow,this.RenderRhythm&&(this.Height+=this.RhythmHeight,this.BottomPadding+=this.RhythmHeight),AlphaTab.Rendering.BarRendererBase.prototype.UpdateSizes.call(this)},CreatePreBeatGlyphs:function(){if(AlphaTab.Rendering.BarRendererBase.prototype.CreatePreBeatGlyphs.call(this),this.Bar.get_MasterBar().IsRepeatStart&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatOpenGlyph(0,0,1.5,3)),this.get_IsFirstOfLine()){var center=(this.Bar.Staff.Track.Tuning.length+1)/2;this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.TabClefGlyph(5*this.get_Scale(),this.GetTabY(center,0)))}this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.BarNumberGlyph(0,this.GetTabY(-.5,0),this.Bar.Index+1)),this.Bar.get_IsEmpty()&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,30*this.get_Scale()))},CreateBeatGlyphs:function(){for(var v=0;v<this.Bar.Voices.length;v++){var voice=this.Bar.Voices[v];this.HasVoiceContainer(voice)&&this.CreateVoiceGlyphs(this.Bar.Voices[v])}},CreateVoiceGlyphs:function(v){for(var i=0,j=v.Beats.length;j>i;i++){var b=v.Beats[i],container=new AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph(b,this.GetOrCreateVoiceContainer(v));container.PreNotes=new AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph,container.OnNotes=new AlphaTab.Rendering.Glyphs.TabBeatGlyph,this.AddBeatGlyph(container)}},CreatePostBeatGlyphs:function(){AlphaTab.Rendering.BarRendererBase.prototype.CreatePostBeatGlyphs.call(this),this.Bar.get_MasterBar().get_IsRepeatEnd()?(this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCloseGlyph(this.X,0)),this.Bar.get_MasterBar().RepeatCount>2&&this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCountGlyph(0,this.GetTabY(-.5,-3),this.Bar.get_MasterBar().RepeatCount))):null!=this.Bar.NextBar&&this.Bar.NextBar.get_MasterBar().IsRepeatStart||this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.BarSeperatorGlyph(0,0))},GetTabY:function(line,correction){return this.get_LineOffset()*line+correction*this.get_Scale()},PaintBackground:function(cx,cy,canvas){AlphaTab.Rendering.BarRendererBase.prototype.PaintBackground.call(this,cx,cy,canvas);var res=this.get_Resources();canvas.set_Color(res.StaveLineColor);for(var lineY=cy+this.Y+this.TopPadding,padding=this.get_Scale(),tabNotes=[],i=0,j=this.Bar.Staff.Track.Tuning.length;j>i;i++)tabNotes.push([]);for(var $i54=0,$t54=this.Bar.Voices,$l54=$t54.length,voice=$t54[$i54];$l54>$i54;$i54++,voice=$t54[$i54])if(this.HasVoiceContainer(voice))for(var vc=this.GetOrCreateVoiceContainer(voice),$i55=0,$t55=vc.BeatGlyphs,$l55=$t55.length,bg=$t55[$i55];$l55>$i55;$i55++,bg=$t55[$i55]){var notes=bg.OnNotes,noteNumbers=notes.NoteNumbers;if(null!=noteNumbers)for(var s in noteNumbers.NotesPerString){var noteNumber=noteNumbers.NotesPerString[s];noteNumber.IsEmpty||tabNotes[this.Bar.Staff.Track.Tuning.length-s].push(new Float32Array([vc.X+bg.X+notes.X+noteNumbers.X,noteNumbers.Width+padding]))}}for(var $i56=0,$l56=tabNotes.length,line=tabNotes[$i56];$l56>$i56;$i56++,line=tabNotes[$i56])line.sort($CreateAnonymousDelegate(this,function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0}));for(var lineOffset=this.get_LineOffset(),i=0,j=this.Bar.Staff.Track.Tuning.length;j>i;i++){i>0&&(lineY+=lineOffset);for(var lineX=0,$i57=0,$t57=tabNotes[i],$l57=$t57.length,line=$t57[$i57];$l57>$i57;$i57++,line=$t57[$i57])canvas.FillRect(cx+this.X+lineX,0|lineY,line[0]-lineX,this.get_Scale()),lineX=line[0]+line[1];canvas.FillRect(cx+this.X+lineX,0|lineY,this.Width-lineX,this.get_Scale())}canvas.set_Color(res.MainGlyphColor)},Paint:function(cx,cy,canvas){AlphaTab.Rendering.BarRendererBase.prototype.Paint.call(this,cx,cy,canvas),this.RenderRhythm&&this.PaintBeams(cx,cy,canvas)},PaintBeams:function(cx,cy,canvas){for(var i=0,j=this.Helpers.BeamHelpers.length;j>i;i++)for(var v=this.Helpers.BeamHelpers[i],k=0,l=v.length;l>k;k++){var h=v[k];this.PaintBeamHelper(cx+this.get_BeatGlyphsStart(),cy,canvas,h)}},PaintBeamHelper:function(cx,cy,canvas,h){canvas.set_Color(0==h.Voice.Index?this.get_Resources().MainGlyphColor:this.get_Resources().SecondaryGlyphColor),1==h.Beats.length||this.RhythmBeams?this.PaintFooter(cx,cy,canvas,h):this.PaintBar(cx,cy,canvas,h)},PaintBar:function(cx,cy,canvas,h){for(var i=0,j=h.Beats.length;j>i;i++){var beat=h.Beats[i];if(h.HasBeatLineX(beat)){var beatLineX=h.GetBeatLineX(beat),y1=cy+this.Y,y2=cy+this.Y+this.Height,startGlyph=this.GetOnNotesGlyphForBeat(beat);y1+=null==startGlyph.NoteNumbers?this.Height-this.RhythmHeight:startGlyph.NoteNumbers.GetNoteY(startGlyph.NoteNumbers.MinStringNote)+this.get_LineOffset()/2,h.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?beatLineX-=startGlyph.Width/2:beatLineX+=startGlyph.Width/2,canvas.BeginPath(),canvas.MoveTo(cx+this.X+beatLineX,y1),canvas.LineTo(cx+this.X+beatLineX,y2),canvas.Stroke();var brokenBarOffset=6*this.get_Scale(),barSpacing=6*this.get_Scale(),barSize=3*this.get_Scale(),barCount=AlphaTab.Model.ModelUtils.GetIndex(beat.Duration)-2,barStart=cy+this.Y;barSpacing=-barSpacing,barStart+=this.Height;for(var barIndex=0;barCount>barIndex;barIndex++){var barStartX,barEndX,barStartY,barEndY,barY=barStart+barIndex*barSpacing;if(1==h.Beats.length)barStartX=beatLineX,barEndX=beatLineX+brokenBarOffset,barStartY=barY,barEndY=barY,AlphaTab.Rendering.TabBarRenderer.PaintSingleBar(canvas,cx+this.X+barStartX,barStartY,cx+this.X+barEndX,barEndY,barSize);else if(i<h.Beats.length-1){if(AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(beat,h.Beats[i+1],barIndex)){barStartX=beatLineX,barEndX=h.GetBeatLineX(h.Beats[i+1])+this.get_Scale();var endGlyph=this.GetOnNotesGlyphForBeat(h.Beats[i+1]);h.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?barEndX-=endGlyph.Width/2:barEndX+=endGlyph.Width/2}else{if(0!=i&&AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(h.Beats[i-1],beat,barIndex))continue;barStartX=beatLineX,barEndX=barStartX+brokenBarOffset}barStartY=barY,barEndY=barY,AlphaTab.Rendering.TabBarRenderer.PaintSingleBar(canvas,cx+this.X+barStartX,barStartY,cx+this.X+barEndX,barEndY,barSize)}else i>0&&!AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(beat,h.Beats[i-1],barIndex)&&(barStartX=beatLineX-brokenBarOffset,barEndX=beatLineX,barStartY=barY,barEndY=barY,AlphaTab.Rendering.TabBarRenderer.PaintSingleBar(canvas,cx+this.X+barStartX,barStartY,cx+this.X+barEndX,barEndY,barSize))}}}},PaintFooter:function(cx,cy,canvas,h){for(var $i58=0,$t58=h.Beats,$l58=$t58.length,beat=$t58[$i58];$l58>$i58;$i58++,beat=$t58[$i58])if(beat.Duration!=AlphaTab.Model.Duration.Whole&&beat.Duration!=AlphaTab.Model.Duration.DoubleWhole){var beatLineX=h.GetBeatLineX(beat),y1=cy+this.Y,y2=cy+this.Y+this.Height,startGlyph=this.GetOnNotesGlyphForBeat(beat);y1+=null==startGlyph.NoteNumbers?this.Height-this.RhythmHeight:startGlyph.NoteNumbers.GetNoteY(startGlyph.NoteNumbers.MinStringNote)+this.get_LineOffset()/2,h.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?beatLineX-=startGlyph.Width/2:beatLineX+=startGlyph.Width/2,canvas.BeginPath(),canvas.MoveTo(cx+this.X+beatLineX,y1),canvas.LineTo(cx+this.X+beatLineX,y2),canvas.Stroke();var glyph=new AlphaTab.Rendering.Glyphs.BeamGlyph(0,0,beat.Duration,AlphaTab.Rendering.Utils.BeamDirection.Down,!1);glyph.Renderer=this,glyph.DoLayout(),glyph.Paint(cx+this.X+beatLineX,y2,canvas)}}},$StaticConstructor(function(){AlphaTab.Rendering.TabBarRenderer.StaffId="tab",AlphaTab.Rendering.TabBarRenderer.LineSpacing=10}),AlphaTab.Rendering.TabBarRenderer.PaintSingleBar=function(canvas,x1,y1,x2,y2,size){canvas.BeginPath(),canvas.MoveTo(x1,y1),canvas.LineTo(x2,y2),canvas.LineTo(x2,y2-size),canvas.LineTo(x1,y1-size),canvas.ClosePath(),canvas.Fill()},$Inherit(AlphaTab.Rendering.TabBarRenderer,AlphaTab.Rendering.BarRendererBase),AlphaTab.Rendering.TabBarRendererFactory=function(){AlphaTab.Rendering.BarRendererFactory.call(this),this.HideOnPercussionTrack=!0},AlphaTab.Rendering.TabBarRendererFactory.prototype={get_StaffId:function(){return"tab"},CanCreate:function(track,staff){return track.Tuning.length>0&&AlphaTab.Rendering.BarRendererFactory.prototype.CanCreate.call(this,track,staff)},Create:function(renderer,bar,additionalSettings){var tabBarRenderer=new AlphaTab.Rendering.TabBarRenderer(renderer,bar);return additionalSettings.hasOwnProperty("rhythm")&&(tabBarRenderer.RenderRhythm=additionalSettings.rhythm),additionalSettings.hasOwnProperty("rhythm-height")&&(tabBarRenderer.RhythmHeight=additionalSettings["rhythm-height"]),additionalSettings.hasOwnProperty("rhythm-beams")&&(tabBarRenderer.RhythmBeams=additionalSettings["rhythm-beams"]),tabBarRenderer}},$Inherit(AlphaTab.Rendering.TabBarRendererFactory,AlphaTab.Rendering.BarRendererFactory),AlphaTab.Rendering.Utils.AccidentalHelper=function(){this._registeredAccidentals=null,this._appliedScoreLines=null,this._registeredAccidentals={},this._appliedScoreLines={}},AlphaTab.Rendering.Utils.AccidentalHelper.prototype={ApplyAccidental:function(note){var noteValue=note.get_RealValue(),ks=note.Beat.Voice.Bar.get_MasterBar().KeySignature,ksi=ks+7,index=noteValue%12,accidentalToSet=AlphaTab.Model.AccidentalType.None,line=this.RegisterNoteLine(note);if(!note.Beat.Voice.Bar.Staff.Track.IsPercussion){var keySignatureAccidental=7>ksi?AlphaTab.Model.AccidentalType.Flat:AlphaTab.Model.AccidentalType.Sharp,hasNoteAccidentalForKeySignature=AlphaTab.Rendering.Utils.AccidentalHelper.KeySignatureLookup[ksi][index],isAccidentalNote=AlphaTab.Rendering.Utils.AccidentalHelper.AccidentalNotes[index],isAccidentalRegistered=this._registeredAccidentals.hasOwnProperty(line);hasNoteAccidentalForKeySignature==isAccidentalNote||isAccidentalRegistered?hasNoteAccidentalForKeySignature==isAccidentalNote&&isAccidentalRegistered&&(delete this._registeredAccidentals[line],accidentalToSet=isAccidentalNote?keySignatureAccidental:AlphaTab.Model.AccidentalType.Natural):(this._registeredAccidentals[line]=!0,accidentalToSet=isAccidentalNote?keySignatureAccidental:AlphaTab.Model.AccidentalType.Natural)}return accidentalToSet},RegisterNoteLine:function(n){var value=n.Beat.Voice.Bar.Staff.Track.IsPercussion?AlphaTab.Rendering.Utils.PercussionMapper.MapNoteForDisplay(n):n.get_RealValue(),ks=n.Beat.Voice.Bar.get_MasterBar().KeySignature,clef=n.Beat.Voice.Bar.Clef,index=value%12,octave=value/12|0,steps=AlphaTab.Rendering.Utils.AccidentalHelper.OctaveSteps[clef];steps-=7*octave;var stepList=AlphaTab.Model.ModelUtils.KeySignatureIsSharp(ks)||AlphaTab.Model.ModelUtils.KeySignatureIsNatural(ks)?AlphaTab.Rendering.Utils.AccidentalHelper.SharpNoteSteps:AlphaTab.Rendering.Utils.AccidentalHelper.FlatNoteSteps,offset=0;switch(n.AccidentalMode){case AlphaTab.Model.NoteAccidentalMode.Default:case AlphaTab.Model.NoteAccidentalMode.SwapAccidentals:case AlphaTab.Model.NoteAccidentalMode.ForceNatural:case AlphaTab.Model.NoteAccidentalMode.ForceFlat:case AlphaTab.Model.NoteAccidentalMode.ForceSharp:
default:offset=stepList[index]}return steps-=stepList[index],this._appliedScoreLines[n.Id]=steps,steps},GetNoteLine:function(n){return this._appliedScoreLines[n.Id]}},$StaticConstructor(function(){AlphaTab.Rendering.Utils.AccidentalHelper.KeySignatureLookup=[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]],AlphaTab.Rendering.Utils.AccidentalHelper.AccidentalNotes=[!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!0,!1],AlphaTab.Rendering.Utils.AccidentalHelper.StepsPerOctave=7,AlphaTab.Rendering.Utils.AccidentalHelper.OctaveSteps=new Int32Array([40,34,32,28,40]),AlphaTab.Rendering.Utils.AccidentalHelper.SharpNoteSteps=new Int32Array([0,0,1,1,2,3,3,4,4,5,5,6]),AlphaTab.Rendering.Utils.AccidentalHelper.FlatNoteSteps=new Int32Array([0,1,1,2,2,3,4,4,5,5,6,6])}),AlphaTab.Rendering.Utils.BarHelpers=function(bar){this.BeamHelpers=null,this.BeamHelperLookup=null,this.TupletHelpers=null,this.BeamHelpers=[],this.BeamHelperLookup=[],this.TupletHelpers=[];var currentBeamHelper=null,currentTupletHelper=null;if(null!=bar)for(var i=0,j=bar.Voices.length;j>i;i++){var v=bar.Voices[i];this.BeamHelpers.push([]),this.BeamHelperLookup.push({}),this.TupletHelpers.push([]);for(var k=0,l=v.Beats.length;l>k;k++){var b=v.Beats[k],forceNewTupletHelper=!1;if(b.get_IsRest()||null!=currentBeamHelper&&currentBeamHelper.CheckBeat(b)||(null!=currentBeamHelper?(currentBeamHelper.Finish(),forceNewTupletHelper=currentBeamHelper.Beats.length>1):forceNewTupletHelper=!0,currentBeamHelper=new AlphaTab.Rendering.Utils.BeamingHelper(bar.Staff.Track),currentBeamHelper.CheckBeat(b),this.BeamHelpers[v.Index].push(currentBeamHelper)),b.get_HasTuplet()){var previousBeat=b.PreviousBeat;null!=previousBeat&&previousBeat.Voice!=b.Voice&&(previousBeat=null),forceNewTupletHelper&&null!=currentTupletHelper&&currentTupletHelper.Finish(),null!=previousBeat&&null!=currentTupletHelper&&currentTupletHelper.Check(b)||(currentTupletHelper=new AlphaTab.Rendering.Utils.TupletHelper(v.Index),currentTupletHelper.Check(b),this.TupletHelpers[v.Index].push(currentTupletHelper))}this.BeamHelperLookup[v.Index][b.Index]=currentBeamHelper}null!=currentBeamHelper&&currentBeamHelper.Finish(),null!=currentTupletHelper&&currentTupletHelper.Finish(),currentBeamHelper=null,currentTupletHelper=null}},AlphaTab.Rendering.Utils.BeamDirection={Up:0,Down:1},AlphaTab.Rendering.Utils.BeamBarType={Full:0,PartLeft:1,PartRight:2},AlphaTab.Rendering.Utils.BeatLinePositions=function(staffId,up,down){this.StaffId=null,this.Up=0,this.Down=0,this.StaffId=staffId,this.Up=up,this.Down=down},AlphaTab.Rendering.Utils.BeamingHelper=function(track){this._lastBeat=null,this._track=null,this._beatLineXPositions=null,this.Voice=null,this.Beats=null,this.ShortestDuration=AlphaTab.Model.Duration.QuadrupleWhole,this.FingeringCount=0,this.HasTuplet=!1,this.FirstMinNote=null,this.FirstMaxNote=null,this.LastMinNote=null,this.LastMaxNote=null,this.MinNote=null,this.MaxNote=null,this.InvertBeamDirection=!1,this.Direction=AlphaTab.Rendering.Utils.BeamDirection.Up,this._track=track,this.Beats=[],this._beatLineXPositions={},this.ShortestDuration=AlphaTab.Model.Duration.QuadrupleWhole},AlphaTab.Rendering.Utils.BeamingHelper.prototype={GetValue:function(n){return this._track.IsPercussion?AlphaTab.Rendering.Utils.PercussionMapper.MapNoteForDisplay(n):n.get_RealValue()},GetBeatLineX:function(beat){return this.HasBeatLineX(beat)?this.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?this._beatLineXPositions[beat.Index].Up:this._beatLineXPositions[beat.Index].Down:0},HasBeatLineX:function(beat){return this._beatLineXPositions.hasOwnProperty(beat.Index)},RegisterBeatLineX:function(staffId,beat,up,down){this._beatLineXPositions[beat.Index]=new AlphaTab.Rendering.Utils.BeatLinePositions(staffId,up,down)},Finish:function(){this.Direction=this.CalculateDirection()},CalculateDirection:function(){if(this.Voice.Index>0)return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Down);if(this.Voice.Bar.Voices.length>1)for(var v=1;v<this.Voice.Bar.Voices.length;v++)if(!this.Voice.Bar.Voices[v].IsEmpty)return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Up);if(1==this.Beats.length&&(this.Beats[0].Duration==AlphaTab.Model.Duration.Whole||this.Beats[0].Duration==AlphaTab.Model.Duration.DoubleWhole))return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Up);if(this.Beats[0].GraceType!=AlphaTab.Model.GraceType.None)return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Up);var avg=(this.GetValue(this.MaxNote)+this.GetValue(this.MinNote))/2|0;return this.Invert(avg<AlphaTab.Rendering.Utils.BeamingHelper.ScoreMiddleKeys[this._lastBeat.Voice.Bar.Clef]?AlphaTab.Rendering.Utils.BeamDirection.Up:AlphaTab.Rendering.Utils.BeamDirection.Down)},Invert:function(direction){if(!this.InvertBeamDirection)return direction;switch(direction){case AlphaTab.Rendering.Utils.BeamDirection.Down:return AlphaTab.Rendering.Utils.BeamDirection.Up;case AlphaTab.Rendering.Utils.BeamDirection.Up:return AlphaTab.Rendering.Utils.BeamDirection.Down}return AlphaTab.Rendering.Utils.BeamDirection.Up},CheckBeat:function(beat){beat.InvertBeamDirection&&(this.InvertBeamDirection=!0),null==this.Voice&&(this.Voice=beat.Voice);var add=!1;if(0==this.Beats.length?add=!0:AlphaTab.Rendering.Utils.BeamingHelper.CanJoin(this._lastBeat,beat)&&(add=!0),add){this._lastBeat=beat,this.Beats.push(beat),beat.get_HasTuplet()&&(this.HasTuplet=!0);for(var fingeringCount=0,n=0;n<beat.Notes.length;n++){var note=beat.Notes[n];(note.LeftHandFinger!=AlphaTab.Model.Fingers.Unknown||note.RightHandFinger!=AlphaTab.Model.Fingers.Unknown)&&fingeringCount++}fingeringCount>this.FingeringCount&&(this.FingeringCount=fingeringCount),this.CheckNote(beat.get_MinNote()),this.CheckNote(beat.get_MaxNote()),this.ShortestDuration<beat.Duration&&(this.ShortestDuration=beat.Duration),beat.get_HasTuplet()&&(this.HasTuplet=!0)}return add},CheckNote:function(note){var value=this.GetValue(note);null==this.FirstMinNote||note.Beat.Start<this.FirstMinNote.Beat.Start?this.FirstMinNote=note:note.Beat.Start==this.FirstMinNote.Beat.Start&&value<this.GetValue(this.FirstMinNote)&&(this.FirstMinNote=note),null==this.FirstMaxNote||note.Beat.Start<this.FirstMaxNote.Beat.Start?this.FirstMaxNote=note:note.Beat.Start==this.FirstMaxNote.Beat.Start&&value>this.GetValue(this.FirstMaxNote)&&(this.FirstMaxNote=note),null==this.LastMinNote||note.Beat.Start>this.LastMinNote.Beat.Start?this.LastMinNote=note:note.Beat.Start==this.LastMinNote.Beat.Start&&value<this.GetValue(this.LastMinNote)&&(this.LastMinNote=note),null==this.LastMaxNote||note.Beat.Start>this.LastMaxNote.Beat.Start?this.LastMaxNote=note:note.Beat.Start==this.LastMaxNote.Beat.Start&&value>this.GetValue(this.LastMaxNote)&&(this.LastMaxNote=note),(null==this.MaxNote||value>this.GetValue(this.MaxNote))&&(this.MaxNote=note),(null==this.MinNote||value<this.GetValue(this.MinNote))&&(this.MinNote=note)},CalculateBeamY:function(stemSize,xCorrection,xPosition,scale,yPosition){return this.CalculateBeamYWithDirection(stemSize,xCorrection,xPosition,scale,yPosition,this.Direction)},CalculateBeamYWithDirection:function(stemSize,xCorrection,xPosition,scale,yPosition,direction){if(1==this.Beats.length)return direction==AlphaTab.Rendering.Utils.BeamDirection.Up?yPosition.GetYPositionForNote(this.MaxNote)-stemSize:yPosition.GetYPositionForNote(this.MinNote)+stemSize;var maxDistance=10*scale;if(direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&this.MinNote!=this.FirstMinNote&&this.MinNote!=this.LastMinNote)return yPosition.GetYPositionForNote(this.MinNote)+stemSize;if(direction==AlphaTab.Rendering.Utils.BeamDirection.Up&&this.MaxNote!=this.FirstMaxNote&&this.MaxNote!=this.LastMaxNote)return yPosition.GetYPositionForNote(this.MaxNote)-stemSize;var startX=this.GetBeatLineX(this.FirstMinNote.Beat)+xCorrection,startY=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?yPosition.GetYPositionForNote(this.FirstMaxNote)-stemSize:yPosition.GetYPositionForNote(this.FirstMinNote)+stemSize,endX=this.GetBeatLineX(this.LastMaxNote.Beat)+xCorrection,endY=direction==AlphaTab.Rendering.Utils.BeamDirection.Up?yPosition.GetYPositionForNote(this.LastMaxNote)-stemSize:yPosition.GetYPositionForNote(this.LastMinNote)+stemSize;return direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&startY>endY&&startY-endY>maxDistance&&(endY=startY-maxDistance),direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&endY>startY&&endY-startY>maxDistance&&(startY=endY-maxDistance),direction==AlphaTab.Rendering.Utils.BeamDirection.Up&&endY>startY&&endY-startY>maxDistance&&(endY=startY+maxDistance),direction==AlphaTab.Rendering.Utils.BeamDirection.Up&&startY>endY&&startY-endY>maxDistance&&(startY=endY+maxDistance),startX==endX?startY:(endY-startY)/(endX-startX)*(xPosition-startX)+startY},IsPositionFrom:function(staffId,beat){return this._beatLineXPositions.hasOwnProperty(beat.Index)?this._beatLineXPositions[beat.Index].StaffId==staffId:!0}},$StaticConstructor(function(){AlphaTab.Rendering.Utils.BeamingHelper.ScoreMiddleKeys=new Int32Array([48,48,45,38,59])}),AlphaTab.Rendering.Utils.BeamingHelper.CanJoin=function(b1,b2){if(null==b1||null==b2||b1.get_IsRest()||b2.get_IsRest()||b1.GraceType!=b2.GraceType)return!1;var m1=b1.Voice.Bar,m2=b1.Voice.Bar;if(m1!=m2)return!1;var start1=b1.Start,start2=b2.Start;if(!AlphaTab.Rendering.Utils.BeamingHelper.CanJoinDuration(b1.Duration)||!AlphaTab.Rendering.Utils.BeamingHelper.CanJoinDuration(b2.Duration))return start1==start2;var divisionLength=960;switch(m1.get_MasterBar().TimeSignatureDenominator){case 8:m1.get_MasterBar().TimeSignatureNumerator%3==0&&(divisionLength+=480)}var division1=(divisionLength+start1)/divisionLength|0|0,division2=(divisionLength+start2)/divisionLength|0|0;return division1==division2},AlphaTab.Rendering.Utils.BeamingHelper.CanJoinDuration=function(d){switch(d){case AlphaTab.Model.Duration.Whole:case AlphaTab.Model.Duration.Half:case AlphaTab.Model.Duration.Quarter:return!1;default:return!0}},AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin=function(a,b,barIndex){return AlphaTab.Model.ModelUtils.GetIndex(a.Duration)-2-barIndex>0&&AlphaTab.Model.ModelUtils.GetIndex(b.Duration)-2-barIndex>0},AlphaTab.Rendering.Utils.StaveGroupBounds=function(){this.Index=0,this.VisualBounds=null,this.RealBounds=null,this.Bars=null,this.BoundsLookup=null,this.Bars=[],this.Index=0},AlphaTab.Rendering.Utils.StaveGroupBounds.prototype={Finish:function(){for(var i=0;i<this.Bars.length;i++)this.Bars[i].Finish()},AddBar:function(bounds){bounds.StaveGroupBounds=this,this.Bars.push(bounds)},FindBarAtPos:function(x){for(var b=null,i=0;i<this.Bars.length;i++)if(null==b||this.Bars[i].RealBounds.X<x)b=this.Bars[i];else if(x>this.Bars[i].RealBounds.X+this.Bars[i].RealBounds.W)break;return b}},AlphaTab.Rendering.Utils.MasterBarBounds=function(){this.IsFirstOfLine=!1,this.VisualBounds=null,this.RealBounds=null,this.Bars=null,this.StaveGroupBounds=null,this.Bars=[]},AlphaTab.Rendering.Utils.MasterBarBounds.prototype={AddBar:function(bounds){bounds.MasterBarBounds=this,this.Bars.push(bounds)},FindBeatAtPos:function(x){for(var beat=null,i=0;i<this.Bars.length;i++){var b=this.Bars[i].FindBeatAtPos(x);null!=b&&(null==beat||beat.RealBounds.X<b.RealBounds.X)&&(beat=b)}return null==beat?null:beat.Beat},Finish:function(){this.Bars.sort($CreateAnonymousDelegate(this,function(a,b){return a.RealBounds.Y<b.RealBounds.Y?-1:a.RealBounds.Y>b.RealBounds.Y?1:a.RealBounds.X<b.RealBounds.X?-1:a.RealBounds.X>b.RealBounds.X?1:0}))},AddBeat:function(bounds){this.StaveGroupBounds.BoundsLookup.AddBeat(bounds)}},AlphaTab.Rendering.Utils.BarBounds=function(){this.MasterBarBounds=null,this.VisualBounds=null,this.RealBounds=null,this.Bar=null,this.Beats=null,this.Beats=[]},AlphaTab.Rendering.Utils.BarBounds.prototype={AddBeat:function(bounds){bounds.BarBounds=this,this.Beats.push(bounds),this.MasterBarBounds.AddBeat(bounds)},FindBeatAtPos:function(x){for(var beat=null,i=0;i<this.Beats.length;i++)if(null==beat||this.Beats[i].RealBounds.X<x)beat=this.Beats[i];else if(this.Beats[i].RealBounds.X>x)break;return beat}},AlphaTab.Rendering.Utils.BeatBounds=function(){this.BarBounds=null,this.VisualBounds=null,this.RealBounds=null,this.Beat=null},AlphaTab.Rendering.Utils.PercussionMapper=function(){},$StaticConstructor(function(){AlphaTab.Rendering.Utils.PercussionMapper.ElementVariationToMidi=[new Int32Array([35,35,35]),new Int32Array([38,38,37]),new Int32Array([56,56,56]),new Int32Array([56,56,56]),new Int32Array([56,56,56]),new Int32Array([41,41,41]),new Int32Array([43,43,43]),new Int32Array([45,45,45]),new Int32Array([47,47,47]),new Int32Array([48,48,48]),new Int32Array([42,46,46]),new Int32Array([44,44,44]),new Int32Array([49,49,49]),new Int32Array([57,57,57]),new Int32Array([55,55,55]),new Int32Array([51,59,53]),new Int32Array([52,52,52])]}),AlphaTab.Rendering.Utils.PercussionMapper.MidiFromElementVariation=function(note){return AlphaTab.Rendering.Utils.PercussionMapper.ElementVariationToMidi[note.Element][note.Variation]},AlphaTab.Rendering.Utils.PercussionMapper.MapNoteForDisplay=function(note){var value=note.get_RealValue();return 61==value||66==value?50:60==value||65==value?52:value>=35&&36>=value||44==value?53:41==value||64==value?55:43==value||62==value?57:45==value||63==value?59:47==value||54==value?62:48==value||56==value?64:50==value?65:42==value||46==value||value>=49&&53>=value||57==value||59==value?67:60},AlphaTab.Rendering.Utils.TupletHelper=function(voice){this._isFinished=!1,this.Beats=null,this.VoiceIndex=0,this.Tuplet=0,this.VoiceIndex=voice,this.Beats=[]},AlphaTab.Rendering.Utils.TupletHelper.prototype={get_IsFull:function(){return this.Beats.length==this.Tuplet},Finish:function(){this._isFinished=!0},Check:function(beat){if(0==this.Beats.length)this.Tuplet=beat.TupletNumerator;else if(beat.Voice.Index!=this.VoiceIndex||beat.TupletNumerator!=this.Tuplet||this.get_IsFull()||this._isFinished)return!1;return this.Beats.push(beat),!0}},AlphaTab.LayoutSettings=function(){this.Mode=null,this.AdditionalSettings=null,this.AdditionalSettings={}},AlphaTab.LayoutSettings.prototype={Get:function(key,def){return this.AdditionalSettings.hasOwnProperty(key)?this.AdditionalSettings[key]:def}},AlphaTab.LayoutSettings.get_Defaults=function(){var settings=new AlphaTab.LayoutSettings;return settings.Mode="page",settings},AlphaTab.StaveSettings=function(id){this.Id=null,this.AdditionalSettings=null,this.Id=id,this.AdditionalSettings={}},AlphaTab.Util=AlphaTab.Util||{},AlphaTab.Util.Lazy=function(factory){this._factory=null,this._created=!1,this._value=null,this._factory=factory},AlphaTab.Util.Lazy.prototype={get_Value:function(){return this._created||(this._value=this._factory(),this._created=!0),this._value}},AlphaTab.Util.Logger=function(){},$StaticConstructor(function(){AlphaTab.Util.Logger.LogLevel=AlphaTab.Util.LogLevel.None,AlphaTab.Util.Logger.LogLevel=AlphaTab.Util.LogLevel.Info}),AlphaTab.Util.Logger.Debug=function(category,msg){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Debug,category,msg)},AlphaTab.Util.Logger.Warning=function(category,msg){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Warning,category,msg)},AlphaTab.Util.Logger.Info=function(category,msg){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Info,category,msg)},AlphaTab.Util.Logger.Error=function(category,msg){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Error,category,msg)},AlphaTab.Util.Logger.Log=function(logLevel,category,msg){if(!(logLevel<AlphaTab.Util.Logger.LogLevel)){var caller=arguments.callee.caller.caller.name;AlphaTab.Platform.Std.Log("[AlphaTab]["+category+"] "+caller+" - "+msg,logLevel)}},AlphaTab.Util.LogLevel={None:0,Debug:1,Info:2,Warning:3,Error:4},AlphaTab.Xml=AlphaTab.Xml||{},AlphaTab.Xml.XmlNodeType={None:0,Element:1,Attribute:2,Text:3,CDATA:4,EntityReference:5,Entity:6,ProcessingInstruction:7,Comment:8,Document:9,DocumentType:10,DocumentFragment:11,Notation:12,Whitespace:13,SignificantWhitespace:14,EndElement:15,EndEntity:16,XmlDeclaration:17},AlphaTab.Model.TuningParser=AlphaTab.Model.TuningParser||{},AlphaTab.Model.TuningParser.TuningParseResult=function(){this.Note=null,this.Octave=0},AlphaTab.Rendering.Glyphs.TripletFeelGlyph=AlphaTab.Rendering.Glyphs.TripletFeelGlyph||{},AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType={Full:0,PartialLeft:1,PartialRight:2};for(var i=0;i<$StaticConstructors.length;i++)$StaticConstructors[i]();